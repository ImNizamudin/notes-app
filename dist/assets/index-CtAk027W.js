import{c as is,u as Se,b as n,j as e,L as De,M as Re,d as fe,E as Oe,e as je,f as se,X as te,U as Ge,g as ze,C as We,P as as,T as Fe,h as Pe,I as _s,i as rs,k as Hs,G as qs,l as Ks,S as Is,F as Be,m as js,A as Je,n as Ye,o as ge,R as Ze,p as _e,q as Qe,s as ye,t as ls,v as Ws,w as Ps,x as cs,y as ds,Z as Js,z as Ys,B as Zs,D as ns,H as Qs,J as Ms,K as Xs,N as Ns,O as ms,Q as et,V as As,W as st,Y as tt,_ as vs,$ as at,a0 as ts,a1 as rt,a2 as lt,a3 as de,a4 as Rs,a5 as nt}from"./react-HiahOabw.js";import{i as ot,g as it,G as ws,s as ks,p as Ss}from"./vendor-CQLvnVAL.js";import{R as Ve}from"./quill-CKutec-C.js";import{H as X,j as xs,p as us,a as hs}from"./highlight-DE77Zp-a.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))l(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&l(c)}).observe(document,{childList:!0,subtree:!0});function t(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function l(r){if(r.ep)return;r.ep=!0;const a=t(r);fetch(r.href,a)}})();const He="https://dev-notesapp.radarku.online";function qe(){return new Promise(s=>{const o=document.createElement("div");o.id="session-expired-modal",o.style.position="fixed",o.style.top="0",o.style.left="0",o.style.width="100%",o.style.height="100%",o.style.backgroundColor="rgba(0, 0, 0, 0.7)",o.style.display="flex",o.style.justifyContent="center",o.style.alignItems="center",o.style.zIndex="9999",o.style.fontFamily="system-ui, -apple-system, sans-serif",o.innerHTML=`
      <div style="background: #1f2937; padding: 24px; border-radius: 12px; text-align: center; max-width: 350px; width: 90%; border: 1px solid #374151;">
        <div style="margin-bottom: 16px;">
          <svg style="width: 48px; height: 48px; color: #f59e0b;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
          </svg>
        </div>
        <h3 style="margin-bottom: 12px; color: #f9fafb; font-size: 18px; font-weight: 600;">Sesi Anda Berakhir</h3>
        <p style="margin-bottom: 20px; color: #d1d5db; font-size: 14px; line-height: 1.5;">Sesi Anda telah berakhir. Anda akan dialihkan ke halaman login.</p>
        <button id="session-expired-ok-btn" style="background: #3b82f6; color: white; border: none; padding: 10px 24px; border-radius: 6px; cursor: pointer; font-weight: 500; transition: background-color 0.2s;">
          Mengerti
        </button>
      </div>
    `;const t=document.createElement("style");t.textContent=`
      #session-expired-ok-btn:hover {
        background: #2563eb !important;
      }
      #session-expired-ok-btn:focus {
        outline: 2px solid #93c5fd;
        outline-offset: 2px;
      }
    `,document.head.appendChild(t);const l=o.querySelector("#session-expired-ok-btn"),r=()=>{document.body.contains(o)&&document.body.removeChild(o),document.head.contains(t)&&document.head.removeChild(t),s()};l?.addEventListener("click",r),o.addEventListener("click",a=>{a.target===o&&(a.preventDefault(),a.stopPropagation())}),document.body.appendChild(o),setTimeout(()=>{l?.focus()},100),setTimeout(()=>{document.body.contains(o)&&document.body.removeChild(o),document.head.contains(t)&&document.head.removeChild(t),s()},15e3)})}function Ke(){localStorage.removeItem("ACCESS_TOKEN"),localStorage.removeItem("REFRESH_TOKEN"),localStorage.removeItem("USER"),localStorage.removeItem("USER_EMAIL"),window.location.pathname!=="/login"&&(window.location.href="/login")}function Ls(s){try{const t=JSON.parse(atob(s.split(".")[1])).exp*1e3;return Date.now()>=t}catch{return!0}}async function Us(s){const o=await s.text();if(!o)return null;let t;try{t=JSON.parse(o)}catch{throw new Error(o||"Unknown response")}return t}async function U(s,o="GET",t,l={}){const r=`${He}${s}`,a=localStorage.getItem("ACCESS_TOKEN");if(a&&Ls(a))throw await qe(),Ke(),new Error("Session expired. Please log in again.");const c={...l};t instanceof FormData||(c["Content-Type"]="application/json"),a&&(c.Authorization=`Bearer ${a}`);const x=await fetch(r,{method:o,headers:c,body:t instanceof FormData?t:t?JSON.stringify(t):void 0});if(x.status===401)throw await qe(),Ke(),new Error("Unauthorized. Please log in again.");const m=await Us(x);if(!x.ok){if(m?.meta.error_code==="ERR_USER_NOT_VERIFIED"&&(window.location.href="http://localhost:5173/verify-email/notification",a))try{await fetch(`${He}/auths/verify_email/notification`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`}})}catch(u){console.error("Failed to send verification notification:",u)}const h=m&&(m.message||m.error||m.reason)||x.statusText||"API Error";throw{response:m||h}}return m.data}async function os(s,o="GET",t,l={}){const r=`${He}${s}`,a=localStorage.getItem("ACCESS_TOKEN");if(a&&Ls(a))throw await qe(),Ke(),new Error("Session expired. Please log in again.");const c={...l};t instanceof FormData||(c["Content-Type"]="application/json"),a&&(c.Authorization=`Bearer ${a}`);const x=await fetch(r,{method:o,headers:c,body:t instanceof FormData?t:t?JSON.stringify(t):void 0});if(x.status===401)throw await qe(),Ke(),new Error("Unauthorized. Please log in again.");const m=await Us(x);if(!x.ok){if(m?.meta.error_code==="ERR_USER_NOT_VERIFIED"&&(window.location.href="http://localhost:5173/verify-email/notification",a))try{await fetch(`${He}/auths/verify_email/notification`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`}})}catch(u){console.error("Failed to send verification notification:",u)}const h=m&&(m.message||m.error||m.reason)||x.statusText||"API Error";throw{response:m||h}}return m}const ct={apiKey:"AIzaSyDH_mJmXLCxq9CcRnEAOodAd_SImwu_QcI",authDomain:"fir-ta2022.firebaseapp.com",databaseURL:"https://fir-ta2022-default-rtdb.firebaseio.com",projectId:"fir-ta2022",storageBucket:"fir-ta2022.appspot.com",messagingSenderId:"816629212476",appId:"1:816629212476:web:e0a68590a7b9935761aa39",measurementId:"G-V7H17Q6ZFL"},Cs="https://dev-notesapp.radarku.online",dt=ot(ct),$e=it(dt),me=is((s,o)=>({accessToken:localStorage.getItem("ACCESS_TOKEN"),refreshToken:localStorage.getItem("REFRESH_TOKEN"),user:localStorage.getItem("USER")?JSON.parse(localStorage.getItem("USER")):null,loading:!1,error:null,oauthLoading:!1,oauthError:null,loginTimestamp:localStorage.getItem("LOGIN_TIMESTAMP"),refreshInterval:null,loadFromStorage(){const t=localStorage.getItem("ACCESS_TOKEN"),l=localStorage.getItem("REFRESH_TOKEN"),r=localStorage.getItem("USER"),a=localStorage.getItem("LOGIN_TIMESTAMP");console.log("Loading from storage:",{hasAccessToken:!!t,hasRefreshToken:!!l,hasUser:!!r,loginTimestamp:a}),s({accessToken:t,refreshToken:l,user:r?JSON.parse(r):null,loginTimestamp:a})},setUser(t){localStorage.setItem("USER",JSON.stringify(t)),s({user:t})},setLoginTimestamp(t){localStorage.setItem("LOGIN_TIMESTAMP",t),s({loginTimestamp:t}),console.log("Login timestamp set:",t)},clearOAuthError(){s({oauthError:null})},async loginWithGoogle(){s({oauthLoading:!0,oauthError:null});try{const t=new ws;t.addScope("email"),t.addScope("profile"),$e.useDeviceLanguage();const r=await(await ks($e,t)).user.getIdToken(),a=await fetch(`${Cs}/auths/login/oauth2`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"},body:JSON.stringify({idToken:r})});if(a.ok){const c=await a.json();await o().handleOAuthResponse(c)}else{const c=await a.json();throw new Error(c.message||c.meta?.message||"Failed to login with backend")}}catch(t){console.error("Google OAuth login error:",t);const l=o().getOAuthErrorMessage(t);throw s({oauthError:l,oauthLoading:!1}),t}},async registerWithGoogle(){s({oauthLoading:!0,oauthError:null});try{const t=new ws;t.addScope("email"),t.addScope("profile"),$e.useDeviceLanguage();const l=await ks($e,t),r=await l.user.getIdToken(),a=l.user,c={email:a.email??void 0,fullname:a.displayName??void 0,photoURL:a.photoURL??void 0};s({user:c});const x=await fetch(`${Cs}/auths/register/oauth2`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"},body:JSON.stringify({idToken:r})});if(x.ok){const m=await x.json();console.log("Backend register response:",m),await o().handleOAuthRegisterResponse(m)}else{const m=await x.json();throw new Error(m.message||m.meta?.message||"Failed to register with backend")}}catch(t){console.error("Google OAuth register error:",t);const l=o().getOAuthErrorMessage(t);throw s({oauthError:l,oauthLoading:!1}),t}},async handleOAuthResponse(t){if(t.data){const l=t.data.access_token??t.data.accessToken??t.access_token??t.accessToken,r=t.data.refresh_token??t.data.refreshToken??t.refresh_token??t.refreshToken;if(l){localStorage.setItem("ACCESS_TOKEN",l),r&&localStorage.setItem("REFRESH_TOKEN",r);const a=t.data.user||t.user||{email:t.data.email,fullname:t.data.fullname};console.log(t),localStorage.setItem("USER",JSON.stringify(a));const c=new Date().toISOString();localStorage.setItem("LOGIN_TIMESTAMP",c),s({accessToken:l,refreshToken:r||null,loginTimestamp:c,loading:!1,oauthLoading:!1,error:null,oauthError:null}),r&&o().startAutoRefresh()}}else throw new Error("Invalid response format from backend")},async handleOAuthRegisterResponse(t){if(t.data&&t.data.auth_oauth2){const l=t.data.auth_oauth2,r=l.claims,a={id:r.user_id,email:r.email,fullname:r.name,email_verified:r.email_verified,picture:r.picture,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};console.log("Processed user data:",a),localStorage.setItem("USER",JSON.stringify(a)),localStorage.setItem("ACCESS_TOKEN",l.id_token),localStorage.removeItem("REFRESH_TOKEN");const c=new Date().toISOString();localStorage.setItem("LOGIN_TIMESTAMP",c),s({accessToken:l.id_token,refreshToken:null,user:a,loginTimestamp:c,loading:!1,oauthLoading:!1,error:null,oauthError:null}),console.log("OAuth login successful, no token refresh needed")}else throw new Error("Invalid response format from backend")},getOAuthErrorMessage(t){return t.code==="auth/popup-closed-by-user"?"Popup login ditutup oleh pengguna":t.code==="auth/popup-blocked"?"Popup diblokir oleh browser. Izinkan popup untuk situs ini.":t.code==="auth/cancelled-popup-request"?"Permintaan login dibatalkan":t.code==="auth/account-exists-with-different-credential"?"Akun sudah terdaftar dengan metode login yang berbeda":t.message||"Terjadi kesalahan saat login dengan Google"},async login(t,l){s({loading:!0,error:null});try{const r=await U("/auths/login","POST",{email:t,password:l});console.log("Login API response:",r);const a=r?.access_token??r?.accessToken??r?.data?.access_token??null,c=r?.refresh_token??r?.refreshToken??r?.data?.refresh_token??null;if(!a){const h=r?.meta?.message||"Login failed: No access token";throw new Error(h)}localStorage.setItem("ACCESS_TOKEN",a),c&&localStorage.setItem("REFRESH_TOKEN",c);const x=new Date().toISOString();localStorage.setItem("LOGIN_TIMESTAMP",x);const m=r.user??r.data?.user??{email:t};localStorage.setItem("USER",JSON.stringify(m)),localStorage.removeItem("USER_EMAIL"),s({accessToken:a,refreshToken:c,loginTimestamp:x,loading:!1,user:m,error:null}),o().startAutoRefresh()}catch(r){console.error("Login error:",r);let a="Login failed";throw r.response?(a=r.response.meta?.message||r.response.data?.message||a,console.error("Login error response:",r.response)):r.message&&(a=r.message),s({error:a,loading:!1}),r}},async register(t,l,r){s({loading:!0,error:null});try{const a=await U("/auths/register","POST",{email:t,password:l,fullname:r}),c=a?.meta?.message||"Registration successful";return s({loading:!1,error:null}),{success:!0,message:c,data:a}}catch(a){let c="Registration failed";throw a.response?c=a.response.meta?.message||c:a.message&&(c=a.message),s({error:c,loading:!1}),new Error(c)}},async logout(){try{await U("/auths/logout","DELETE")}catch(t){console.error("Error during logout API call:",t)}localStorage.removeItem("ACCESS_TOKEN"),localStorage.removeItem("REFRESH_TOKEN"),localStorage.removeItem("USER"),localStorage.removeItem("USER_EMAIL"),localStorage.removeItem("LOGIN_TIMESTAMP"),s({accessToken:null,refreshToken:null,user:null,loginTimestamp:null,error:null,loading:!1,oauthError:null,oauthLoading:!1}),console.log("Logged out successfully"),window.location.pathname!=="/login"&&(window.location.href="/login")},async fetchUserProfile(){s({loading:!0,error:null});try{const t=await U("/auths/get_me","GET"),l=t.auth??t.data?.auth??null;if(!l)throw new Error("User data not found in response");localStorage.setItem("USER",JSON.stringify(l)),s({user:l,loading:!1,error:null})}catch(t){console.error("Error fetching user profile:",t),t.response?.status===401||t.message?.includes("Unauthorized")?o().logout():s({loading:!1,error:t.message||"Failed to fetch user profile"})}},startAutoRefresh(){const t=window.refreshTokenInterval;t&&clearInterval(t);const l=setInterval(async()=>{const r=localStorage.getItem("REFRESH_TOKEN");if(!r){clearInterval(l);return}try{console.log("Auto refreshing token...");const c=await fetch("https://dev-notesapp.radarku.online/auths/refresh_token",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`}});if(!c.ok)throw new Error(`HTTP error! Status: ${c.status}`);const x=await c.json(),m=x?.data?.access_token,h=x?.data?.refresh_token;m&&(localStorage.setItem("ACCESS_TOKEN",m),h&&localStorage.setItem("REFRESH_TOKEN",h),localStorage.setItem("LOGIN_TIMESTAMP",new Date().toISOString()),s({accessToken:m,refreshToken:h||r}),console.log("Token auto-refreshed successfully"))}catch(a){console.error("Auto refresh failed:",a),a.response?.status===401&&(console.log("Refresh token expired, logging out..."),o().logout())}},3480*1e3);window.refreshTokenInterval=l}})),mt=localStorage.getItem("REFRESH_TOKEN");mt&&setTimeout(()=>{me.getState().startAutoRefresh()},1e3);function xt(){const s=Se(),[o,t]=n.useState(""),[l,r]=n.useState(""),[a,c]=n.useState(!1),[x,m]=n.useState(!1),[h,u]=n.useState(""),[N,g]=n.useState(!1),[w,C]=n.useState(""),[S,E]=n.useState(""),{login:H,loginWithGoogle:F,loading:O,error:G,oauthLoading:y,oauthError:j,clearOAuthError:_}=me(),R=async k=>{k.preventDefault();try{await H(o,l),s("/")}catch(A){console.log(A)}},L=async k=>{if(k.preventDefault(),!h){C("Please enter your email address");return}g(!0),C(""),E("");try{await U("/auths/forgot_password","POST",{email:h}),E("Password reset instructions have been sent to your email"),u("")}catch(A){C(A.response?.meta?.message||"Failed to send reset instructions")}finally{g(!1)}},I=async()=>{try{_(),await F(),s("/")}catch(k){console.error("Google OAuth login error:",k)}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 opacity-10 -z-10",children:e.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"radial-gradient(circle at 25px 25px, rgba(255,255,255,0.1) 2px, transparent 0)",backgroundSize:"50px 50px"}})}),e.jsxs("div",{className:"relative w-full max-w-md",children:[e.jsxs("div",{className:"bg-gray-800/80 backdrop-blur-xl border border-gray-700/50 rounded-2xl shadow-2xl p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-r from-blue-600 to-blue-500 rounded-2xl mb-4 shadow-lg",children:e.jsx(De,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-gray-100 to-gray-300 bg-clip-text text-transparent mb-2",children:"Welcome Back"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Sign in to access your notes"})]}),e.jsxs("form",{onSubmit:R,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(Re,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"email",placeholder:"Enter your email address",className:"w-full pl-12 pr-4 py-3 bg-gray-700/50 border border-gray-600 text-gray-100 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all placeholder-gray-400",value:o,onChange:k=>t(k.target.value),required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(fe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:a?"text":"password",placeholder:"Enter your password",className:"w-full pl-12 pr-12 py-3 bg-gray-700/50 border border-gray-600 text-gray-100 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all placeholder-gray-400",value:l,onChange:k=>r(k.target.value),required:!0}),e.jsx("button",{type:"button",onClick:()=>c(!a),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-300 transition-colors",children:a?e.jsx(Oe,{className:"w-5 h-5"}):e.jsx(je,{className:"w-5 h-5"})})]})]}),e.jsx("div",{className:"text-right",children:e.jsx("button",{type:"button",onClick:()=>m(!0),className:"text-blue-400 hover:text-blue-300 text-sm font-medium transition-colors bg-transparent border-none outline-none",children:"Forgot your password?"})}),G&&e.jsx("div",{className:"bg-red-900/50 border border-red-700 text-red-200 px-4 py-3 rounded-xl",children:e.jsx("p",{className:"text-sm",children:G})}),j&&e.jsx("div",{className:"bg-red-900/50 border border-red-700 text-red-200 px-4 py-3 rounded-xl",children:e.jsx("p",{className:"text-sm",children:j})}),e.jsx("button",{type:"submit",disabled:O,className:"w-full flex items-center justify-center space-x-2 px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-500 text-white rounded-xl hover:from-blue-700 hover:to-blue-600 transition-all duration-200 shadow-lg hover:shadow-blue-500/25 disabled:opacity-50 disabled:cursor-not-allowed transform hover:scale-105",children:O?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),e.jsx("span",{children:"Signing in..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(De,{className:"w-5 h-5"}),e.jsx("span",{children:"Sign In"})]})})]}),e.jsxs("div",{className:"flex items-center my-6",children:[e.jsx("div",{className:"flex-1 border-t border-gray-600"}),e.jsx("span",{className:"px-3 text-gray-400 text-sm",children:"OR"}),e.jsx("div",{className:"flex-1 border-t border-gray-600"})]}),e.jsx("button",{type:"button",onClick:I,disabled:y||O,className:"w-full flex items-center justify-center space-x-3 px-6 py-3 bg-white text-gray-800 rounded-xl hover:bg-gray-100 transition-all duration-200 shadow-lg hover:shadow-white/25 disabled:opacity-50 disabled:cursor-not-allowed transform hover:scale-105 border border-gray-300",children:y?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-gray-600"}),e.jsx("span",{className:"font-medium",children:"Connecting to Google..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),e.jsx("span",{className:"font-medium",children:"Continue with Google"})]})}),e.jsx("div",{className:"mt-8 text-center",children:e.jsxs("p",{className:"text-gray-400 text-sm",children:["Don't have an account?"," ",e.jsx(se,{to:"/register",className:"text-blue-400 hover:text-blue-300 font-medium transition-colors",children:"Create one here"})]})})]}),e.jsx("div",{className:"absolute -top-4 -left-4 w-24 h-24 bg-blue-500/20 rounded-full blur-xl"}),e.jsx("div",{className:"absolute -bottom-4 -right-4 w-32 h-32 bg-purple-500/20 rounded-full blur-xl"})]}),x&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-2xl shadow-2xl p-6 w-full max-w-md",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-100",children:"Reset Password"}),e.jsx("button",{onClick:()=>{m(!1),C(""),E("")},className:"text-gray-400 hover:text-gray-200 p-1 bg-transparent border-none",children:e.jsx(te,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:L,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Email Address"}),e.jsx("input",{type:"email",placeholder:"Enter your email address",className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 text-gray-100 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:h,onChange:k=>u(k.target.value),required:!0})]}),w&&e.jsx("div",{className:"bg-red-900/50 border border-red-700 text-red-200 px-4 py-3 rounded-xl",children:e.jsx("p",{className:"text-sm",children:w})}),S&&e.jsx("div",{className:"bg-green-900/50 border border-green-700 text-green-200 px-4 py-3 rounded-xl",children:e.jsx("p",{className:"text-sm",children:S})}),e.jsx("button",{type:"submit",disabled:N,className:"w-full flex items-center justify-center space-x-2 px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-500 text-white rounded-xl hover:from-blue-700 hover:to-blue-600 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:N?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),e.jsx("span",{children:"Sending instructions..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Re,{className:"w-5 h-5"}),e.jsx("span",{children:"Send Reset Instructions"})]})})]}),e.jsx("p",{className:"text-gray-400 text-sm mt-4",children:"We'll send you an email with instructions to reset your password."})]})})]})}function ut(){const s=Se(),{register:o,registerWithGoogle:t,loading:l,error:r,oauthLoading:a,oauthError:c}=me(),[x,m]=n.useState({email:"",password:"",fullname:""}),[h,u]=n.useState(!1),N=C=>{m(S=>({...S,[C.target.name]:C.target.value}))},g=async C=>{C.preventDefault();try{await o(x.email,x.password,x.fullname),s("/verify-email/notification")}catch(S){console.error("Registration error:",S)}},w=async()=>{try{await t(),s("/")}catch(C){console.error("Google OAuth error:",C)}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 opacity-10",children:e.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"radial-gradient(circle at 25px 25px, rgba(255,255,255,0.1) 2px, transparent 0)",backgroundSize:"50px 50px"}})}),e.jsxs("div",{className:"relative w-full max-w-md",children:[e.jsxs("div",{className:"bg-gray-800/80 backdrop-blur-xl border border-gray-700/50 rounded-2xl shadow-2xl p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-r from-green-600 to-green-500 rounded-2xl mb-4 shadow-lg",children:e.jsx(Ge,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-gray-100 to-gray-300 bg-clip-text text-transparent mb-2",children:"Create Account"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Join us and start organizing your notes"})]}),e.jsxs("form",{onSubmit:g,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Full Name"}),e.jsxs("div",{className:"relative",children:[e.jsx(ze,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{name:"fullname",type:"text",placeholder:"Enter your full name",className:"w-full pl-12 pr-4 py-3 bg-gray-700/50 border border-gray-600 text-gray-100 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all placeholder-gray-400",value:x.fullname,onChange:N,required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(Re,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{name:"email",type:"email",placeholder:"Enter your email address",className:"w-full pl-12 pr-4 py-3 bg-gray-700/50 border border-gray-600 text-gray-100 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all placeholder-gray-400",value:x.email,onChange:N,required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(fe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{name:"password",type:h?"text":"password",placeholder:"Create a secure password",className:"w-full pl-12 pr-12 py-3 bg-gray-700/50 border border-gray-600 text-gray-100 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all placeholder-gray-400",value:x.password,onChange:N,required:!0,minLength:8}),e.jsx("button",{type:"button",onClick:()=>u(!h),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-300 transition-colors",children:h?e.jsx(Oe,{className:"w-5 h-5"}):e.jsx(je,{className:"w-5 h-5"})})]})]}),e.jsx("div",{className:"text-xs text-gray-400",children:e.jsx("p",{children:"Password should be at least 8 characters long"})}),r&&e.jsx("div",{className:"bg-red-900/50 border border-red-700 text-red-200 px-4 py-3 rounded-xl",children:e.jsx("p",{className:"text-sm",children:r})}),c&&e.jsx("div",{className:"bg-red-900/50 border border-red-700 text-red-200 px-4 py-3 rounded-xl",children:e.jsx("p",{className:"text-sm",children:c})}),e.jsx("button",{type:"submit",disabled:l,className:"w-full flex items-center justify-center space-x-2 px-6 py-3 bg-gradient-to-r from-green-600 to-green-500 text-white rounded-xl hover:from-green-700 hover:to-green-600 transition-all duration-200 shadow-lg hover:shadow-green-500/25 disabled:opacity-50 disabled:cursor-not-allowed transform hover:scale-105",children:l?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),e.jsx("span",{children:"Creating Account..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ge,{className:"w-5 h-5"}),e.jsx("span",{children:"Create Account"})]})})]}),e.jsxs("div",{className:"flex items-center my-6",children:[e.jsx("div",{className:"flex-1 border-t border-gray-600"}),e.jsx("span",{className:"px-3 text-gray-400 text-sm",children:"OR"}),e.jsx("div",{className:"flex-1 border-t border-gray-600"})]}),e.jsx("button",{type:"button",onClick:w,disabled:a||l,className:"w-full flex items-center justify-center space-x-3 px-6 py-3 bg-white text-gray-800 rounded-xl hover:bg-gray-100 transition-all duration-200 shadow-lg hover:shadow-white/25 disabled:opacity-50 disabled:cursor-not-allowed transform hover:scale-105 border border-gray-300",children:a?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-gray-600"}),e.jsx("span",{className:"font-medium",children:"Connecting to Google..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),e.jsx("span",{className:"font-medium",children:"Continue with Google"})]})}),e.jsx("div",{className:"mt-8 text-center",children:e.jsxs("p",{className:"text-gray-400 text-sm",children:["Already have an account?"," ",e.jsx(se,{to:"/login",className:"text-green-400 hover:text-green-300 font-medium transition-colors",children:"Sign in here"})]})})]}),e.jsx("div",{className:"absolute -top-4 -left-4 w-24 h-24 bg-green-500/20 rounded-full blur-xl"}),e.jsx("div",{className:"absolute -bottom-4 -right-4 w-32 h-32 bg-blue-500/20 rounded-full blur-xl"})]})]})}const Te=is((s,o)=>({notes:[],loading:!1,error:null,fetchNotes:async()=>{if(!o().loading){s({loading:!0,error:null});try{const t=await U("/notes","GET"),l=Array.isArray(t)?t:t?.notes??t?.data??[];s({notes:l,loading:!1})}catch(t){s({error:t.message||"Failed to fetch notes",loading:!1})}}},fetchNoteById:async t=>{s({loading:!0,error:null});try{const l=await U(`/notes/${t}`,"GET"),r=l?.note??l;return s(a=>({notes:a.notes.some(x=>String(x.id)===String(r.id))?a.notes.map(x=>String(x.id)===String(r.id)?r:x):[r,...a.notes],loading:!1})),r}catch(l){throw s({error:l.message||"Failed to fetch note",loading:!1}),l}},addNote:async t=>{s({loading:!0,error:null});try{await U("/notes","POST",t),await o().fetchNotes()}catch(l){throw s({error:l.message||"Failed to add note",loading:!1}),l}finally{s({loading:!1})}},updateNote:async(t,l)=>{s({loading:!0,error:null});try{await U(`/notes/${t}`,"PUT",l),await o().fetchNotes()}catch(r){throw s({error:r.message||"Failed to update note",loading:!1}),r}finally{s({loading:!1})}},deleteNote:async t=>{s({loading:!0,error:null});try{await U(`/notes/${t}`,"DELETE"),s(l=>({notes:l.notes.filter(r=>String(r.id)!==String(t)),loading:!1}))}catch(l){throw s({error:l.message||"Failed to delete note",loading:!1}),l}finally{s({loading:!1})}},getNote:t=>o().notes.find(l=>String(l.id)===String(t))}));function ht({note:s}){const o=Te(g=>g.deleteNote),[t,l]=n.useState(!1),r=async()=>{if(confirm("Hapus catatan ini?")){l(!0);try{await o(s.id)}catch(g){console.error("Error deleting note:",g)}finally{l(!1)}}},a=g=>{if(!g)return"";try{return new Date(g).toLocaleDateString("id-ID",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",year:"numeric"})}catch{return""}},c=(g,w=150)=>{const C=g.replace(/<[^>]*>/g,"");return C.length<=w?C:C.substring(0,w)+"..."};function x(g){return g.trim().split(/\s+/).map(w=>w.charAt(0).toUpperCase()).join("")}const m=s.is_editable===!0,h=s.is_deletable===!0,[u,N]=n.useState(!1);return e.jsxs("div",{className:"group bg-gray-800 border border-gray-700 rounded-xl overflow-hidden hover:shadow-xl hover:shadow-gray-900/20 transition-all duration-300 hover:border-gray-600 flex flex-col h-full",children:[e.jsx("div",{className:"p-4 border-b border-gray-700 flex-shrink-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-semibold text-sm",children:x(s.username||"")}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-gray-200 font-medium text-sm truncate w-20",children:s.username}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-400",children:[e.jsx(We,{className:"w-3 h-3"}),e.jsx("span",{children:a(s.updated_at||s.created_at)||"No date"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx(se,{to:`/notes/${s.id}`,className:"p-1.5 text-gray-400 hover:text-blue-400 hover:bg-gray-700 rounded-md transition-colors",title:"View",children:e.jsx(je,{className:"w-4 h-4"})}),m&&e.jsx(se,{to:`/notes/${s.id}/edit`,className:"p-1.5 text-gray-400 hover:text-green-400 hover:bg-gray-700 rounded-md transition-colors",title:"Edit",children:e.jsx(as,{className:"w-4 h-4"})}),h&&e.jsx("button",{onClick:r,disabled:t,className:"p-1.5 text-gray-400 hover:text-red-400 hover:bg-gray-700 rounded-md transition-colors disabled:opacity-50",title:"Delete",children:e.jsx(Fe,{className:"w-4 h-4"})})]})]})}),e.jsxs("div",{className:"p-4 flex-grow flex flex-col",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-100 mb-3 line-clamp-2 leading-tight flex-shrink-0",children:s.title||"Untitled Note"}),s.tags&&s.tags.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1.5 mb-3 flex-shrink-0",children:[s.tags.slice(0,3).map((g,w)=>e.jsxs("span",{className:"inline-flex items-center space-x-1 bg-blue-600/20 text-blue-300 text-xs px-2 py-1 rounded-full border border-blue-600/30",children:[e.jsx(Pe,{className:"w-2.5 h-2.5"}),e.jsx("span",{children:g})]},w)),s.tags.length>3&&e.jsxs("span",{className:"inline-flex items-center bg-gray-700 text-gray-300 text-xs px-2 py-1 rounded-full",children:["+",s.tags.length-3," more"]})]}),e.jsx("div",{className:"text-gray-400 text-sm mb-4 line-clamp-3 leading-relaxed flex-grow",children:c(s.body)||"No content available"}),s.thumbnail&&e.jsx("div",{className:"relative overflow-hidden mb-4 rounded-lg flex-shrink-0",children:u?e.jsxs("div",{className:"w-full h-32 flex flex-col items-center justify-center bg-gray-800 text-gray-300 text-xs",children:[e.jsx(_s,{className:"w-6 h-6 mb-1 opacity-80"}),e.jsx("span",{children:"Image failed to load"})]}):e.jsxs("div",{children:[e.jsx("img",{src:`https://minio-s3.radarku.online/radarku-bucket/notes_app/${s.thumbnail}`,alt:"Note thumbnail",className:"w-full h-32 object-cover hover:scale-105 transition-transform duration-300",loading:"lazy",onError:()=>N(!0)}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 hover:bg-opacity-30 transition-all duration-300 flex items-center justify-center opacity-0 hover:opacity-100",children:e.jsxs(se,{to:`/notes/${s.id}`,className:"px-3 py-1 bg-white/20 backdrop-blur-sm text-white rounded-lg hover:bg-white/30 transition-colors text-xs",children:[e.jsx(je,{className:"w-3 h-3 inline mr-1"}),"View"]})})]})})]}),e.jsxs("div",{className:"p-4 border-t border-gray-700 bg-gray-800/50 flex-shrink-0",children:[" ",e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"flex items-center space-x-1 text-gray-400 bg-gray-700/50 px-1 py-1 rounded-lg border border-gray-600",children:[e.jsx(rs,{className:"w-3 h-3"}),e.jsxs("span",{className:"text-xs",children:[" ",s.total_daily_notes||0]})]}),e.jsxs("div",{className:"flex items-center space-x-1 text-blue-400 bg-gray-700/50 px-1 py-1 rounded-lg border border-gray-600",children:[e.jsx(Hs,{className:"w-3 h-3"}),e.jsxs("span",{className:"text-xs",children:[" ",s.total_daily_notes_mine||0]})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(se,{to:`/notes/${s.id}`,className:"px-2 py-1 bg-gradient-to-r from-blue-600 to-blue-500 text-white text-xs rounded-md hover:from-blue-700 hover:to-blue-600 transition-all duration-200 shadow hover:shadow-blue-500/20",children:"View"}),h&&e.jsx("button",{onClick:r,disabled:t,className:"px-2 py-1 bg-gradient-to-r from-red-600 to-red-500 text-white text-xs rounded-md hover:from-red-700 hover:to-red-600 transition-all duration-200 shadow hover:shadow-red-500/20 disabled:opacity-50",children:t?"Deleting...":"Delete"})]})]})]})]})}function gt(){const{notes:s,fetchNotes:o,loading:t}=Te(m=>m),[l,r]=n.useState(""),[a,c]=n.useState("grid");n.useEffect(()=>{o()},[o]);const x=s.filter(m=>m.title.toLowerCase().includes(l.toLowerCase())||m.body.toLowerCase().includes(l.toLowerCase())||m.tags?.some(h=>h.toLowerCase().includes(l.toLowerCase())));return e.jsxs("div",{className:"min-h-screen bg-gray-900",children:[e.jsx("div",{className:"bg-gradient-to-r from-gray-800 to-gray-900 border-b border-gray-700",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-100 mb-2",children:"My Notes"}),e.jsxs("p",{className:"text-gray-400",children:[s.length," ",s.length===1?"note":"notes"," in total"]})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("div",{className:"flex items-center space-x-2 bg-gray-800 p-1 rounded-lg",children:[e.jsx("button",{onClick:()=>c("grid"),className:`p-2 rounded-md transition-colors ${a==="grid"?"bg-gray-600 text-white":"text-gray-400 hover:text-gray-200"}`,children:e.jsx(qs,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>c("list"),className:`p-2 rounded-md transition-colors ${a==="list"?"bg-gray-600 text-white":"text-gray-400 hover:text-gray-200"}`,children:e.jsx(Ks,{className:"w-4 h-4"})})]})})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"relative max-w-md",children:[e.jsx(Is,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search notes...",value:l,onChange:m=>r(m.target.value),className:"w-full pl-10 pr-4 py-3 bg-gray-800 border border-gray-700 text-gray-100 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all placeholder-gray-400"})]})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pb-20",children:t?e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):x.length===0?e.jsxs("div",{className:"text-center py-20",children:[e.jsx("div",{className:"text-6xl text-gray-600 mb-6",children:e.jsx(Be,{className:"w-16 h-16 mx-auto"})}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-400 mb-4",children:l?"No notes found":"No notes yet"}),e.jsx("p",{className:"text-gray-500 mb-8 max-w-md mx-auto",children:l?"Try adjusting your search terms or create a new note.":"Start organizing your thoughts by creating your first note."}),e.jsxs(se,{to:"/notes/new",className:"inline-flex items-center space-x-2 px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-500 text-white rounded-xl hover:from-blue-700 hover:to-blue-600 transition-all duration-200 shadow-lg hover:shadow-blue-500/25",children:[e.jsx(js,{className:"w-5 h-5"}),e.jsx("span",{children:"Create Your First Note"})]})]}):e.jsx("div",{className:`${a==="grid"?"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 auto-rows-fr":"space-y-4"}`,children:x.map(m=>e.jsx(ht,{note:{...m,id:String(m.id),created_at:m.createdAt,updated_at:m.updatedAt,total_daily_notes:m.total_daily_notes??0,total_daily_notes_mine:m.total_daily_notes_mine??0}},m.id))})}),e.jsx(se,{to:"/notes/new",className:"fixed bottom-6 right-6 bg-gradient-to-r from-blue-600 to-blue-500 text-white p-4 rounded-full shadow-2xl hover:from-blue-700 hover:to-blue-600 transition-all duration-200 hover:scale-110 hover:shadow-blue-500/25 z-40",children:e.jsx(js,{className:"w-6 h-6"})})]})}X.registerLanguage("javascript",xs);X.registerLanguage("python",us);X.registerLanguage("java",hs);X.configure({languages:["javascript","typescript","html","css","php","python"]});const pt={syntax:{highlight:s=>X.highlightAuto(s).value},toolbar:[[{header:[1,2,3,!1]},{font:[]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"},{align:[]}],["link","image","formula","code"]]},bt=["header","font","bold","italic","underline","strike","list","bullet","align","link","image","formula","code"];function ft({isOpen:s,onClose:o,selectedType:t,onSelect:l}){if(!s)return null;const r=[{value:"default",icon:Ye,title:"Public",description:"Visible to everyone",color:"text-blue-400"},{value:"private",icon:fe,title:"Private",description:"Only visible to you",color:"text-purple-400"}];return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-xl w-full max-w-md",children:[e.jsxs("div",{className:"p-6 border-b border-gray-700",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-100",children:"Select Visibility"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Choose who can see this note"})]}),e.jsx("div",{className:"p-6 space-y-3",children:r.map(a=>e.jsx("button",{onClick:()=>l(a.value),className:`w-full p-4 text-left rounded-lg border-2 transition-all ${t===a.value?"border-blue-500 bg-blue-500/10":"border-gray-600 bg-gray-700 hover:border-gray-500"}`,children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(a.icon,{className:`w-5 h-5 ${a.color}`}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-100",children:a.title}),e.jsx("div",{className:"text-sm text-gray-400",children:a.description})]})]})},a.value))}),e.jsx("div",{className:"p-6 border-t border-gray-700 flex justify-end",children:e.jsx("button",{onClick:o,className:"px-4 py-2 bg-gray-700 text-gray-300 rounded-lg hover:bg-gray-600 transition-colors",children:"Close"})})]})})}function yt(){const s=Se(),o=Te(b=>b.addNote),[t,l]=n.useState(""),[r,a]=n.useState(""),[c,x]=n.useState(""),[m,h]=n.useState("default"),[u,N]=n.useState(null),[g,w]=n.useState(!1),[C,S]=n.useState(!1),[E,H]=n.useState("gallery"),[F,O]=n.useState([]),[G,y]=n.useState(!1),[j,_]=n.useState([]),[R,L]=n.useState(!1),[I,k]=n.useState({}),[A,B]=n.useState(null),[$,W]=n.useState(null),[Z,ee]=n.useState(!1),[xe,Ne]=n.useState(null),le=n.useRef(null);n.useRef(null),n.useEffect(()=>{g&&ne()},[g]);const ne=async()=>{y(!0);try{const b=await U("/files/notes_app","GET");O(b.files||[])}catch(b){console.error("Error fetching gallery files:",b),B(b.response?.meta?.message||"Failed to load gallery files")}finally{y(!1)}},ae=b=>{const i=b.target.files;if(!i)return;const f=Array.from(i);_(v=>[...v,...f]),B(null)},Q=b=>{_(i=>i.filter((f,v)=>v!==b))},ue=async()=>{if(j.length===0){B("Please select at least one file to upload");return}L(!0),B(null),W(null);try{for(let b=0;b<j.length;b++){const i=j[b],f=`thumbnail_${b+1}`;try{const v=new FormData;v.append("fields",f),v.append(f,i);for(let M=0;M<=100;M+=10)k(V=>({...V,[i.name]:M})),await new Promise(V=>setTimeout(V,50));await U("/files/notes_app/bulk-upload","POST",v)}catch(v){console.error(`Error uploading ${i.name}:`,v),B(`Failed to upload ${i.name}: ${v.response?.meta?.message||v.message}`)}}_([]),W(`Successfully uploaded ${j.length} file(s)`),await ne()}catch(b){B(b.response?.meta?.message||"Failed to upload files")}finally{L(!1),k({})}},oe=b=>{if(b===0)return"0 Bytes";const i=1024,f=["Bytes","KB","MB","GB"],v=Math.floor(Math.log(b)/Math.log(i));return parseFloat((b/Math.pow(i,v)).toFixed(2))+" "+f[v]},ve=b=>b.startsWith("image/"),Ce=async b=>{b.preventDefault(),Ne(null),ee(!0);try{const i=c.split(",").map(f=>f.trim()).filter(Boolean);await o({title:t,body:r,tags:i,type:m,thumbnail:u||void 0}),s("/")}catch(i){Ne(i.message||"Gagal menambahkan note")}finally{ee(!1)}},ie=()=>{t.trim()||r.trim()||c.trim()||u?confirm("You have unsaved changes. Are you sure you want to leave?")&&s(-1):s(-1)},pe=b=>{a(b)},K=b=>{N(b),w(!1)},we=()=>{N(null)},re=b=>{h(b),S(!1)};return e.jsxs("div",{className:"min-h-screen bg-gray-900",children:[e.jsx("div",{className:"bg-gradient-to-r from-gray-800 to-gray-900 border-b border-gray-700",children:e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:ie,className:"p-2 text-gray-400 hover:text-gray-200 hover:bg-gray-700 rounded-lg transition-colors",children:e.jsx(Je,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-100",children:"Create New Note"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"What do you want to talk about?"})]})]})})}),e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("form",{onSubmit:Ce,className:"space-y-6",children:e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-xl shadow-xl overflow-hidden",children:[e.jsx("div",{className:"px-6 pt-6 pb-0",children:e.jsx("input",{className:"w-full bg-transparent border-none outline-none text-3xl font-bold text-gray-100 placeholder-gray-500",placeholder:"Posting ke Semua orang...",value:t,onChange:b=>l(b.target.value),required:!0,autoFocus:!0})}),e.jsxs("div",{className:"px-6 pt-2 pb-0",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(Pe,{className:"w-4 h-4 text-gray-400"}),e.jsx("input",{className:"w-full bg-transparent border-none outline-none text-gray-100 placeholder-gray-600",placeholder:"work, ideas, project...",value:c,onChange:b=>x(b.target.value)})]}),c&&e.jsx("div",{className:"my-4 flex flex-wrap gap-2",children:c.split(",").map((b,i)=>{const f=b.trim();return f?e.jsxs("span",{className:"inline-flex items-center space-x-1 bg-blue-600/20 text-blue-300 text-sm px-3 py-1 rounded-lg border border-blue-500/30",children:[e.jsx(Pe,{className:"w-3 h-3"}),e.jsx("span",{children:f})]},i):null})})]}),e.jsx("div",{className:"px-6 pb-2 pt-0",children:e.jsxs("div",{className:"flex items-center space-x-2 text-gray-300",children:[e.jsx("button",{type:"button",onClick:()=>S(!0),className:"flex items-center space-x-2 px-2 py-2 bg-gray-700 text-gray-300 rounded-full hover:bg-gray-600 transition-colors",children:m==="private"?e.jsx(fe,{className:"w-4 h-4 text-purple-400"}):e.jsx(Ye,{className:"w-4 h-4 text-blue-400"})}),e.jsxs("button",{type:"button",onClick:()=>w(!0),className:"flex items-center space-x-2 px-2 py-2 bg-gray-700 text-gray-300 rounded-full hover:bg-gray-600 transition-colors",children:[e.jsx(ge,{className:"w-4 h-4"}),u&&e.jsx("span",{className:"text-sm",children:"Change Image"})]})]})}),u&&e.jsx("div",{className:"p-6 border-b border-gray-700",children:e.jsxs("div",{className:"relative inline-block",children:[e.jsx("img",{src:`https://minio-s3.radarku.online/radarku-bucket/notes_app/${u}`,alt:"Thumbnail preview",className:"w-32 h-32 object-cover rounded-lg"}),e.jsx("button",{type:"button",onClick:we,className:"absolute -top-2 -right-2 p-1 bg-red-600 hover:bg-red-700 text-white rounded-full",children:e.jsx(Fe,{className:"w-3 h-3"})})]})}),e.jsx("div",{className:"px-6 pt-2 pb-6",children:e.jsx("div",{className:"bg-gray-600 border border-gray-500 rounded-lg overflow-hidden",children:e.jsx(Ve,{value:r,onChange:pe,modules:pt,formats:bt,placeholder:"Write your comment here...",theme:"snow",className:"auto-resize-quill"})})}),xe&&e.jsx("div",{className:"px-6 pb-4",children:e.jsx("div",{className:"bg-red-900/50 border border-red-700 text-red-200 px-4 py-3 rounded-lg",children:e.jsx("p",{className:"text-sm",children:xe})})}),e.jsx("div",{className:"p-6 bg-gray-700/30 border-t border-gray-700 flex items-center justify-end",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{type:"button",onClick:ie,className:"px-6 py-2 text-gray-300 border border-gray-600 rounded-lg hover:bg-gray-700 hover:border-gray-500 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:Z,className:"px-6 py-2 bg-gradient-to-r from-blue-600 to-blue-500 text-white rounded-lg hover:from-blue-700 hover:to-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:Z?"Posting...":"Post"})]})})]})}),e.jsx(ft,{isOpen:C,onClose:()=>S(!1),selectedType:m,onSelect:re}),g&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-xl w-full max-w-6xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-gray-700 flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-100",children:"Select Thumbnail"}),e.jsx("button",{onClick:()=>w(!1),className:"p-2 text-gray-400 hover:text-gray-200 hover:bg-gray-700 rounded-lg transition-colors",children:e.jsx(te,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"border-b border-gray-700",children:e.jsxs("div",{className:"flex",children:[e.jsx("button",{className:`px-6 py-3 font-medium ${E==="gallery"?"text-blue-400 border-b-2 border-blue-400":"text-gray-400 hover:text-gray-200"}`,onClick:()=>H("gallery"),children:"Gallery"}),e.jsx("button",{className:`px-6 py-3 font-medium ${E==="upload"?"text-blue-400 border-b-2 border-blue-400":"text-gray-400 hover:text-gray-200"}`,onClick:()=>H("upload"),children:"Upload New"})]})}),e.jsxs("div",{className:"p-6 overflow-y-auto flex-grow",children:[E==="gallery"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-300",children:"Your Uploaded Images"}),e.jsxs("button",{onClick:ne,disabled:G,className:"flex items-center space-x-2 px-3 py-1 bg-gray-700 text-gray-300 rounded-lg hover:bg-gray-600 disabled:opacity-50",children:[e.jsx(Ze,{className:`w-4 h-4 ${G?"animate-spin":""}`}),e.jsx("span",{children:"Refresh"})]})]}),G?e.jsx("div",{className:"flex justify-center items-center h-40",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):F.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx(ge,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No images found. Upload some images to get started!"})]}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:F.map(b=>ve(b.mime)&&e.jsxs("div",{className:"cursor-pointer group bg-gray-700 rounded-lg p-3",onClick:()=>K(b.name),children:[e.jsx("div",{className:"aspect-square overflow-hidden rounded-lg border-2 border-gray-600 group-hover:border-blue-500 transition-colors",children:e.jsx("img",{src:`https://minio-s3.radarku.online/radarku-bucket/${b.path}/${b.name}`,alt:b.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-sm text-gray-300 truncate",children:b.name}),e.jsx("p",{className:"text-xs text-gray-400",children:oe(b.size)})]})]},b.id))})]}),E==="upload"&&e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-300 mb-4",children:"Upload New Image"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-600 rounded-xl p-8 text-center mb-6",children:[e.jsx("input",{type:"file",ref:le,onChange:ae,multiple:!0,accept:"image/*",className:"hidden"}),e.jsx(_e,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-300 mb-2",children:"Drag & drop images here or"}),e.jsx("button",{onClick:()=>le.current?.click(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-500 transition-colors",disabled:R,children:"Browse Images"}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"Supports JPG, PNG, GIF, and other image formats"})]}),j.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"text-md font-medium text-gray-300 mb-3",children:["Selected Images (",j.length,")"]}),e.jsx("div",{className:"space-y-3",children:j.map((b,i)=>e.jsxs("div",{className:"flex items-center justify-between bg-gray-700 p-3 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("img",{src:URL.createObjectURL(b),alt:b.name,className:"w-12 h-12 object-cover rounded"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-gray-100 text-sm font-medium truncate",children:b.name}),e.jsx("p",{className:"text-gray-400 text-xs",children:oe(b.size)})]})]}),e.jsx("button",{onClick:()=>Q(i),className:"text-gray-400 hover:text-red-400 transition-colors",disabled:R,children:e.jsx(te,{className:"w-4 h-4"})})]},i))}),e.jsx("button",{onClick:ue,disabled:R,className:"w-full mt-4 flex items-center justify-center space-x-2 px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:R?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),e.jsx("span",{children:"Uploading..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(_e,{className:"w-5 h-5"}),e.jsxs("span",{children:["Upload ",j.length," Image(s)"]})]})})]}),A&&e.jsx("div",{className:"bg-red-900/50 border border-red-700 rounded-xl p-4 mb-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Qe,{className:"w-5 h-5 text-red-400"}),e.jsx("p",{className:"text-red-200",children:A})]})}),$&&e.jsx("div",{className:"bg-green-900/50 border border-green-700 rounded-xl p-4 mb-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ye,{className:"w-5 h-5 text-green-400"}),e.jsx("p",{className:"text-green-200",children:$})]})})]})]}),e.jsx("div",{className:"p-6 border-t border-gray-700 flex justify-end",children:e.jsx("button",{onClick:()=>w(!1),className:"px-6 py-3 bg-gray-700 text-gray-300 rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"})})]})})]})]})}const gs=is((s,o)=>({loading:!1,error:null,collaborators:[],collaborations:[],comments:[],pagination:null,fetchCollaborators:async t=>{s({loading:!0,error:null});try{const l=await U(`/notes/${t}`,"GET");let r=[],a=[];l&&l.note&&(l.note.user_collaborators&&(r=l.note.user_collaborators),l.note.note_collaborations&&(a=l.note.note_collaborations)),s({collaborators:r,collaborations:a})}catch(l){s({error:l.message||"Failed to fetch collaborators"})}finally{s({loading:!1})}},createCollaboration:async(t,l)=>{s({loading:!0,error:null});try{await U("/collaborations","POST",{userId:t.toString(),noteId:Number(l)}),await o().fetchCollaborators(l)}catch(r){throw s({error:r.message||"Failed to create collaboration"}),r}finally{s({loading:!1})}},deleteCollaboration:async(t,l)=>{s({loading:!0,error:null});try{await U("/collaborations","DELETE",{userId:t.toString(),noteId:Number(l)}),await o().fetchCollaborators(l)}catch(r){throw s({error:r.message||"Failed to delete collaboration"}),r}finally{s({loading:!1})}},fetchCollaborations:async(t,l=1,r=10)=>{s({loading:!0,error:null});try{const a=await os(`/note_collaboration_dailies/${t}/list?page=${l}&limit=${r}`,"GET");let c=[],x=null;a&&a.data&&a.page?(Array.isArray(a.data)?c=a.data:a.data.daily_notes&&Array.isArray(a.data.daily_notes)?c=a.data.daily_notes:a.data.data&&Array.isArray(a.data.data)&&(c=a.data.data),x=a.page):Array.isArray(a)&&(c=a,x={current_page:1,total_data:a.length,limit:r,total_page:1}),s({comments:c,pagination:x,error:null})}catch(a){const c=a.response?.data?.message||a.message||"Failed to fetch collaborations";throw s({error:c}),new Error(c)}finally{s({loading:!1})}},addOrUpdateComment:async(t,l,r,a)=>{s({loading:!0,error:null});try{let c;const x={note_id:t,body:l.trim(),...r&&{thumbnail:r}};a?c=await os(`/note_collaboration_dailies/${a}`,"PUT",x):c=await U("/note_collaboration_dailies","POST",x);const m=c.data||c;if(!m)throw new Error("Invalid response from server");const h={id:m.id?.toString()||`temp-${Date.now()}`,userId:m.user_id?.toString()||m.userId?.toString()||"0",noteId:m.note_id||m.noteId||t,user:m.user||{id:"0",username:"Unknown",fullname:"Unknown User",email:""},body:m.body||l,thumbnail:m.thumbnail||r,created_at:m.created_at||new Date().toISOString(),updated_at:m.updated_at||new Date().toISOString()};return s(u=>a?{collaborations:u.collaborations.map(g=>g.id===a?h:g)}:{collaborations:[h,...u.collaborations]}),h}catch(c){const x=c.response?.data?.message||c.message||c.response.meta.message||"Failed to add/update comment";throw s({error:x}),new Error(x)}finally{s({loading:!1})}},deleteComment:async t=>{s({loading:!0,error:null});try{await U(`/note_collaboration_dailies/${t}`,"DELETE"),s(l=>({collaborations:l.collaborations.filter(r=>r.id!==t),comments:l.comments.filter(r=>r.id.toString()!==t)}))}catch(l){const r=l.response?.data?.message||l.message||"Failed to delete comment";throw s({error:r}),new Error(r)}finally{s({loading:!1})}}}));function jt({noteId:s}){const{collaborators:o,loading:t,error:l,fetchCollaborators:r,createCollaboration:a,deleteCollaboration:c}=gs(),[x,m]=n.useState(""),[h,u]=n.useState([]),[N,g]=n.useState(""),[w,C]=n.useState(!1),[S,E]=n.useState("");n.useEffect(()=>{r(s)},[s,r]),n.useEffect(()=>{if(S){const y=setTimeout(()=>{E("")},3e3);return()=>clearTimeout(y)}},[S]);const H=async y=>{if(m(y),y.length<2){u([]);return}C(!0);try{const j=await U(`/user?username=${y}`,"GET");let _=[];Array.isArray(j)?_=j:j&&j.data&&Array.isArray(j.data)?_=j.data:j&&j.users&&Array.isArray(j.users)&&(_=j.users);const R=o.map(I=>I.id),L=_.filter(I=>!R.includes(I.id));u(L)}catch(j){console.error("Search failed",j),u([])}finally{C(!1)}},F=async y=>{if(N)try{await a(N,s);const _=h.find(R=>R.id===N)?.username||N;E(` Successfully added ${_} as collaborator!`),g(""),m(""),u([]),r(s)}catch(j){const _=j instanceof Error?j.message:String(j);alert(`Failed to add collaborator: ${_}`)}},O=async y=>{const _=o.find(L=>L.id===y)?.username||y;if(window.confirm(`Are you sure you want to remove ${_} from collaborators?`))try{await c(y,s),E(` Successfully removed ${_} from collaborators!`),r(s)}catch(L){const I=L instanceof Error?L.message:String(L);alert(`Failed to remove collaborator: ${I}`)}},G=y=>{y.preventDefault(),F()};return e.jsxs("div",{className:"space-y-6",children:[S&&e.jsx("div",{className:"bg-green-900/50 border border-green-700 text-green-200 px-4 py-3 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"w-2 h-2 bg-green-400 rounded-full"}),e.jsx("span",{className:"text-sm",children:S})]})}),l&&e.jsx("div",{className:"bg-red-900/50 border border-red-700 text-red-200 px-4 py-3 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"w-2 h-2 bg-red-400 rounded-full"}),e.jsx("span",{className:"text-sm",children:l})]})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-300 mb-4 flex items-center space-x-2",children:[e.jsx(ls,{className:"w-5 h-5 text-blue-400"}),e.jsx("span",{children:"Current Collaborators"}),e.jsx("span",{className:"bg-blue-500 text-white text-xs px-2 py-1 rounded-full",children:o.length})]}),t?e.jsx("div",{className:"flex items-center justify-center py-4",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500"})}):o.length>0?e.jsx("div",{className:"space-y-3",children:o.map(y=>e.jsxs("div",{className:"flex items-center justify-between bg-gray-700 p-4 rounded-lg border border-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-medium text-sm",children:y.username.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-100 font-medium",children:y.username}),y.fullname&&e.jsx("div",{className:"text-gray-400 text-sm",children:y.fullname})]})]}),e.jsx("button",{onClick:()=>O(y.id),className:"p-2 text-red-400 hover:text-red-300 hover:bg-red-500/10 rounded-lg transition-colors",title:"Remove collaborator",type:"button",children:e.jsx(Ws,{className:"w-4 h-4"})})]},y.id))}):e.jsxs("div",{className:"bg-gray-700/50 border border-gray-600 rounded-lg p-6 text-center",children:[e.jsx(ls,{className:"w-12 h-12 text-gray-500 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-400",children:"No collaborators yet. Add someone to collaborate on this note."})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-300 mb-4 flex items-center space-x-2",children:[e.jsx(Ge,{className:"w-5 h-5 text-green-400"}),e.jsx("span",{children:"Add New Collaborator"})]}),e.jsxs("form",{onSubmit:G,className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Is,{className:"w-5 h-5 text-gray-400 absolute left-3 top-1/2 transform -translate-y-1/2"}),e.jsx("input",{type:"text",placeholder:"Search users by username...",value:x,onChange:y=>H(y.target.value),className:"w-full bg-gray-700 border border-gray-600 text-gray-100 rounded-lg pl-10 pr-4 py-3 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),w&&e.jsxs("div",{className:"flex items-center justify-center py-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-500 mr-2"}),e.jsx("span",{className:"text-gray-400",children:"Searching..."})]}),h.length>0&&e.jsx("div",{className:"bg-gray-700 border border-gray-600 rounded-lg overflow-hidden",children:h.map(y=>e.jsx("div",{className:`p-3 cursor-pointer transition-colors border-b border-gray-600 last:border-b-0 ${N===y.id?"bg-blue-500/20 border-l-4 border-l-blue-500":"hover:bg-gray-600"}`,onClick:()=>g(y.id),children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-medium text-xs",children:y.username.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-100",children:y.username}),y.fullname&&e.jsx("div",{className:"text-sm text-gray-400",children:y.fullname})]}),N===y.id&&e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full"})]})},y.id))}),x.length>=2&&!w&&h.length===0&&e.jsx("div",{className:"bg-gray-700/50 border border-gray-600 rounded-lg p-4 text-center",children:e.jsxs("p",{className:"text-gray-400",children:['No users found matching "',x,'"']})}),N&&e.jsxs("button",{onClick:y=>{y.preventDefault(),F()},className:"w-full flex items-center justify-center space-x-2 px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",type:"button",children:[e.jsx(Ge,{className:"w-4 h-4"}),e.jsx("span",{children:"Add Collaborator"})]})]})]})]})}X.registerLanguage("javascript",xs);X.registerLanguage("python",us);X.registerLanguage("java",hs);X.configure({languages:["javascript","typescript","html","css","php","python"]});const Nt={syntax:{highlight:s=>X.highlightAuto(s).value},toolbar:[[{header:[1,2,3,!1]},{font:[]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"},{align:[]}],["link","image","formula","code"]]},vt=["header","font","bold","italic","underline","strike","list","bullet","align","link","image","formula","code"];function wt({isOpen:s,onClose:o,selectedType:t,onSelect:l}){if(!s)return null;const r=[{value:"default",icon:Ye,title:"Public",description:"Visible to everyone",color:"text-blue-400"},{value:"private",icon:fe,title:"Private",description:"Only visible to you",color:"text-purple-400"}];return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-xl w-full max-w-md",children:[e.jsxs("div",{className:"p-6 border-b border-gray-700",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-100",children:"Select Visibility"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Choose who can see this note"})]}),e.jsx("div",{className:"p-6 space-y-3",children:r.map(a=>e.jsx("button",{onClick:()=>l(a.value),className:`w-full p-4 text-left rounded-lg border-2 transition-all ${t===a.value?"border-blue-500 bg-blue-500/10":"border-gray-600 bg-gray-700 hover:border-gray-500"}`,children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(a.icon,{className:`w-5 h-5 ${a.color}`}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-100",children:a.title}),e.jsx("div",{className:"text-sm text-gray-400",children:a.description})]})]})},a.value))}),e.jsx("div",{className:"p-6 border-t border-gray-700 flex justify-end",children:e.jsx("button",{onClick:o,className:"px-4 py-2 bg-gray-700 text-gray-300 rounded-lg hover:bg-gray-600 transition-colors",children:"Close"})})]})})}function kt(){const{id:s}=Ps(),o=Se(),{collaborations:t,loading:l,addOrUpdateComment:r,deleteComment:a}=gs();t.filter(p=>p.body);const c=Te(p=>p.getNote),x=Te(p=>p.fetchNoteById),m=Te(p=>p.updateNote),[h,u]=n.useState(null),[N,g]=n.useState(""),[w,C]=n.useState(""),[S,E]=n.useState(""),[H,F]=n.useState("default"),[O,G]=n.useState(null),[y,j]=n.useState(!1),[_,R]=n.useState(!1),[L,I]=n.useState("gallery"),[k,A]=n.useState([]),[B,$]=n.useState(!1),[W,Z]=n.useState([]),[ee,xe]=n.useState(!1),[Ne,le]=n.useState({}),[ne,ae]=n.useState(null),[Q,ue]=n.useState(null),[oe,ve]=n.useState(!0),[Ce,ie]=n.useState(!1),[pe,K]=n.useState(null),[we,re]=n.useState(!1),b=n.useRef(null);n.useEffect(()=>{if(!s)return;(async()=>{const P=c(s);if(P)u(P),g(P.title),C(P.body),E(P.tags.join(", ")),F(P.type||"default"),G(P.thumbnail||null),ve(!1);else try{const z=await x(s);u(z),g(z.title),C(z.body),E(z.tags?.join(", ")||""),F(z.type||"default"),G(z.thumbnail||null)}catch(z){K(z.message||"Gagal memuat note")}finally{ve(!1)}})()},[s,x,c]),n.useEffect(()=>{y&&i()},[y]);const i=async()=>{$(!0);try{const p=await U("/files/notes_app","GET");A(p.files||[])}catch(p){console.error("Error fetching gallery files:",p),ae(p.response?.meta?.message||"Failed to load gallery files")}finally{$(!1)}},f=p=>{const P=p.target.files;if(!P)return;const z=Array.from(P);Z(Y=>[...Y,...z]),ae(null)},v=p=>{Z(P=>P.filter((z,Y)=>Y!==p))},M=async()=>{if(W.length===0){ae("Please select at least one file to upload");return}xe(!0),ae(null),ue(null);try{for(let p=0;p<W.length;p++){const P=W[p],z=`thumbnail_${p+1}`;try{const Y=new FormData;Y.append("fields",z),Y.append(z,P);for(let Me=0;Me<=100;Me+=10)le(Ae=>({...Ae,[P.name]:Me})),await new Promise(Ae=>setTimeout(Ae,50));await U("/files/notes_app/bulk-upload","POST",Y)}catch(Y){console.error(`Error uploading ${P.name}:`,Y),ae(`Failed to upload ${P.name}: ${Y.response?.meta?.message||Y.message}`)}}Z([]),ue(`Successfully uploaded ${W.length} file(s)`),await i()}catch(p){ae(p.response?.meta?.message||"Failed to upload files")}finally{xe(!1),le({})}},V=p=>{if(p===0)return"0 Bytes";const P=1024,z=["Bytes","KB","MB","GB"],Y=Math.floor(Math.log(p)/Math.log(P));return parseFloat((p/Math.pow(P,Y)).toFixed(2))+" "+z[Y]},J=p=>p.startsWith("image/"),be=async p=>{if(p.preventDefault(),!!s){K(null),ie(!0);try{const P=S.split(",").map(z=>z.trim()).filter(Boolean);await m(s,{title:N,body:w,tags:P,type:H,thumbnail:O||void 0}),o(`/notes/${s}`)}catch(P){K(P.message||"Gagal menyimpan perubahan")}finally{ie(!1)}}},Ee=p=>{C(p)},he=h&&(N!==h.title||w!==h.body||S!==h.tags?.join(", ")||H!==(h.type||"default")||O!==(h.thumbnail||null)),Le=()=>{he?confirm("You have unsaved changes. Are you sure you want to leave?")&&o(-1):o(-1)},Xe=p=>{if(!p)return"Unknown";try{return new Date(p).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return"Invalid date"}},es=p=>{G(p),j(!1)},Ue=()=>{G(null)},ss=p=>{F(p),R(!1)};return e.jsxs("div",{className:"min-h-screen bg-gray-900",children:[e.jsx("div",{className:"bg-gradient-to-r from-gray-800 to-gray-900 border-b border-gray-700",children:e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:Le,className:"p-2 text-gray-400 hover:text-gray-200 hover:bg-gray-700 rounded-lg transition-colors",children:e.jsx(Je,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-100",children:"Edit Note"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Make changes to your note"})]})]}),h&&e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-400",children:[e.jsx(We,{className:"w-4 h-4"}),e.jsxs("span",{children:["Last updated: ",Xe(h.updated_at||h.created_at)]})]})]})})}),e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[oe?e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-xl p-8",children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})})}):h?e.jsx("form",{onSubmit:be,className:"space-y-6",children:e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-xl shadow-xl overflow-hidden",children:[e.jsx("div",{className:"px-6 pt-6 pb-0",children:e.jsx("input",{className:"w-full bg-transparent border-none outline-none text-3xl font-bold text-gray-100 placeholder-gray-500",placeholder:"Posting ke Semua orang...",value:N,onChange:p=>g(p.target.value),required:!0,autoFocus:!0})}),e.jsxs("div",{className:"px-6 pt-2 pb-0",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(Pe,{className:"w-4 h-4 text-gray-400"}),e.jsx("input",{className:"w-full bg-transparent border-none outline-none text-gray-100 placeholder-gray-600",placeholder:"work, ideas, project...",value:S,onChange:p=>E(p.target.value)})]}),S&&e.jsx("div",{className:"my-4 flex flex-wrap gap-2",children:S.split(",").map((p,P)=>{const z=p.trim();return z?e.jsxs("span",{className:"inline-flex items-center space-x-1 bg-blue-600/20 text-blue-300 text-sm px-3 py-1 rounded-lg border border-blue-500/30",children:[e.jsx(Pe,{className:"w-3 h-3"}),e.jsx("span",{children:z})]},P):null})})]}),e.jsx("div",{className:"px-6 pb-2 pt-0",children:e.jsxs("div",{className:"flex items-center space-x-2 text-gray-300",children:[e.jsx("button",{type:"button",onClick:()=>R(!0),className:"flex items-center space-x-2 px-2 py-2 bg-gray-700 text-gray-300 rounded-full hover:bg-gray-600 transition-colors",children:H==="private"?e.jsx(fe,{className:"w-4 h-4 text-purple-400"}):e.jsx(Ye,{className:"w-4 h-4 text-blue-400"})}),e.jsx("button",{type:"button",onClick:()=>re(!0),className:"flex items-center space-x-2 px-2 py-2 bg-gray-700 text-gray-300 rounded-full hover:bg-gray-600 transition-colors",title:"Manage Collaborators",children:e.jsx(ls,{className:"w-4 h-4 text-green-400"})}),e.jsxs("button",{type:"button",onClick:()=>j(!0),className:"flex items-center space-x-2 px-2 py-2 bg-gray-700 text-gray-300 rounded-full hover:bg-gray-600 transition-colors",children:[e.jsx(ge,{className:"w-4 h-4"}),O&&e.jsx("span",{className:"text-sm",children:"Change Image"})]})]})}),O&&e.jsx("div",{className:"px-6 pb-4",children:e.jsxs("div",{className:"relative inline-block",children:[e.jsx("img",{src:`https://minio-s3.radarku.online/radarku-bucket/notes_app/${O}`,alt:"Thumbnail preview",className:"w-32 h-32 object-cover rounded-lg"}),e.jsx("a",{href:`https://minio-s3.radarku.online/radarku-bucket/notes_app/${O}`,target:"_blank",rel:"noopener noreferrer",className:"absolute -top-2 -left-2 p-1 bg-blue-600 hover:bg-blue-700 text-white rounded-full",title:"View image in new tab",children:e.jsx(je,{className:"w-3 h-3"})}),e.jsx("button",{type:"button",onClick:Ue,className:"absolute -top-2 -right-2 p-1 bg-red-600 hover:bg-red-700 text-white rounded-full",children:e.jsx(Fe,{className:"w-3 h-3"})})]})}),e.jsx("div",{className:"px-6 pt-2 pb-6",children:e.jsx("div",{className:"bg-gray-600 border border-gray-500 rounded-lg overflow-hidden",children:e.jsx(Ve,{value:w,onChange:Ee,modules:Nt,formats:vt,placeholder:"Write your amazing content here...",theme:"snow",className:"auto-resize-quill"})})}),he&&e.jsx("div",{className:"px-6 pb-4",children:e.jsx("div",{className:"bg-yellow-900/30 border border-yellow-700 text-yellow-200 px-4 py-3 rounded-lg",children:e.jsxs("p",{className:"text-sm flex items-center space-x-2",children:[e.jsx("span",{className:"w-2 h-2 bg-yellow-400 rounded-full"}),e.jsx("span",{children:"You have unsaved changes"})]})})}),pe&&e.jsx("div",{className:"px-6 pb-4",children:e.jsx("div",{className:"bg-red-900/50 border border-red-700 text-red-200 px-4 py-3 rounded-lg",children:e.jsx("p",{className:"text-sm",children:pe})})}),e.jsx("div",{className:"p-6 bg-gray-700/30 border-t border-gray-700 flex items-center justify-end",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{type:"button",onClick:Le,className:"px-6 py-2 text-gray-300 border border-gray-600 rounded-lg hover:bg-gray-700 hover:border-gray-500 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:Ce||!he,className:"px-6 py-2 bg-gradient-to-r from-green-600 to-green-500 text-white rounded-lg hover:from-green-700 hover:to-green-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:Ce?"Saving...":"Save Changes"})]})})]})}):e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-xl p-8",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-red-400 text-6xl mb-4",children:""}),e.jsx("p",{className:"text-red-400 text-lg font-medium mb-2",children:"Error Loading Note"}),e.jsx("p",{className:"text-gray-400 mb-6",children:pe||"Note not found"}),e.jsx("button",{onClick:()=>o("/"),className:"px-4 py-2 bg-gray-700 text-gray-300 rounded-lg hover:bg-gray-600 transition-colors",children:"Back to Notes"})]})}),e.jsx(wt,{isOpen:_,onClose:()=>R(!1),selectedType:H,onSelect:ss}),we&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-xl w-full max-w-2xl max-h-[80vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-gray-700 flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-100",children:"Manage Collaborators"}),e.jsx("button",{onClick:()=>re(!1),className:"p-2 text-gray-400 hover:text-gray-200 hover:bg-gray-700 rounded-lg transition-colors",children:e.jsx(te,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"p-6 overflow-y-auto flex-grow",children:s&&e.jsx(jt,{noteId:parseInt(s)})}),e.jsx("div",{className:"p-6 border-t border-gray-700 flex justify-end",children:e.jsx("button",{onClick:()=>re(!1),className:"px-6 py-3 bg-gray-700 text-gray-300 rounded-lg hover:bg-gray-600 transition-colors",children:"Close"})})]})}),y&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-xl w-full max-w-6xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-gray-700 flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-100",children:"Select Thumbnail"}),e.jsx("button",{onClick:()=>j(!1),className:"p-2 text-gray-400 hover:text-gray-200 hover:bg-gray-700 rounded-lg transition-colors",children:e.jsx(te,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"border-b border-gray-700",children:e.jsxs("div",{className:"flex",children:[e.jsx("button",{className:`px-6 py-3 font-medium ${L==="gallery"?"text-blue-400 border-b-2 border-blue-400":"text-gray-400 hover:text-gray-200"}`,onClick:()=>I("gallery"),children:"Gallery"}),e.jsx("button",{className:`px-6 py-3 font-medium ${L==="upload"?"text-blue-400 border-b-2 border-blue-400":"text-gray-400 hover:text-gray-200"}`,onClick:()=>I("upload"),children:"Upload New"})]})}),e.jsxs("div",{className:"p-6 overflow-y-auto flex-grow",children:[L==="gallery"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-300",children:"Your Uploaded Images"}),e.jsxs("button",{onClick:i,disabled:B,className:"flex items-center space-x-2 px-3 py-1 bg-gray-700 text-gray-300 rounded-lg hover:bg-gray-600 disabled:opacity-50",children:[e.jsx(Ze,{className:`w-4 h-4 ${B?"animate-spin":""}`}),e.jsx("span",{children:"Refresh"})]})]}),B?e.jsx("div",{className:"flex justify-center items-center h-40",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):k.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx(ge,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No images found. Upload some images to get started!"})]}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:k.map(p=>J(p.mime)&&e.jsxs("div",{className:"cursor-pointer group bg-gray-700 rounded-lg p-3",onClick:()=>es(p.name),children:[e.jsx("div",{className:"aspect-square overflow-hidden rounded-lg border-2 border-gray-600 group-hover:border-blue-500 transition-colors",children:e.jsx("img",{src:`https://minio-s3.radarku.online/radarku-bucket/${p.path}/${p.name}`,alt:p.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-sm text-gray-300 truncate",children:p.name}),e.jsx("p",{className:"text-xs text-gray-400",children:V(p.size)})]})]},p.id))})]}),L==="upload"&&e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-300 mb-4",children:"Upload New Image"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-600 rounded-xl p-8 text-center mb-6",children:[e.jsx("input",{type:"file",ref:b,onChange:f,multiple:!0,accept:"image/*",className:"hidden"}),e.jsx(_e,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-300 mb-2",children:"Drag & drop images here or"}),e.jsx("button",{onClick:()=>b.current?.click(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-500 transition-colors",disabled:ee,children:"Browse Images"}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"Supports JPG, PNG, GIF, and other image formats"})]}),W.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"text-md font-medium text-gray-300 mb-3",children:["Selected Images (",W.length,")"]}),e.jsx("div",{className:"space-y-3",children:W.map((p,P)=>e.jsxs("div",{className:"flex items-center justify-between bg-gray-700 p-3 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("img",{src:URL.createObjectURL(p),alt:p.name,className:"w-12 h-12 object-cover rounded"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-gray-100 text-sm font-medium truncate",children:p.name}),e.jsx("p",{className:"text-gray-400 text-xs",children:V(p.size)})]})]}),e.jsx("button",{onClick:()=>v(P),className:"text-gray-400 hover:text-red-400 transition-colors",disabled:ee,children:e.jsx(te,{className:"w-4 h-4"})})]},P))}),e.jsx("button",{onClick:M,disabled:ee,className:"w-full mt-4 flex items-center justify-center space-x-2 px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:ee?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),e.jsx("span",{children:"Uploading..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(_e,{className:"w-5 h-5"}),e.jsxs("span",{children:["Upload ",W.length," Image(s)"]})]})})]}),ne&&e.jsx("div",{className:"bg-red-900/50 border border-red-700 rounded-xl p-4 mb-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Qe,{className:"w-5 h-5 text-red-400"}),e.jsx("p",{className:"text-red-200",children:ne})]})}),Q&&e.jsx("div",{className:"bg-green-900/50 border border-green-700 rounded-xl p-4 mb-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ye,{className:"w-5 h-5 text-green-400"}),e.jsx("p",{className:"text-green-200",children:Q})]})})]})]}),e.jsx("div",{className:"p-6 border-t border-gray-700 flex justify-end",children:e.jsx("button",{onClick:()=>j(!1),className:"px-6 py-3 bg-gray-700 text-gray-300 rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"})})]})})]})]})}function $s({isOpen:s,onClose:o,imageUrl:t,fileName:l="",fileSize:r=0,uploadedAt:a="",images:c=[],currentImageIndex:x=0,onNext:m,onPrev:h,showNavigation:u=!1}){const[N,g]=n.useState(1),[w,C]=n.useState(0),[S,E]=n.useState(!0);n.useEffect(()=>(s?(g(1),C(0),E(!0),document.body.style.overflow="hidden"):document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[s]),n.useEffect(()=>{g(1),C(0),E(!0)},[t]);const H=()=>{g(k=>Math.min(k+.25,3))},F=()=>{g(k=>Math.max(k-.25,.5))},O=()=>{C(k=>(k+90)%360)},G=()=>{g(1),C(0)},y=async()=>{try{const A=await(await fetch(t)).blob(),B=window.URL.createObjectURL(A),$=document.createElement("a");$.href=B,$.download=l||"image",document.body.appendChild($),$.click(),document.body.removeChild($),window.URL.revokeObjectURL(B)}catch(k){console.error("Download failed:",k)}},j=k=>{if(s)switch(k.key){case"Escape":o();break;case"ArrowLeft":u&&h&&h();break;case"ArrowRight":u&&m&&m();break;case"+":case"=":H();break;case"-":F();break;case"r":O();break;case"0":G();break}};if(n.useEffect(()=>(document.addEventListener("keydown",j),()=>document.removeEventListener("keydown",j)),[s,m,h]),!s)return null;const _=k=>{if(k===0)return"0 Bytes";const A=1024,B=["Bytes","KB","MB","GB"],$=Math.floor(Math.log(k)/Math.log(A));return parseFloat((k/Math.pow(A,$)).toFixed(2))+" "+B[$]},R=u&&c.length>1,L=R&&x<c.length-1,I=R&&x>0;return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-90 p-4",children:[e.jsx("button",{onClick:o,className:"absolute top-4 right-4 z-10 p-2 text-white hover:bg-white hover:bg-opacity-20 rounded-full transition-colors",children:e.jsx(te,{className:"w-6 h-6"})}),R&&e.jsxs(e.Fragment,{children:[I&&e.jsx("button",{onClick:h,className:"absolute left-4 z-10 p-3 text-white hover:bg-white hover:bg-opacity-20 rounded-full transition-colors",children:e.jsx(cs,{className:"w-6 h-6"})}),L&&e.jsx("button",{onClick:m,className:"absolute right-4 z-10 p-3 text-white hover:bg-white hover:bg-opacity-20 rounded-full transition-colors",children:e.jsx(ds,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"relative max-w-full max-h-full flex items-center justify-center",children:[S&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white"})}),e.jsx("img",{src:t,alt:l,className:"max-w-full max-h-full object-contain transition-transform duration-200",style:{transform:`scale(${N}) rotate(${w}deg)`,cursor:N>1?"grab":"default"},onLoad:()=>E(!1),onError:()=>E(!1),draggable:N>1})]}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black to-transparent p-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"text-white text-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold truncate",children:l}),e.jsxs("div",{className:"flex items-center justify-center space-x-4 text-sm text-gray-300 mt-1",children:[r>0&&e.jsx("span",{children:_(r)}),a&&e.jsxs("span",{children:["Uploaded: ",new Date(a).toLocaleDateString()]}),R&&e.jsxs("span",{children:[x+1," / ",c.length]})]})]}),e.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 bg-black bg-opacity-50 rounded-lg p-2",children:[e.jsx("button",{onClick:F,disabled:N<=.5,className:"p-2 text-white hover:bg-white hover:bg-opacity-20 rounded disabled:opacity-50 transition-colors",title:"Zoom Out",children:e.jsx(Js,{className:"w-5 h-5"})}),e.jsxs("button",{onClick:G,className:"px-3 py-2 text-white hover:bg-white hover:bg-opacity-20 rounded transition-colors text-sm",title:"Reset (0)",children:[Math.round(N*100),"%"]}),e.jsx("button",{onClick:H,disabled:N>=3,className:"p-2 text-white hover:bg-white hover:bg-opacity-20 rounded disabled:opacity-50 transition-colors",title:"Zoom In",children:e.jsx(Ys,{className:"w-5 h-5"})})]}),e.jsx("button",{onClick:O,className:"p-2 text-white hover:bg-white hover:bg-opacity-20 rounded transition-colors",title:"Rotate (R)",children:e.jsx(Zs,{className:"w-5 h-5"})}),e.jsx("button",{onClick:y,className:"p-2 text-white hover:bg-white hover:bg-opacity-20 rounded transition-colors",title:"Download",children:e.jsx(ns,{className:"w-5 h-5"})})]})]})}),S&&e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-white text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white mx-auto mb-4"}),e.jsx("p",{children:"Loading image..."})]})})]})}X.registerLanguage("javascript",xs);X.registerLanguage("python",us);X.registerLanguage("java",hs);X.configure({languages:["javascript","typescript","html","css","php","python"]});const Es={syntax:{highlight:s=>X.highlightAuto(s).value},toolbar:[[{header:[1,2,3,!1]},{font:[]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"},{align:[]}],["link","image","formula","code"]]},Ts=["header","font","bold","italic","underline","strike","list","bullet","align","link","image","formula","code"];function St(){const{id:s}=Ps(),o=Se(),t=Te(d=>d.fetchNoteById),l=Te(d=>d.deleteNote),{comments:r,pagination:a,loading:c,addOrUpdateComment:x,deleteComment:m,fetchCollaborations:h}=gs(),[u,N]=n.useState(null),[g,w]=n.useState(!0),[C,S]=n.useState(null),[E,H]=n.useState(!1),[F,O]=n.useState(1),[G]=n.useState(10),[y,j]=n.useState(null),[_,R]=n.useState(""),[L,I]=n.useState(""),[k,A]=n.useState(null),[B,$]=n.useState(null),[W,Z]=n.useState(!1),[ee,xe]=n.useState("gallery"),[Ne,le]=n.useState([]),[ne,ae]=n.useState(!1),[Q,ue]=n.useState([]),[oe,ve]=n.useState(!1),[Ce,ie]=n.useState({}),[pe,K]=n.useState(null),[we,re]=n.useState(null),b=async()=>{try{if(w(!0),S(null),!s)throw new Error("Note ID is required");const d=await t(s);N(d),await h(parseInt(s),F,G)}catch(d){S(d.message||"Failed to load note")}finally{w(!1)}},i=async d=>{if(s)try{await h(parseInt(s),d,G)}catch(T){S(T.message||"Failed to load comments")}};n.useEffect(()=>{if(!s){S("Note ID is required"),w(!1);return}b()},[s,t,F]);const f=async()=>{if(s&&confirm("Are you sure you want to delete this note?")){H(!0);try{await l(s),o("/")}catch(d){S(d.message||"Failed to delete note"),H(!1)}}},v=async()=>{if(!(!s||!L.trim()))try{await x(parseInt(s),L,k??void 0),I(""),A(null),O(1),await i(1)}catch(d){S(d.message||"Failed to add comment")}},M=async()=>{if(!(!_.trim()||!y)&&s){S(null);try{await x(parseInt(s),_,B??void 0,y),j(null),R(""),$(null),bs(!1),await i(F)}catch(d){console.error("Edit comment error:",d),S(d.message||"Failed to edit comment")}}},V=async d=>{if(confirm("Apakah Anda yakin ingin menghapus komentar ini?"))try{await m(d);const T=r.length-1,q=Math.ceil(T/G)||1,D=F>q?q:F;D!==F&&O(D),await i(D)}catch(T){S(T.message||"Failed to delete comment")}},J=async d=>{d!==F&&(O(d),await i(d))},be=d=>{if(!d)return"Unknown date";try{return new Date(d).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return"Invalid date"}},Ee=n.useRef(null);n.useEffect(()=>{W&&he()},[W]);const he=async()=>{ae(!0);try{const d=await U("/files/notes_app","GET");le(d.files||[])}catch(d){console.error("Error fetching gallery files:",d),K(d.response?.meta?.message||"Failed to load gallery files")}finally{ae(!1)}},Le=d=>{const T=d.target.files;if(!T)return;const q=Array.from(T);ue(D=>[...D,...q]),K(null)},Xe=d=>{ue(T=>T.filter((q,D)=>D!==d))},es=async()=>{if(Q.length===0){K("Please select at least one file to upload");return}ve(!0),K(null),re(null);try{for(let d=0;d<Q.length;d++){const T=Q[d],q=`thumbnail_${d+1}`;try{const D=new FormData;D.append("fields",q),D.append(q,T);for(let ke=0;ke<=100;ke+=10)ie(ce=>({...ce,[T.name]:ke})),await new Promise(ce=>setTimeout(ce,50));await U("/files/notes_app/bulk-upload","POST",D)}catch(D){console.error(`Error uploading ${T.name}:`,D),K(`Failed to upload ${T.name}: ${D.response?.meta?.message||D.message}`)}}ue([]),re(`Successfully uploaded ${Q.length} file(s)`),await he()}catch(d){K(d.response?.meta?.message||"Failed to upload files")}finally{ve(!1),ie({})}},Ue=d=>{if(d===0)return"0 Bytes";const T=1024,q=["Bytes","KB","MB","GB"],D=Math.floor(Math.log(d)/Math.log(T));return parseFloat((d/Math.pow(T,D)).toFixed(2))+" "+q[D]},ss=d=>d.startsWith("image/"),p=d=>{I(d)},P=d=>{y?$(d):A(d),Z(!1)},z=()=>{A(null)},Y=()=>{if(!a||a.total_page<=1)return null;const d=[],T=5,q=a.total_page;let D=Math.max(1,F-Math.floor(T/2)),ke=Math.min(q,D+T-1);ke-D+1<T&&(D=Math.max(1,ke-T+1));for(let ce=D;ce<=ke;ce++)d.push(ce);return e.jsxs("div",{className:"flex items-center justify-between mt-6 p-4 bg-gray-700 rounded-lg",children:[e.jsx("div",{className:"flex items-center space-x-2 text-sm text-gray-400",children:e.jsxs("span",{children:["Showing ",(F-1)*G+1," to ",Math.min(F*G,a.total_data)," of ",a.total_data," comments"]})}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsxs("button",{onClick:()=>J(F-1),disabled:F===1||c,className:"flex items-center space-x-1 px-3 py-2 text-gray-400 hover:text-gray-200 hover:bg-gray-600 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[e.jsx(cs,{className:"w-4 h-4"}),e.jsx("span",{children:"Previous"})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[D>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>J(1),className:"px-3 py-2 text-gray-400 hover:text-gray-200 hover:bg-gray-600 rounded-lg transition-colors",children:"1"}),D>2&&e.jsx("span",{className:"text-gray-400",children:"..."})]}),d.map(ce=>e.jsx("button",{onClick:()=>J(ce),disabled:c,className:`px-3 py-2 rounded-lg transition-colors ${F===ce?"bg-blue-600 text-white":"text-gray-400 hover:text-gray-200 hover:bg-gray-600"}`,children:ce},ce)),ke<q&&e.jsxs(e.Fragment,{children:[ke<q-1&&e.jsx("span",{className:"text-gray-400",children:"..."}),e.jsx("button",{onClick:()=>J(q),className:"px-3 py-2 text-gray-400 hover:text-gray-200 hover:bg-gray-600 rounded-lg transition-colors",children:q})]})]}),e.jsxs("button",{onClick:()=>J(F+1),disabled:F===q||c,className:"flex items-center space-x-1 px-3 py-2 text-gray-400 hover:text-gray-200 hover:bg-gray-600 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[e.jsx("span",{children:"Next"}),e.jsx(ds,{className:"w-4 h-4"})]})]})]})};function Me(d){return d.trim().split(/\s+/).map(T=>T.charAt(0).toUpperCase()).join("")}const[Ae,Ds]=n.useState(!1),[Os,ps]=n.useState(!1),[Gs,zs]=n.useState(""),[Bs,bs]=n.useState(!1),Vs=d=>{zs(d),ps(!0)},fs=u?.is_editable===!0,ys=u?.is_deletable===!0;return e.jsxs("div",{className:"min-h-screen bg-gray-900",children:[e.jsx("div",{className:"bg-gradient-to-r from-gray-800 to-gray-900 border-b border-gray-700",children:e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>o("/"),className:"p-2 text-gray-400 hover:text-gray-200 hover:bg-gray-700 rounded-lg transition-colors",children:e.jsx(Je,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-100",children:"Note Details"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"View and manage your note"})]})]})})}),e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-xl shadow-xl",children:g?e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):C?e.jsxs("div",{className:"text-center py-20",children:[e.jsx("div",{className:"text-red-400 text-6xl mb-4",children:""}),e.jsx("p",{className:"text-red-400 text-lg font-medium mb-2",children:"Error Loading Note"}),e.jsx("p",{className:"text-gray-400 mb-6",children:C}),e.jsx("button",{onClick:()=>o("/"),className:"px-4 py-2 bg-gray-700 text-gray-300 rounded-lg hover:bg-gray-600 transition-colors",children:"Back to Notes"})]}):u?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-6 pt-6",children:e.jsxs("div",{className:"flex flex-col space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-semibold text-sm",children:Me(u.user_owner?.username||"")}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-gray-200 font-medium text-sm truncate",children:u.user_owner?.username||u.user_owner?.fullname||"Unknown user"}),e.jsxs("div",{className:"flex gap-2 text-xs text-gray-400",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(We,{className:"w-3 h-3"}),e.jsx("span",{children:be(u.created_at)||"No date"})]}),e.jsx("span",{children:be(u.created_at)!==be(u.updated_at)?"(Edited)":""})]})]})]}),(fs||ys)&&e.jsxs("div",{className:"flex items-center space-x-3",children:[fs&&e.jsxs(se,{to:`/notes/${u.id}/edit`,className:"flex items-center space-x-2 px-2 py-2 bg-gradient-to-r from-blue-600 to-blue-500 text-white rounded-lg hover:from-blue-700 hover:to-blue-600 transition-all duration-200 shadow-lg hover:shadow-blue-500/25",children:[e.jsx(as,{className:"w-3 h-3"}),e.jsx("span",{className:"text-sm",children:"Edit"})]}),ys&&e.jsxs("button",{onClick:f,disabled:E,className:"flex items-center space-x-2 px-2 py-2 bg-gradient-to-r from-red-600 to-red-500 text-white rounded-lg hover:from-red-700 hover:to-red-600 transition-all duration-200 shadow-lg hover:shadow-red-500/25 disabled:opacity-50",children:[e.jsx(Fe,{className:"w-3 h-3"}),e.jsx("span",{className:"text-sm",children:E?"Deleting...":"Delete"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-100",children:u.title}),u.tags?.length?e.jsx("div",{className:"flex flex-wrap gap-2",children:u.tags.map((d,T)=>e.jsxs("span",{className:"inline-flex items-center space-x-1 bg-gray-700 text-gray-300 text-sm px-3 py-1 rounded-lg",children:[e.jsx(Pe,{className:"w-3 h-3"}),e.jsx("span",{children:d})]},T))}):null]})]})}),e.jsxs("div",{className:"p-6 border-b border-gray-700 space-y-2",children:[u.body?e.jsx("div",{className:"prose prose-invert max-w-none",children:e.jsx("div",{className:"ql-editor whitespace-pre-wrap text-gray-300 leading-relaxed font-sans",dangerouslySetInnerHTML:{__html:Ss.sanitize(u.body)}})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Be,{className:"w-12 h-12 text-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400 text-lg",children:"This note is empty"}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Click Edit to add content"})]}),u.thumbnail&&e.jsx("div",{className:"rounded-lg overflow-hidden relative",children:Ae?e.jsxs("div",{className:"w-full h-32 flex flex-col items-center justify-center bg-gray-800 text-gray-300 text-xs",children:[e.jsx(_s,{className:"w-6 h-6 mb-1 opacity-80"}),e.jsx("span",{children:"Image failed to load"})]}):e.jsxs("div",{className:"relative inline-block overflow-hidden rounded-lg flex-shrink-0",children:[e.jsx("img",{src:`https://minio-s3.radarku.online/radarku-bucket/notes_app/${u.thumbnail}`,alt:"Note thumbnail",className:"object-contain hover:scale-105 transition-transform duration-300",loading:"lazy",onError:()=>Ds(!0)}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 hover:bg-opacity-30 transition-all duration-300 flex items-center justify-center opacity-0 hover:opacity-100",children:e.jsxs("div",{className:"px-3 py-1 bg-white/20 backdrop-blur-sm text-white rounded-lg hover:bg-white/30 transition-colors text-xs",onClick:()=>{Vs(`https://minio-s3.radarku.online/radarku-bucket/notes_app/${u.thumbnail}`)},children:[e.jsx(je,{className:"w-3 h-3 inline mr-1"}),"View"]})})]})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(rs,{className:"w-5 h-5 text-gray-400"}),e.jsx("h3",{className:"text-lg font-medium text-gray-300",children:"Comments"}),e.jsx("span",{className:"bg-blue-600 text-white text-sm px-2 py-1 rounded-full",children:a?.total_data||r.length})]}),e.jsxs("div",{className:"mb-6 bg-gray-700 rounded-lg p-4",children:[e.jsx("div",{className:"mb-4",children:e.jsx("div",{className:"bg-gray-600 border border-gray-500 rounded-lg overflow-hidden",children:e.jsx(Ve,{value:L,onChange:p,modules:Es,formats:Ts,placeholder:"Write your comment here...",theme:"snow",className:"auto-resize-quill"})})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center space-x-3",children:k?e.jsxs("div",{className:"relative",children:[e.jsx("a",{href:`https://minio-s3.radarku.online/radarku-bucket/notes_app/${k}`,target:"_blank",rel:"noopener noreferrer",className:"block",title:"View image in new tab",children:e.jsx("img",{src:`https://minio-s3.radarku.online/radarku-bucket/notes_app/${k}`,alt:"Thumbnail preview",className:"w-32 h-32 object-cover rounded-lg border border-gray-600"})}),e.jsx("button",{type:"button",onClick:z,className:"absolute -top-2 -right-2 p-1 bg-red-600 hover:bg-red-700 text-white rounded-full",title:"Remove thumbnail",children:e.jsx(te,{className:"w-3 h-3"})})]}):e.jsx("button",{type:"button",onClick:()=>Z(!0),className:"flex items-center space-x-2 px-2 py-2 bg-gray-600 text-gray-300 rounded-full hover:bg-gray-500 transition-colors",title:"Add thumbnail",children:e.jsx(ge,{className:"w-4 h-4"})})}),e.jsx("button",{onClick:v,disabled:!L.trim()||c,className:"flex items-center space-x-2 px-2 py-2 bg-blue-600 text-white rounded-full hover:bg-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:c?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):e.jsx(Qs,{className:"w-4 h-4"})})]})]}),c&&r.length===0?e.jsx("div",{className:"flex justify-center items-center h-40",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):e.jsxs("div",{className:"space-y-4",children:[r.map(d=>{const T=d.is_editable===!0,q=d.is_deletable===!0;return e.jsxs("div",{className:"bg-gray-700 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-sm font-medium",children:d.user_name?.charAt(0)?.toUpperCase()||"U"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-100 font-medium",children:d.user_name||"Unknown User"}),e.jsxs("div",{className:"flex gap-2 text-gray-400 text-sm",children:[e.jsx("p",{children:be(d.created_at)}),e.jsx("span",{children:be(d.created_at)!==be(d.updated_at)?"(Edited)":""})]})]})]}),y!==String(d.id)&&(T||q)&&e.jsxs("div",{className:"flex space-x-1",children:[T&&e.jsx("button",{onClick:()=>{j(String(d.id)),R(d.body||""),$(d.thumbnail||null),bs(!0)},className:"text-gray-400 hover:text-blue-400 p-1",title:"Edit comment",children:e.jsx(as,{className:"w-4 h-4"})}),q&&e.jsx("button",{onClick:()=>V(String(d.id)),className:"text-gray-400 hover:text-red-400 p-1",title:"Delete comment",children:e.jsx(Fe,{className:"w-4 h-4"})})]})]}),d.thumbnail&&Bs==!1&&e.jsx("div",{className:"mb-3",children:e.jsx("a",{href:`https://minio-s3.radarku.online/radarku-bucket/notes_app/${d.thumbnail}`,target:"_blank",rel:"noopener noreferrer",className:"inline-block",title:"View image in new tab",children:e.jsx("img",{src:`https://minio-s3.radarku.online/radarku-bucket/notes_app/${d.thumbnail}`,alt:"Comment thumbnail",className:"w-32 h-32 object-cover rounded-lg border border-gray-600 hover:opacity-90 transition-opacity"})})}),y===String(d.id)&&e.jsx("div",{className:"flex items-center space-x-3",children:B?e.jsxs("div",{className:"relative",children:[e.jsx("a",{href:`https://minio-s3.radarku.online/radarku-bucket/notes_app/${B}`,target:"_blank",rel:"noopener noreferrer",className:"block",title:"View image in new tab",children:e.jsx("img",{src:`https://minio-s3.radarku.online/radarku-bucket/notes_app/${B}`,alt:"Thumbnail preview",className:"w-32 h-32 object-cover rounded-lg border border-gray-600"})}),e.jsx("button",{type:"button",onClick:()=>$(null),className:"absolute -top-2 -right-2 p-1 bg-red-600 hover:bg-red-700 text-white rounded-full",title:"Remove thumbnail",children:e.jsx(te,{className:"w-3 h-3"})})]}):e.jsxs("button",{type:"button",onClick:()=>Z(!0),className:"flex items-center space-x-2 px-3 py-2 bg-gray-600 text-gray-300 rounded-lg hover:bg-gray-500 transition-colors",title:"Add thumbnail",children:[e.jsx(ge,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Change Image"})]})}),y===String(d.id)?e.jsxs("div",{className:"space-y-4 mt-2",children:[e.jsx("div",{className:"bg-gray-600 border border-gray-500 rounded-lg overflow-hidden",children:e.jsx(Ve,{value:_,onChange:R,modules:Es,formats:Ts,theme:"snow",className:"auto-resize-quill"})}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[e.jsx("button",{onClick:()=>{j(null),R(""),$(null)},className:"px-4 py-2 bg-gray-600 text-gray-300 rounded-lg hover:bg-gray-500 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:()=>M(),disabled:!_.trim()||c,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Save Changes"})]})]}):e.jsx("div",{className:"ql-editor text-gray-300",dangerouslySetInnerHTML:{__html:Ss.sanitize(d.body||"")}})]},d.id)}),r.length===0&&!c&&e.jsxs("div",{className:"text-center py-8 text-gray-400",children:[e.jsx(rs,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No comments yet. Be the first to comment!"})]})]}),e.jsx(Y,{})]})]}):e.jsxs("div",{className:"text-center py-20",children:[e.jsx("div",{className:"text-gray-600 text-6xl mb-4",children:""}),e.jsx("p",{className:"text-gray-400 text-lg",children:"Note not found"}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"The note you're looking for doesn't exist"}),e.jsx("button",{onClick:()=>o("/"),className:"mt-6 px-4 py-2 bg-gray-700 text-gray-300 rounded-lg hover:bg-gray-600 transition-colors",children:"Back to Notes"})]})})}),W&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-xl w-full max-w-6xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-gray-700 flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-100",children:"Select Thumbnail"}),e.jsx("button",{onClick:()=>Z(!1),className:"p-2 text-gray-400 hover:text-gray-200 hover:bg-gray-700 rounded-lg transition-colors",children:e.jsx(te,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"border-b border-gray-700",children:e.jsxs("div",{className:"flex",children:[e.jsx("button",{className:`px-6 py-3 font-medium ${ee==="gallery"?"text-blue-400 border-b-2 border-blue-400":"text-gray-400 hover:text-gray-200"}`,onClick:()=>xe("gallery"),children:"Gallery"}),e.jsx("button",{className:`px-6 py-3 font-medium ${ee==="upload"?"text-blue-400 border-b-2 border-blue-400":"text-gray-400 hover:text-gray-200"}`,onClick:()=>xe("upload"),children:"Upload New"})]})}),e.jsxs("div",{className:"p-6 overflow-y-auto flex-grow",children:[ee==="gallery"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-300",children:"Your Uploaded Images"}),e.jsxs("button",{onClick:he,disabled:ne,className:"flex items-center space-x-2 px-3 py-1 bg-gray-700 text-gray-300 rounded-lg hover:bg-gray-600 disabled:opacity-50",children:[e.jsx(Ze,{className:`w-4 h-4 ${ne?"animate-spin":""}`}),e.jsx("span",{children:"Refresh"})]})]}),ne?e.jsx("div",{className:"flex justify-center items-center h-40",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):Ne.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx(ge,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No images found. Upload some images to get started!"})]}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:Ne.map(d=>ss(d.mime)&&e.jsxs("div",{className:"cursor-pointer group bg-gray-700 rounded-lg p-3",onClick:()=>P(d.name),children:[e.jsx("div",{className:"aspect-square overflow-hidden rounded-lg border-2 border-gray-600 group-hover:border-blue-500 transition-colors",children:e.jsx("img",{src:`https://minio-s3.radarku.online/radarku-bucket/${d.path}/${d.name}`,alt:d.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-sm text-gray-300 truncate",children:d.name}),e.jsx("p",{className:"text-xs text-gray-400",children:Ue(d.size)})]})]},d.id))})]}),ee==="upload"&&e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-300 mb-4",children:"Upload New Image"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-600 rounded-xl p-8 text-center mb-6",children:[e.jsx("input",{type:"file",ref:Ee,onChange:Le,multiple:!0,accept:"image/*",className:"hidden"}),e.jsx(_e,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-300 mb-2",children:"Drag & drop images here or"}),e.jsx("button",{onClick:()=>Ee.current?.click(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-500 transition-colors",disabled:oe,children:"Browse Images"}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"Supports JPG, PNG, GIF, and other image formats"})]}),Q.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"text-md font-medium text-gray-300 mb-3",children:["Selected Images (",Q.length,")"]}),e.jsx("div",{className:"space-y-3",children:Q.map((d,T)=>e.jsxs("div",{className:"flex items-center justify-between bg-gray-700 p-3 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("img",{src:URL.createObjectURL(d),alt:d.name,className:"w-12 h-12 object-cover rounded"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-gray-100 text-sm font-medium truncate",children:d.name}),e.jsx("p",{className:"text-gray-400 text-xs",children:Ue(d.size)})]})]}),e.jsx("button",{onClick:()=>Xe(T),className:"text-gray-400 hover:text-red-400 transition-colors",disabled:oe,children:e.jsx(te,{className:"w-4 h-4"})})]},T))}),e.jsx("button",{onClick:es,disabled:oe,className:"w-full mt-4 flex items-center justify-center space-x-2 px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:oe?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),e.jsx("span",{children:"Uploading..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(_e,{className:"w-5 h-5"}),e.jsxs("span",{children:["Upload ",Q.length," Image(s)"]})]})})]}),pe&&e.jsx("div",{className:"bg-red-900/50 border border-red-700 rounded-xl p-4 mb-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Qe,{className:"w-5 h-5 text-red-400"}),e.jsx("p",{className:"text-red-200",children:pe})]})}),we&&e.jsx("div",{className:"bg-green-900/50 border border-green-700 rounded-xl p-4 mb-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ye,{className:"w-5 h-5 text-green-400"}),e.jsx("p",{className:"text-green-200",children:we})]})})]})]}),e.jsx("div",{className:"p-6 border-t border-gray-700 flex justify-end",children:e.jsx("button",{onClick:()=>Z(!1),className:"px-6 py-3 bg-gray-700 text-gray-300 rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"})})]})}),e.jsx($s,{isOpen:Os,onClose:()=>ps(!1),imageUrl:Gs,fileName:u?.thumbnail})]})}function Ct({activeMenu:s,setActiveMenu:o}){const[t,l]=n.useState(!1),{user:r,logout:a}=me(),c=Se(),x=Ms(),m=[{id:"notes",icon:Be,label:"Notes",path:"/"},{id:"media",icon:ge,label:"Media",path:"/media"},{id:"profile",icon:ze,label:"Profile",path:"/profile"}],h=()=>{a()},u=g=>{o(g.id),g.path!==x.pathname&&c(g.path)},N=g=>s===g.id||x.pathname===g.path;return e.jsxs("div",{className:`${t?"w-64":"w-16"} bg-gray-800/50 backdrop-blur-xl border-r border-gray-700/50 transition-all duration-300 flex flex-col h-full`,onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),children:[e.jsx("div",{className:"p-4 border-b border-gray-700/50",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-600 to-blue-500 rounded-lg flex items-center justify-center",children:e.jsx(Be,{className:"w-5 h-5 text-white"})}),t&&e.jsx("h1",{className:"text-lg font-bold text-gray-100 whitespace-nowrap",children:"ModernNotes"})]})}),e.jsx("nav",{className:"flex-1 py-4",children:e.jsx("div",{className:"space-y-2 px-2",children:m.map(g=>{const w=g.icon,C=N(g);return e.jsxs("button",{onClick:()=>u(g),className:`w-full flex items-center space-x-3 px-3 py-3 rounded-xl transition-all duration-200 group ${C?"bg-blue-600 text-white shadow-lg shadow-blue-500/25":"text-gray-400 hover:text-gray-200 hover:bg-gray-700/50"}`,children:[e.jsx(w,{className:"w-5 h-5 flex-shrink-0"}),t&&e.jsx("span",{className:"font-medium whitespace-nowrap",children:g.label})]},g.id)})})}),e.jsxs("div",{className:"p-2 border-t border-gray-700/50",children:[t&&r?.email&&e.jsx("div",{className:"mb-3 px-3 py-2 bg-gray-700/50 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ze,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-300 truncate",children:r?.email})]})}),e.jsxs("button",{onClick:h,className:"w-full flex items-center space-x-3 p-3 lg:justify-center text-gray-400 hover:text-red-400 hover:bg-gray-700/50 rounded-xl transition-all duration-200",children:[e.jsx(Xs,{className:"w-5 h-5 flex-shrink-0"}),t&&e.jsx("span",{className:"font-medium whitespace-nowrap",children:"Logout"})]})]})]})}function Et({children:s,activeMenu:o="notes"}){const[t,l]=n.useState(o);return e.jsxs("div",{className:"h-screen w-full bg-gray-900 flex overflow-hidden",children:[e.jsx(Ct,{activeMenu:t,setActiveMenu:l}),e.jsx("div",{className:"flex-1 flex flex-col overflow-hidden",children:e.jsx("div",{className:"flex-1 overflow-y-auto",children:s})})]})}function Tt(){const s=Se(),o=Ms(),t=o.state?.hasToken||!1,l=o.state?.message||"Your email has been successfully verified.";return n.useEffect(()=>{const r=setTimeout(()=>{s(t?"/":"/login")},5e3);return()=>clearTimeout(r)},[s,t]),e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 opacity-10",children:e.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"radial-gradient(circle at 25px 25px, rgba(255,255,255,0.1) 2px, transparent 0)",backgroundSize:"50px 50px"}})}),e.jsxs("div",{className:"relative w-full max-w-md",children:[e.jsxs("div",{className:"bg-gray-800/80 backdrop-blur-xl border border-gray-700/50 rounded-2xl shadow-2xl p-8 text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-r from-green-600 to-green-500 rounded-2xl mb-6 shadow-lg",children:e.jsx(ye,{className:"w-10 h-10 text-white"})}),e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-gray-100 to-gray-300 bg-clip-text text-transparent mb-4",children:"Email Verified!"}),e.jsx("p",{className:"text-gray-300 mb-2",children:l}),e.jsx("p",{className:"text-gray-400 text-sm mb-6",children:t?"You will be redirected to home page in 5 seconds...":"You will be redirected to login page in 5 seconds..."}),e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2 mb-6",children:e.jsx("div",{className:"bg-green-500 h-2 rounded-full animate-progress"})}),e.jsx("div",{className:"space-y-3",children:t?e.jsxs(e.Fragment,{children:[e.jsxs(se,{to:"/",className:"w-full flex items-center justify-center space-x-2 px-6 py-3 bg-gradient-to-r from-green-600 to-green-500 text-white rounded-xl hover:from-green-700 hover:to-green-600 transition-all duration-200 shadow-lg hover:shadow-green-500/25",children:[e.jsx(Ns,{className:"w-5 h-5"}),e.jsx("span",{children:"Go to Home"})]}),e.jsxs(se,{to:"/login",className:"w-full flex items-center justify-center space-x-2 px-6 py-3 text-gray-400 hover:text-gray-200 hover:bg-gray-700/50 rounded-xl transition-all duration-200",children:[e.jsx(De,{className:"w-5 h-5"}),e.jsx("span",{children:"Login with Different Account"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(se,{to:"/login",className:"w-full flex items-center justify-center space-x-2 px-6 py-3 bg-gradient-to-r from-green-600 to-green-500 text-white rounded-xl hover:from-green-700 hover:to-green-600 transition-all duration-200 shadow-lg hover:shadow-green-500/25",children:[e.jsx(De,{className:"w-5 h-5"}),e.jsx("span",{children:"Go to Login"})]}),e.jsxs(se,{to:"/",className:"w-full flex items-center justify-center space-x-2 px-6 py-3 text-gray-400 hover:text-gray-200 hover:bg-gray-700/50 rounded-xl transition-all duration-200",children:[e.jsx(Ns,{className:"w-5 h-5"}),e.jsx("span",{children:"Back to Home"})]})]})})]}),e.jsx("div",{className:"absolute -top-4 -left-4 w-24 h-24 bg-green-500/20 rounded-full blur-xl"}),e.jsx("div",{className:"absolute -bottom-4 -right-4 w-32 h-32 bg-blue-500/20 rounded-full blur-xl"})]}),e.jsx("style",{children:`
          @keyframes progress {
            from { width: 0%; }
            to { width: 100%; }
          }
          .animate-progress {
            animation: progress 5s linear forwards;
          }
        `})]})}function Ft(){const[s]=ms(),o=s.get("email"),[t,l]=n.useState(60),[r,a]=n.useState(!1);n.useEffect(()=>{if(t>0){const x=setTimeout(()=>l(t-1),1e3);return()=>clearTimeout(x)}else a(!0)},[t]);const c=()=>{console.log("Resending verification email to:",o),l(60),a(!1)};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 opacity-10",children:e.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"radial-gradient(circle at 25px 25px, rgba(255,255,255,0.1) 2px, transparent 0)",backgroundSize:"50px 50px"}})}),e.jsxs("div",{className:"relative w-full max-w-md",children:[e.jsxs("div",{className:"bg-gray-800/80 backdrop-blur-xl border border-gray-700/50 rounded-2xl shadow-2xl p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-r from-blue-600 to-blue-500 rounded-2xl mb-4 shadow-lg",children:e.jsx(Re,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-gray-100 to-gray-300 bg-clip-text text-transparent mb-2",children:"Verify Your Email"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"We've sent a verification link to your email"})]}),o&&e.jsx("div",{className:"bg-blue-900/20 border border-blue-700/50 rounded-xl p-4 mb-6",children:e.jsx("p",{className:"text-blue-300 text-center font-medium",children:o})}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(ye,{className:"w-5 h-5 text-green-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-200 font-medium",children:"Check your inbox"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Look for an email from ModernNotes"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(ye,{className:"w-5 h-5 text-green-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-200 font-medium",children:"Click the verification link"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"This will confirm your email address"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(ye,{className:"w-5 h-5 text-green-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-200 font-medium",children:"Start using your account"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"You'll be redirected to login automatically"})]})]})]}),e.jsx("div",{className:"bg-gray-700/50 rounded-xl p-4 mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(We,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-gray-300 text-sm",children:r?"Ready to resend?":`Resend in ${t}s`})]}),e.jsx("button",{onClick:c,disabled:!r,className:"px-3 py-1 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Resend"})]})}),e.jsx("div",{className:"text-center mb-6",children:e.jsxs("p",{className:"text-gray-400 text-sm",children:["Didn't receive the email? Check your spam folder or"," "]})}),e.jsx("div",{className:"text-center",children:e.jsxs(se,{to:"/login",className:"inline-flex items-center text-blue-400 hover:text-blue-300 transition-colors",children:[e.jsx(Je,{className:"w-4 h-4 mr-2"}),"Logout"]})})]}),e.jsx("div",{className:"absolute -top-4 -left-4 w-24 h-24 bg-blue-500/20 rounded-full blur-xl"}),e.jsx("div",{className:"absolute -bottom-4 -right-4 w-32 h-32 bg-purple-500/20 rounded-full blur-xl"})]})]})}const _t=()=>{const[s]=ms(),o=Se(),t=s.get("token"),[l,r]=n.useState("loading"),[a,c]=n.useState(""),x=me(h=>h.setUser),m=me(h=>h.fetchUserProfile);return n.useEffect(()=>{(async()=>{if(!t){r("error"),c("Token verifikasi tidak ditemukan");return}try{const u=await U("/auths/verify_email","PUT",{token:t}),N=u?.meta?.message||"Email berhasil diverifikasi!";if(u.data?.access_token){localStorage.setItem("ACCESS_TOKEN",u.data.access_token),u.data.refresh_token&&localStorage.setItem("REFRESH_TOKEN",u.data.refresh_token),me.getState().loadFromStorage();try{await m()}catch(g){console.warn("Failed to fetch user profile:",g)}}r("success"),c(N),setTimeout(()=>{o("/email-verified",{state:{message:N,hasToken:!!u.data?.access_token}})},3e3)}catch(u){console.error("Email verification error:",u);let N="Gagal verifikasi email. Token tidak valid atau sudah kedaluwarsa.";u.response?N=u.response.meta?.message||u.response.message||N:u.message&&(N=u.message),r("error"),c(N)}})()},[t,o,x,m]),e.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center px-4",children:e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-xl shadow-xl p-8 max-w-md w-full",children:e.jsxs("div",{className:"text-center",children:[l==="loading"&&e.jsxs(e.Fragment,{children:[e.jsx(et,{className:"w-12 h-12 text-blue-500 animate-spin mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold text-gray-100 mb-2",children:"Memverifikasi Email"}),e.jsx("p",{className:"text-gray-400",children:"Sedang memverifikasi email Anda..."})]}),l==="success"&&e.jsxs(e.Fragment,{children:[e.jsx(ye,{className:"w-12 h-12 text-green-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold text-green-400 mb-2",children:"Verifikasi Berhasil!"}),e.jsx("p",{className:"text-gray-300 mb-4",children:a}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Anda akan diarahkan ke halaman sukses..."})]}),l==="error"&&e.jsxs(e.Fragment,{children:[e.jsx(As,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold text-red-400 mb-2",children:"Verifikasi Gagal"}),e.jsx("p",{className:"text-gray-300 mb-4",children:a}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{onClick:()=>o("/login"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-500 transition-colors",children:"Kembali ke Login"})})]})]})})})};function It(){const{user:s,loading:o,error:t,fetchUserProfile:l}=me(),[r,a]=n.useState(!1),[c,x]=n.useState({username:"",fullname:""});n.useEffect(()=>{!s||!s.id?l():x({username:s.username||"",fullname:s.fullname||""})},[s,l]);const m=()=>{x({username:s?.username||"",fullname:s?.fullname||""}),a(!1)},h=u=>u?new Date(u).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Unknown";return o&&!s?e.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):t&&!s?e.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-red-400 text-lg mb-4",children:["Error: ",t]}),e.jsx("button",{onClick:l,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-500",children:"Try Again"})]})}):e.jsx("div",{className:"min-h-screen bg-gray-900",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"bg-gradient-to-r from-gray-800 to-gray-900 border border-gray-700 rounded-xl shadow-xl p-6 mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-100",children:"Profile"}),e.jsx("p",{className:"text-gray-400",children:"Manage your account information"})]}),r?e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-500 transition-colors",disabled:o,children:[e.jsx(tt,{className:"w-4 h-4 mr-2"}),o?"Saving...":"Save"]}),e.jsxs("button",{onClick:m,className:"flex items-center px-4 py-2 text-gray-300 border border-gray-600 rounded-lg hover:bg-gray-700 transition-colors",children:[e.jsx(te,{className:"w-4 h-4 mr-2"}),"Cancel"]})]}):e.jsxs("button",{onClick:()=>a(!0),className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-500 transition-colors",children:[e.jsx(st,{className:"w-4 h-4 mr-2"}),"Edit Profile"]})]})}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-xl shadow-xl overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-700",children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-6",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-blue-600 to-blue-500 rounded-full flex items-center justify-center",children:e.jsx(ze,{className:"w-10 h-10 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-100",children:s?.fullname||s?.username||"User"}),e.jsx("p",{className:"text-gray-400",children:s?.email}),s?.email_verified_at?e.jsx("span",{className:"text-green-400 text-sm",children:" Email verified"}):e.jsx("span",{className:"text-yellow-400 text-sm",children:" Email not verified"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"User ID"}),e.jsx("div",{className:"bg-gray-700 border border-gray-600 text-gray-100 rounded-lg px-4 py-3 font-mono text-sm",children:s?.id||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Email"}),e.jsxs("div",{className:"bg-gray-700 border border-gray-600 text-gray-100 rounded-lg px-4 py-3 flex items-center",children:[e.jsx(Re,{className:"w-4 h-4 text-gray-400 mr-2"}),s?.email]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Username"}),r?e.jsx("input",{type:"text",value:c.username,onChange:u=>x(N=>({...N,username:u.target.value})),className:"w-full bg-gray-700 border border-gray-600 text-gray-100 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter username"}):e.jsx("div",{className:"bg-gray-700 border border-gray-600 text-gray-100 rounded-lg px-4 py-3",children:s?.username||"Not set"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Full Name"}),r?e.jsx("input",{type:"text",value:c.fullname,onChange:u=>x(N=>({...N,fullname:u.target.value})),className:"w-full bg-gray-700 border border-gray-600 text-gray-100 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter full name"}):e.jsx("div",{className:"bg-gray-700 border border-gray-600 text-gray-100 rounded-lg px-4 py-3",children:s?.fullname||"Not set"})]})]})]}),e.jsxs("div",{className:"p-6 bg-gray-700/30",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-300 mb-4",children:"Account Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(vs,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Member since"}),e.jsx("p",{className:"text-gray-200",children:h(s?.created_at)})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(vs,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Last updated"}),e.jsx("p",{className:"text-gray-200",children:h(s?.updated_at)})]})]})]})]})]}),t&&e.jsx("div",{className:"mt-6 p-4 bg-red-900/50 border border-red-700 rounded-xl",children:e.jsx("p",{className:"text-red-200",children:t})})]})})}function Pt({isOpen:s,onClose:o,onConfirm:t,fileName:l,fileType:r,isLoading:a=!1}){return s?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-xl max-w-md w-full",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-700",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-red-500 bg-opacity-20 rounded-full flex items-center justify-center",children:e.jsx(at,{className:"w-5 h-5 text-red-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-100",children:"Delete File"})]}),e.jsx("button",{onClick:o,className:"p-2 text-gray-400 hover:text-gray-200 hover:bg-gray-700 rounded-lg transition-colors",disabled:a,children:e.jsx(te,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("p",{className:"text-gray-300 mb-4",children:["Are you sure you want to delete this ",r,"?"]}),e.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-lg p-4 mb-4",children:[e.jsx("p",{className:"text-gray-100 font-medium truncate",children:l}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"This action cannot be undone. The file will be permanently deleted."})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 p-6 border-t border-gray-700",children:[e.jsx("button",{onClick:o,disabled:a,className:"px-4 py-2 text-gray-300 bg-gray-700 rounded-lg hover:bg-gray-600 disabled:opacity-50 transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:t,disabled:a,className:"flex items-center space-x-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-500 disabled:opacity-50 transition-colors",children:[a?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):e.jsx(Fe,{className:"w-4 h-4"}),e.jsx("span",{children:a?"Deleting...":"Delete"})]})]})]})}):null}function Mt(){const[s,o]=n.useState([]),[t,l]=n.useState(!1),[r,a]=n.useState({}),[c,x]=n.useState([]),[m,h]=n.useState([]),[u,N]=n.useState(!0),[g,w]=n.useState(null),[C,S]=n.useState(null),[E,H]=n.useState({total:0,used:0}),[F,O]=n.useState(!1),[G,y]=n.useState(!1),[j,_]=n.useState(null),[R,L]=n.useState(!1),[I,k]=n.useState(1),[A,B]=n.useState(1),[$,W]=n.useState(0),[Z,ee]=n.useState(10),xe=n.useRef(null),Ne=n.useRef(!0);n.useEffect(()=>{if(Ne.current){Ne.current=!1;return}le(I)},[I]);const le=async(i=1)=>{N(!0);try{const f=await os(`/files/notes_app?page=${i}&limit=10`,"GET"),v=f.data.files.map(M=>({...M,url:`undefined/upload/${M.path}/${M.name}`}));h(v),H({total:f.data.total_maximum,used:f.data.total_usage}),k(f.page.current_page),B(f.page.total_page),W(f.page.total_data),ee(f.page.limit)}catch(f){w(f.response?.meta?.message||"Failed to fetch gallery files")}finally{N(!1)}},ne=i=>{const f=i.target.files;if(!f)return;const v=Array.from(f);o(M=>[...M,...v]),w(null)},ae=i=>{o(f=>f.filter((v,M)=>M!==i))},Q=async()=>{if(s.length===0){w("Please select at least one file to upload");return}l(!0),w(null),S(null);try{const i=[];for(let f=0;f<s.length;f++){const v=s[f],M=`thumbnail_${f+1}`;try{const V=new FormData;V.append("fields",M),V.append(M,v);const J=await U("/files/notes_app/bulk-upload","POST",V);for(let Ee=0;Ee<=100;Ee+=10)a(he=>({...he,[v.name]:Ee})),await new Promise(he=>setTimeout(he,50));const be={id:J?.id||`file-${Date.now()}-${f}`,name:v.name,url:J?.url||URL.createObjectURL(v),size:v.size,type:v.type,uploadedAt:new Date().toISOString()};i.push(be)}catch(V){console.error(`Error uploading ${v.name}:`,V),w(`Failed to upload ${v.name}: ${V.response?.meta?.message||V.message}`)}}x(f=>[...f,...i]),o([]),S(`Successfully uploaded ${i.length} file(s)`),k(1),await le(1)}catch(i){w(i.response?.meta?.message||"Failed to upload files")}finally{l(!1),a({})}},ue=i=>{_(i),O(!0)},oe=i=>{_(i),y(!0)},ve=async()=>{if(j){L(!0);try{await U(`/files/notes_app/${j.id}`,"DELETE"),S(`File "${j.name}" deleted successfully`),y(!1),_(null),await le(I)}catch(i){w(i.response?.meta?.message||"Failed to delete file")}finally{L(!1)}}},Ce=async i=>{const f=`https://minio-s3.radarku.online/radarku-bucket/${i.path}/${i.name}`;try{const v=await fetch(f);if(!v.ok)throw new Error("Gagal mengambil file");const M=await v.blob(),V=window.URL.createObjectURL(M),J=document.createElement("a");J.href=V,J.download=i.name,document.body.appendChild(J),J.click(),document.body.removeChild(J)}catch(v){console.log(`error : ${v}`)}},ie=i=>{i>=1&&i<=A&&i!==I&&k(i)},pe=()=>{const i=[];if(A<=5)for(let v=1;v<=A;v++)i.push(v);else{let v=Math.max(1,I-Math.floor(2.5)),M=Math.min(A,v+5-1);M-v+1<5&&(v=Math.max(1,M-5+1)),v>1&&(i.push(1),v>2&&i.push("..."));for(let V=v;V<=M;V++)i.push(V);M<A&&(M<A-1&&i.push("..."),i.push(A))}return i},K=i=>{if(i===0)return"0 Bytes";const f=1024,v=["Bytes","KB","MB","GB"],M=Math.floor(Math.log(i)/Math.log(f));return parseFloat((i/Math.pow(f,M)).toFixed(2))+" "+v[M]},we=(i,f)=>f===0?"0%":`${(i/f*100).toFixed(1)}%`,re=i=>i.startsWith("image/")?e.jsx(ge,{className:"w-5 h-5"}):i.startsWith("video/")?e.jsx(ts,{className:"w-5 h-5"}):i.startsWith("audio/")?e.jsx(ts,{className:"w-5 h-5"}):e.jsx(ts,{className:"w-5 h-5"}),b=i=>i.startsWith("image/");return e.jsx("div",{className:"min-h-screen bg-gray-900",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"bg-gradient-to-r from-gray-800 to-gray-900 border border-gray-700 rounded-xl shadow-xl p-6 mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-purple-600 to-purple-500 rounded-xl flex items-center justify-center",children:e.jsx(ge,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-100",children:"Media Library"}),e.jsx("p",{className:"text-gray-400",children:"Upload and manage your media files"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm text-gray-300",children:["Storage: ",K(E.used)," / ",K(E.total)]}),e.jsx("div",{className:"w-full h-2 bg-gray-600 rounded-full mt-1",children:e.jsx("div",{className:"h-2 bg-blue-500 rounded-full transition-all",style:{width:we(E.used,E.total)}})}),e.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:[we(E.used,E.total)," used"]})]})]})}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-xl shadow-xl p-6 mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-100 mb-4",children:"Upload Files"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-600 rounded-xl p-8 text-center mb-4",children:[e.jsx("input",{type:"file",ref:xe,onChange:ne,multiple:!0,accept:"image/*,video/*,audio/*,.pdf,.doc,.docx,.txt",className:"hidden"}),e.jsx(_e,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-300 mb-2",children:"Drag & drop files here or"}),e.jsx("button",{onClick:()=>xe.current?.click(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-500 transition-colors",disabled:t,children:"Browse Files"}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"Supports images, videos, audio, and documents"})]}),s.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("h3",{className:"text-md font-medium text-gray-300 mb-3",children:["Selected Files (",s.length,")"]}),e.jsx("div",{className:"space-y-2",children:s.map((i,f)=>e.jsxs("div",{className:"flex items-center justify-between bg-gray-700 p-3 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[re(i.type),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-gray-100 text-sm font-medium truncate",children:i.name}),e.jsx("p",{className:"text-gray-400 text-xs",children:K(i.size)})]})]}),e.jsx("button",{onClick:()=>ae(f),className:"text-gray-400 hover:text-red-400 transition-colors",disabled:t,children:e.jsx(te,{className:"w-4 h-4"})})]},f))})]}),s.length>0&&e.jsx("button",{onClick:Q,disabled:t,className:"w-full flex items-center justify-center space-x-2 px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),e.jsxs("span",{children:["Uploading... (",Object.keys(r).length,"/",s.length,")"]})]}):e.jsxs(e.Fragment,{children:[e.jsx(_e,{className:"w-5 h-5"}),e.jsxs("span",{children:["Upload ",s.length," File(s)"]})]})})]}),t&&s.length>0&&e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-xl shadow-xl p-6 mb-6",children:[e.jsx("h3",{className:"text-md font-medium text-gray-300 mb-4",children:"Upload Progress"}),e.jsx("div",{className:"space-y-3",children:s.map((i,f)=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-gray-300 text-sm truncate",children:i.name}),e.jsxs("span",{className:"text-gray-400 text-sm",children:[r[i.name]||0,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-300",style:{width:`${r[i.name]||0}%`}})})]},f))})]}),g&&e.jsx("div",{className:"bg-red-900/50 border border-red-700 rounded-xl p-4 mb-6",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Qe,{className:"w-5 h-5 text-red-400"}),e.jsx("p",{className:"text-red-200",children:g})]})}),C&&e.jsx("div",{className:"bg-green-900/50 border border-green-700 rounded-xl p-4 mb-6",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ye,{className:"w-5 h-5 text-green-400"}),e.jsx("p",{className:"text-green-200",children:C})]})}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-xl shadow-xl p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-100",children:["Your Files (",$,")"]}),$>0&&e.jsxs("span",{className:"text-sm text-gray-400",children:["Page ",I," of ",A,"  Showing ",(I-1)*Z+1,"-",Math.min(I*Z,$)," of ",$]})]}),e.jsxs("button",{onClick:()=>le(I),disabled:u,className:"flex items-center space-x-2 px-3 py-1 bg-gray-700 text-gray-300 rounded-lg hover:bg-gray-600 disabled:opacity-50",children:[e.jsx(Ze,{className:`w-4 h-4 ${u?"animate-spin":""}`}),e.jsx("span",{children:"Refresh"})]})]}),u?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):m.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx(ge,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No files found. Upload some files to get started!"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5 gap-4 mb-6",children:m.map(i=>e.jsxs("div",{className:"bg-gray-700 rounded-lg p-3 group relative",children:[b(i.mime)?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:`https://minio-s3.radarku.online/radarku-bucket/${i.path}/${i.name}`,alt:i.name,className:"w-full h-32 object-cover rounded-lg mb-2 cursor-pointer",loading:"lazy",onClick:()=>ue(i)}),e.jsxs("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 transition-all duration-200 rounded-lg flex items-center justify-center opacity-0 group-hover:opacity-100",children:[e.jsx("button",{onClick:()=>ue(i),className:"p-2 bg-white bg-opacity-20 rounded-full mr-2 hover:bg-opacity-30 transition-colors",title:"View image",children:e.jsx(je,{className:"w-4 h-4 text-white"})}),e.jsx("button",{onClick:()=>Ce(i),className:"p-2 bg-white bg-opacity-20 rounded-full mr-2 hover:bg-opacity-30 transition-colors",title:"Download file",children:e.jsx(ns,{className:"w-4 h-4 text-white"})}),e.jsx("button",{onClick:()=>oe(i),className:"p-2 bg-white bg-opacity-20 rounded-full hover:bg-opacity-30 transition-colors",title:"Delete file",children:e.jsx(Fe,{className:"w-4 h-4 text-white"})})]})]}):e.jsx("div",{className:"w-full h-32 bg-gray-600 rounded-lg flex items-center justify-center mb-2",children:re(i.mime)}),e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[re(i.mime),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-gray-100 text-sm font-medium truncate",children:i.name.split("/").pop()}),e.jsx("p",{className:"text-gray-400 text-xs",children:K(i.size)})]})]}),e.jsxs("div",{className:"text-xs text-gray-400 space-y-1",children:[e.jsxs("p",{children:["Uploaded: ",new Date(i.created_at).toLocaleDateString()]}),e.jsxs("p",{children:["Type: ",i.mime]})]}),!b(i.mime)&&e.jsxs("div",{className:"flex justify-between items-center mt-2 pt-2 border-t border-gray-600",children:[e.jsxs("button",{onClick:()=>window.open(`https://minio-s3.radarku.online/radarku-bucket/${i.path}/${i.name}`,"_blank"),className:"text-blue-400 hover:text-blue-300 text-xs flex items-center",children:[e.jsx(je,{className:"w-3 h-3 mr-1"}),"View"]}),e.jsxs("button",{onClick:()=>Ce(i),className:"text-green-400 hover:text-green-300 text-xs flex items-center",children:[e.jsx(ns,{className:"w-3 h-3 mr-1"}),"Download"]}),e.jsxs("button",{onClick:()=>oe(i),className:"text-red-400 hover:text-red-300 text-xs flex items-center",children:[e.jsx(Fe,{className:"w-3 h-3 mr-1"}),"Delete"]})]})]},i.id))}),e.jsx($s,{isOpen:F,onClose:()=>O(!1),imageUrl:j?`https://minio-s3.radarku.online/radarku-bucket/${j.path}/${j.name}`:"",fileName:j?.name||"",fileSize:j?.size||0,uploadedAt:j?.created_at||""}),e.jsx(Pt,{isOpen:G,onClose:()=>{y(!1),_(null)},onConfirm:ve,fileName:j?.name||"",fileType:j&&b(j.mime)?"image":"file",isLoading:R}),A>1&&e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsxs("button",{onClick:()=>ie(I-1),disabled:I===1,className:"flex items-center px-3 py-2 text-sm text-gray-300 bg-gray-700 rounded-lg hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[e.jsx(cs,{className:"w-4 h-4 mr-1"}),"Previous"]}),e.jsx("div",{className:"flex items-center space-x-1",children:pe().map((i,f)=>e.jsx("div",{children:i==="..."?e.jsx("span",{className:"px-3 py-2 text-gray-400",children:"..."}):e.jsx("button",{onClick:()=>ie(i),className:`px-3 py-2 text-sm rounded-lg transition-colors ${I===i?"bg-blue-600 text-white":"text-gray-300 bg-gray-700 hover:bg-gray-600"}`,children:i})},f))}),e.jsxs("button",{onClick:()=>ie(I+1),disabled:I===A,className:"flex items-center px-3 py-2 text-sm text-gray-300 bg-gray-700 rounded-lg hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:["Next",e.jsx(ds,{className:"w-4 h-4 ml-1"})]})]})]})]}),c.length>0&&e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-xl shadow-xl p-6 mt-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-100 mb-4",children:["Recently Uploaded (",c.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:c.map((i,f)=>e.jsxs("div",{className:"bg-gray-700 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[re(i.type),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-gray-100 text-sm font-medium truncate",children:i.name}),e.jsx("p",{className:"text-gray-400 text-xs",children:K(i.size)})]})]}),i.type.startsWith("image/")&&e.jsx("img",{src:i.url,alt:i.name,className:"w-full h-32 object-cover rounded-lg mb-2"}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-400 text-xs",children:new Date(i.uploadedAt).toLocaleDateString()}),e.jsx("a",{href:i.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 text-xs",children:"View"})]})]},f))})]})]})})}function At(){const[s]=ms(),o=Se(),t=s.get("token"),[l,r]=n.useState({password:"",confirmPassword:""}),[a,c]=n.useState(!1),[x,m]=n.useState(!1),[h,u]=n.useState(!1),[N,g]=n.useState(""),[w,C]=n.useState(""),S=async E=>{if(E.preventDefault(),!t){g("Reset token is missing");return}if(l.password!==l.confirmPassword){g("Passwords do not match");return}if(l.password.length<8){g("Password must be at least 8 characters long");return}u(!0),g("");try{await U("/auths/reset_password","PUT",{token:t,password:l.password}),C("Password has been reset successfully!"),setTimeout(()=>{o("/login")},3e3)}catch(H){g(H.response?.meta?.message||"Failed to reset password")}finally{u(!1)}};return t?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-gray-800/80 backdrop-blur-xl border border-gray-700/50 rounded-2xl shadow-2xl p-8 w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-r from-blue-600 to-blue-500 rounded-2xl mb-4 shadow-lg",children:e.jsx(fe,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-gray-100 to-gray-300 bg-clip-text text-transparent mb-2",children:"Reset Password"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Enter your new password below"})]}),e.jsxs("form",{onSubmit:S,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(fe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:a?"text":"password",placeholder:"Enter new password",className:"w-full pl-12 pr-12 py-3 bg-gray-700/50 border border-gray-600 text-gray-100 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:l.password,onChange:E=>r({...l,password:E.target.value}),required:!0,minLength:8}),e.jsx("button",{type:"button",onClick:()=>c(!a),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-300",children:a?e.jsx(Oe,{className:"w-5 h-5"}):e.jsx(je,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Confirm Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(fe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:x?"text":"password",placeholder:"Confirm new password",className:"w-full pl-12 pr-12 py-3 bg-gray-700/50 border border-gray-600 text-gray-100 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:l.confirmPassword,onChange:E=>r({...l,confirmPassword:E.target.value}),required:!0,minLength:8}),e.jsx("button",{type:"button",onClick:()=>m(!x),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-300",children:x?e.jsx(Oe,{className:"w-5 h-5"}):e.jsx(je,{className:"w-5 h-5"})})]})]}),N&&e.jsx("div",{className:"bg-red-900/50 border border-red-700 text-red-200 px-4 py-3 rounded-xl",children:e.jsx("p",{className:"text-sm",children:N})}),w&&e.jsx("div",{className:"bg-green-900/50 border border-green-700 text-green-200 px-4 py-3 rounded-xl",children:e.jsx("p",{className:"text-sm",children:w})}),e.jsx("button",{type:"submit",disabled:h||w!=="",className:"w-full flex items-center justify-center space-x-2 px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-500 text-white rounded-xl hover:from-blue-700 hover:to-blue-600 transition-all duration-200 shadow-lg hover:shadow-blue-500/25 disabled:opacity-50 disabled:cursor-not-allowed",children:h?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),e.jsx("span",{children:"Resetting Password..."})]}):w?e.jsxs(e.Fragment,{children:[e.jsx(ye,{className:"w-5 h-5"}),e.jsx("span",{children:"Password Reset Successfully!"})]}):e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"w-5 h-5"}),e.jsx("span",{children:"Reset Password"})]})})]})]})}):e.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-2xl p-8 max-w-md w-full text-center",children:[e.jsx(As,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),e.jsx("h1",{className:"text-2xl font-bold text-red-400 mb-4",children:"Invalid Reset Link"}),e.jsx("p",{className:"text-gray-300 mb-6",children:"The password reset link is invalid or has expired."}),e.jsx("button",{onClick:()=>o("/login"),className:"px-6 py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-500 transition-colors",children:"Back to Login"})]})})}function Rt(){const s=window.onerror,o=window.onunhandledrejection;window.onerror=function(t,l,r,a,c){return(t.toString().includes("Token expired")||t.toString().includes("Unauthorized"))&&me.getState().logout(),s?s.call(this,t,l,r,a,c):!1},window.onunhandledrejection=function(t){return(t.reason?.message?.includes("Token expired")||t.reason?.message?.includes("Unauthorized")||t.reason?.response?.status===401)&&me.getState().logout(),o?o?.call(this,t):!1}}function Ie({children:s,activeMenu:o}){return me(l=>l.accessToken)?e.jsx(Et,{activeMenu:o,children:s}):e.jsx(Rs,{to:"/login"})}function Fs({children:s}){return me(t=>t.accessToken)?e.jsx(Rs,{to:"/"}):s}function Lt(){return n.useEffect(()=>{Rt()},[]),e.jsx(rt,{children:e.jsxs(lt,{children:[e.jsx(de,{path:"/login",element:e.jsx(Fs,{children:e.jsx(xt,{})})}),e.jsx(de,{path:"/register",element:e.jsx(Fs,{children:e.jsx(ut,{})})}),e.jsx(de,{path:"/verify-email",element:e.jsx(_t,{})}),e.jsx(de,{path:"/email-verified",element:e.jsx(Tt,{})}),e.jsx(de,{path:"/verify-email/notification",element:e.jsx(Ft,{})}),e.jsx(de,{path:"reset-password",element:e.jsx(At,{})}),e.jsx(de,{path:"/",element:e.jsx(Ie,{activeMenu:"notes",children:e.jsx(gt,{})})}),e.jsx(de,{path:"/notes/new",element:e.jsx(Ie,{activeMenu:"notes",children:e.jsx(yt,{})})}),e.jsx(de,{path:"/notes/:id",element:e.jsx(Ie,{activeMenu:"notes",children:e.jsx(St,{})})}),e.jsx(de,{path:"/notes/:id/edit",element:e.jsx(Ie,{activeMenu:"notes",children:e.jsx(kt,{})})}),e.jsx(de,{path:"/media",element:e.jsx(Ie,{activeMenu:"media",children:e.jsx(Mt,{})})}),e.jsx(de,{path:"/profile",element:e.jsx(Ie,{activeMenu:"profile",children:e.jsx(It,{})})})]})})}nt.createRoot(document.getElementById("root")).render(e.jsx(n.StrictMode,{children:e.jsx(Lt,{})}));
