import{c as Te,u as te,b as n,j as e,L as Ee,M as ue,d as Ke,E as He,e as le,f as V,U as Pe,g as X,P as Je,T as ne,h as oe,C as Ie,G as cs,i as ms,S as xs,F as ie,k as Fe,A as je,l as Ue,I as Y,X as J,m as _e,R as Le,n as de,o as $e,p as se,q as us,s as Ve,t as We,v as ye,w as Oe,x as gs,y as hs,z as ps,B as bs,D as fs,H as Be,J as Ce,K as ys,N as js,O as H,Q as Ye,V as Ns}from"./react-Bb-uLBNO.js";import{R as Qe}from"./quill-DMYfjAJY.js";import{p as vs}from"./vendor-Bw26N5ak.js";import{H as W,j as Xe,p as Ze,a as es}from"./highlight-DE77Zp-a.js";(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&a(u)}).observe(document,{childList:!0,subtree:!0});function t(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(r){if(r.ep)return;r.ep=!0;const o=t(r);fetch(r.href,o)}})();const ws="https://dev-notesapp.radarku.online";function Ge(){return new Promise(s=>{const l=document.createElement("div");l.id="session-expired-modal",l.style.position="fixed",l.style.top="0",l.style.left="0",l.style.width="100%",l.style.height="100%",l.style.backgroundColor="rgba(0, 0, 0, 0.7)",l.style.display="flex",l.style.justifyContent="center",l.style.alignItems="center",l.style.zIndex="9999",l.style.fontFamily="system-ui, -apple-system, sans-serif",l.innerHTML=`
      <div style="background: #1f2937; padding: 24px; border-radius: 12px; text-align: center; max-width: 350px; width: 90%; border: 1px solid #374151;">
        <div style="margin-bottom: 16px;">
          <svg style="width: 48px; height: 48px; color: #f59e0b;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
          </svg>
        </div>
        <h3 style="margin-bottom: 12px; color: #f9fafb; font-size: 18px; font-weight: 600;">Sesi Anda Berakhir</h3>
        <p style="margin-bottom: 20px; color: #d1d5db; font-size: 14px; line-height: 1.5;">Sesi Anda telah berakhir. Anda akan dialihkan ke halaman login.</p>
        <button id="session-expired-ok-btn" style="background: #3b82f6; color: white; border: none; padding: 10px 24px; border-radius: 6px; cursor: pointer; font-weight: 500; transition: background-color 0.2s;">
          Mengerti
        </button>
      </div>
    `;const t=document.createElement("style");t.textContent=`
      #session-expired-ok-btn:hover {
        background: #2563eb !important;
      }
      #session-expired-ok-btn:focus {
        outline: 2px solid #93c5fd;
        outline-offset: 2px;
      }
    `,document.head.appendChild(t);const a=l.querySelector("#session-expired-ok-btn"),r=()=>{document.body.contains(l)&&document.body.removeChild(l),document.head.contains(t)&&document.head.removeChild(t),s()};a?.addEventListener("click",r),l.addEventListener("click",o=>{o.target===l&&(o.preventDefault(),o.stopPropagation())}),document.body.appendChild(l),setTimeout(()=>{a?.focus()},100),setTimeout(()=>{document.body.contains(l)&&document.body.removeChild(l),document.head.contains(t)&&document.head.removeChild(t),s()},15e3)})}function ze(){localStorage.removeItem("ACCESS_TOKEN"),localStorage.removeItem("REFRESH_TOKEN"),localStorage.removeItem("USER"),localStorage.removeItem("USER_EMAIL"),window.location.pathname!=="/login"&&(window.location.href="/login")}function Ss(s){try{const t=JSON.parse(atob(s.split(".")[1])).exp*1e3;return Date.now()>=t}catch{return!0}}async function ks(s){const l=await s.text();if(!l)return null;let t;try{t=JSON.parse(l)}catch{throw new Error(l||"Unknown response")}return t&&typeof t=="object"&&"data"in t?t.data:t}async function F(s,l="GET",t,a={}){const r=`${ws}${s}`,o=localStorage.getItem("ACCESS_TOKEN");if(o&&Ss(o))throw await Ge(),ze(),new Error("Session expired. Please log in again.");const u={...a};t instanceof FormData||(u["Content-Type"]="application/json"),o&&(u.Authorization=`Bearer ${o}`);const x=await fetch(r,{method:l,headers:u,body:t instanceof FormData?t:t?JSON.stringify(t):void 0});if(x.status===401)throw await Ge(),ze(),new Error("Unauthorized. Please log in again.");const c=await ks(x);if(!x.ok){const h=c&&(c.message||c.error||c.reason)||x.statusText||"API Error";throw{response:c||h}}return c}const q=Te(s=>({accessToken:localStorage.getItem("ACCESS_TOKEN"),refreshToken:localStorage.getItem("REFRESH_TOKEN"),user:localStorage.getItem("USER")?JSON.parse(localStorage.getItem("USER")):null,loading:!1,error:null,loadFromStorage(){s({accessToken:localStorage.getItem("ACCESS_TOKEN"),refreshToken:localStorage.getItem("REFRESH_TOKEN"),user:localStorage.getItem("USER")?JSON.parse(localStorage.getItem("USER")):null})},setUser(l){localStorage.setItem("USER",JSON.stringify(l)),s({user:l})},async login(l,t){s({loading:!0,error:null});try{const a=await F("/auths/login","POST",{email:l,password:t}),r=a?.accessToken??a?.access_token??null,o=a?.refreshToken??a?.refresh_token??null;if(!r){const x=a?.meta?.message||"Login failed: No access token";throw new Error(x)}localStorage.setItem("ACCESS_TOKEN",r),o&&localStorage.setItem("REFRESH_TOKEN",o);const u=a.user?a.user:{email:l};localStorage.setItem("USER",JSON.stringify(u)),localStorage.removeItem("USER_EMAIL"),s({accessToken:r,refreshToken:o,loading:!1,user:u,error:null})}catch(a){let r="Login failed";throw a.response?r=a.response.meta?.message||r:a.message&&(r=a.message),s({error:r,loading:!1}),a}},async register(l,t,a){s({loading:!0,error:null});try{const r=await F("/auths/register","POST",{email:l,password:t,fullname:a}),o=r?.meta?.message||"Registration successful";return s({loading:!1,error:null}),{success:!0,message:o,data:r}}catch(r){let o="Registration failed";throw r.response?o=r.response.meta?.message||o:r.message&&(o=r.message),s({error:o,loading:!1}),new Error(o)}},logout(){localStorage.removeItem("ACCESS_TOKEN"),localStorage.removeItem("REFRESH_TOKEN"),localStorage.removeItem("USER"),localStorage.removeItem("USER_EMAIL"),s({accessToken:null,refreshToken:null,user:null,error:null,loading:!1}),window.location.pathname!=="/login"&&(window.location.href="/login")},async fetchUserProfile(){s({loading:!0,error:null});try{const l=await F("/auths/get_me","GET"),t=l.auth?l.auth:null;if(!t)throw new Error("User data not found in response");localStorage.setItem("USER",JSON.stringify(t)),s({user:t,loading:!1,error:null})}catch(l){console.error("Error fetching user profile:",l),l.response?.status===401||l.message?.includes("Unauthorized")?q.getState().logout():s({loading:!1,error:l.message||"Failed to fetch user profile"})}}}));function Cs(){const s=te(),[l,t]=n.useState(""),[a,r]=n.useState(""),[o,u]=n.useState(!1),{login:x,loading:c,error:h}=q(),f=async p=>{p.preventDefault();try{await x(l,a),s("/")}catch(T){console.log(T)}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 opacity-10 -z-10",children:e.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"radial-gradient(circle at 25px 25px, rgba(255,255,255,0.1) 2px, transparent 0)",backgroundSize:"50px 50px"}})}),e.jsxs("div",{className:"relative w-full max-w-md",children:[e.jsxs("div",{className:"bg-gray-800/80 backdrop-blur-xl border border-gray-700/50 rounded-2xl shadow-2xl p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-r from-blue-600 to-blue-500 rounded-2xl mb-4 shadow-lg",children:e.jsx(Ee,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-gray-100 to-gray-300 bg-clip-text text-transparent mb-2",children:"Welcome Back"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Sign in to access your notes"})]}),e.jsxs("form",{onSubmit:f,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(ue,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"email",placeholder:"Enter your email address",className:"w-full pl-12 pr-4 py-3 bg-gray-700/50 border border-gray-600 text-gray-100 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all placeholder-gray-400",value:l,onChange:p=>t(p.target.value),required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ke,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:o?"text":"password",placeholder:"Enter your password",className:"w-full pl-12 pr-12 py-3 bg-gray-700/50 border border-gray-600 text-gray-100 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all placeholder-gray-400",value:a,onChange:p=>r(p.target.value),required:!0}),e.jsx("button",{type:"button",onClick:()=>u(!o),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-300 transition-colors",children:o?e.jsx(He,{className:"w-5 h-5"}):e.jsx(le,{className:"w-5 h-5"})})]})]}),h&&e.jsx("div",{className:"bg-red-900/50 border border-red-700 text-red-200 px-4 py-3 rounded-xl",children:e.jsx("p",{className:"text-sm",children:h})}),e.jsx("button",{type:"submit",disabled:c,className:"w-full flex items-center justify-center space-x-2 px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-500 text-white rounded-xl hover:from-blue-700 hover:to-blue-600 transition-all duration-200 shadow-lg hover:shadow-blue-500/25 disabled:opacity-50 disabled:cursor-not-allowed transform hover:scale-105",children:c?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),e.jsx("span",{children:"Signing in..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ee,{className:"w-5 h-5"}),e.jsx("span",{children:"Sign In"})]})})]}),e.jsx("div",{className:"mt-8 text-center",children:e.jsxs("p",{className:"text-gray-400 text-sm",children:["Don't have an account?"," ",e.jsx(V,{to:"/register",className:"text-blue-400 hover:text-blue-300 font-medium transition-colors",children:"Create one here"})]})})]}),e.jsx("div",{className:"absolute -top-4 -left-4 w-24 h-24 bg-blue-500/20 rounded-full blur-xl"}),e.jsx("div",{className:"absolute -bottom-4 -right-4 w-32 h-32 bg-purple-500/20 rounded-full blur-xl"})]})]})}function Es(){const s=te(),l=q(f=>f.register),t=q(f=>f.loading),a=q(f=>f.error),[r,o]=n.useState({email:"",password:"",fullname:""}),[u,x]=n.useState(!1),c=f=>{o(p=>({...p,[f.target.name]:f.target.value}))},h=async f=>{f.preventDefault();try{await l(r.email,r.password,r.fullname),s(`/verify-email?email=${encodeURIComponent(r.email)}`),s(`/verify-email?email=${encodeURIComponent(r.email)}`)}catch(p){console.error("Registration error:",p)}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 opacity-10",children:e.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"radial-gradient(circle at 25px 25px, rgba(255,255,255,0.1) 2px, transparent 0)",backgroundSize:"50px 50px"}})}),e.jsxs("div",{className:"relative w-full max-w-md",children:[e.jsxs("div",{className:"bg-gray-800/80 backdrop-blur-xl border border-gray-700/50 rounded-2xl shadow-2xl p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-r from-green-600 to-green-500 rounded-2xl mb-4 shadow-lg",children:e.jsx(Pe,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-gray-100 to-gray-300 bg-clip-text text-transparent mb-2",children:"Create Account"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Join us and start organizing your notes"})]}),e.jsxs("form",{onSubmit:h,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Full Name"}),e.jsxs("div",{className:"relative",children:[e.jsx(X,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{name:"fullname",type:"text",placeholder:"Enter your full name",className:"w-full pl-12 pr-4 py-3 bg-gray-700/50 border border-gray-600 text-gray-100 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all placeholder-gray-400",value:r.fullname,onChange:c,required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(ue,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{name:"email",type:"email",placeholder:"Enter your email address",className:"w-full pl-12 pr-4 py-3 bg-gray-700/50 border border-gray-600 text-gray-100 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all placeholder-gray-400",value:r.email,onChange:c,required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ke,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{name:"password",type:u?"text":"password",placeholder:"Create a secure password",className:"w-full pl-12 pr-12 py-3 bg-gray-700/50 border border-gray-600 text-gray-100 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all placeholder-gray-400",value:r.password,onChange:c,required:!0,minLength:8}),e.jsx("button",{type:"button",onClick:()=>x(!u),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-300 transition-colors",children:u?e.jsx(He,{className:"w-5 h-5"}):e.jsx(le,{className:"w-5 h-5"})})]})]}),e.jsx("div",{className:"text-xs text-gray-400",children:e.jsx("p",{children:"Password should be at least 8 characters long"})}),a&&e.jsx("div",{className:"bg-red-900/50 border border-red-700 text-red-200 px-4 py-3 rounded-xl",children:e.jsx("p",{className:"text-sm",children:a})}),e.jsx("button",{type:"submit",disabled:t,className:"w-full flex items-center justify-center space-x-2 px-6 py-3 bg-gradient-to-r from-green-600 to-green-500 text-white rounded-xl hover:from-green-700 hover:to-green-600 transition-all duration-200 shadow-lg hover:shadow-green-500/25 disabled:opacity-50 disabled:cursor-not-allowed transform hover:scale-105",children:t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),e.jsx("span",{children:"Creating Account..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Pe,{className:"w-5 h-5"}),e.jsx("span",{children:"Create Account"})]})})]}),e.jsx("div",{className:"mt-8 text-center",children:e.jsxs("p",{className:"text-gray-400 text-sm",children:["Already have an account?"," ",e.jsx(V,{to:"/login",className:"text-green-400 hover:text-green-300 font-medium transition-colors",children:"Sign in here"})]})})]}),e.jsx("div",{className:"absolute -top-4 -left-4 w-24 h-24 bg-green-500/20 rounded-full blur-xl"}),e.jsx("div",{className:"absolute -bottom-4 -right-4 w-32 h-32 bg-blue-500/20 rounded-full blur-xl"})]})]})}const Z=Te((s,l)=>({notes:[],loading:!1,error:null,fetchNotes:async()=>{if(!l().loading){s({loading:!0,error:null});try{const t=await F("/notes","GET"),a=Array.isArray(t)?t:t?.notes??t?.data??[];s({notes:a,loading:!1})}catch(t){s({error:t.message||"Failed to fetch notes",loading:!1})}}},fetchNoteById:async t=>{s({loading:!0,error:null});try{const a=await F(`/notes/${t}`,"GET"),r=a?.note??a;return s(o=>({notes:o.notes.some(x=>String(x.id)===String(r.id))?o.notes.map(x=>String(x.id)===String(r.id)?r:x):[r,...o.notes],loading:!1})),r}catch(a){throw s({error:a.message||"Failed to fetch note",loading:!1}),a}},addNote:async t=>{s({loading:!0,error:null});try{await F("/notes","POST",t),await l().fetchNotes()}catch(a){throw s({error:a.message||"Failed to add note",loading:!1}),a}finally{s({loading:!1})}},updateNote:async(t,a)=>{s({loading:!0,error:null});try{await F(`/notes/${t}`,"PUT",a),await l().fetchNotes()}catch(r){throw s({error:r.message||"Failed to update note",loading:!1}),r}finally{s({loading:!1})}},deleteNote:async t=>{s({loading:!0,error:null});try{await F(`/notes/${t}`,"DELETE"),s(a=>({notes:a.notes.filter(r=>String(r.id)!==String(t)),loading:!1}))}catch(a){throw s({error:a.message||"Failed to delete note",loading:!1}),a}finally{s({loading:!1})}},getNote:t=>l().notes.find(a=>String(a.id)===String(t))}));function Fs({note:s}){const l=Z(x=>x.deleteNote),[t,a]=n.useState(!1),r=async()=>{if(confirm("Hapus catatan ini?")){a(!0);try{await l(s.id)}catch(x){console.error("Error deleting note:",x)}finally{a(!1)}}},o=x=>{if(!x)return"";try{return new Date(x).toLocaleDateString("id-ID",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return""}},u=(x,c=100)=>x.length<=c?x:x.substring(0,c)+"...";return e.jsxs("div",{className:"group bg-gray-800 border border-gray-700 rounded-xl p-5 hover:shadow-xl hover:shadow-gray-900/20 transition-all duration-300 hover:border-gray-600 hover:-translate-y-1",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-100 line-clamp-2 flex-1 mr-2",children:s.title||"Untitled Note"}),e.jsxs("div",{className:"flex items-center space-x-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx(V,{to:`/notes/${s.id}`,className:"p-1.5 text-gray-400 hover:text-blue-400 hover:bg-gray-700 rounded-md transition-colors",title:"Edit",children:e.jsx(Je,{className:"w-4 h-4"})}),e.jsx("button",{onClick:r,disabled:t,className:"p-1.5 text-gray-400 hover:text-red-400 hover:bg-gray-700 rounded-md transition-colors disabled:opacity-50",title:"Delete",children:e.jsx(ne,{className:"w-4 h-4"})})]})]}),e.jsx("p",{className:"text-gray-400 text-sm mb-4 line-clamp-3 leading-relaxed",children:u(s.body)||"No content"}),s.tags&&s.tags.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1.5 mb-4",children:[s.tags.slice(0,3).map((x,c)=>e.jsxs("span",{className:"inline-flex items-center space-x-1 bg-gray-700 text-gray-300 text-xs px-2 py-1 rounded-md",children:[e.jsx(oe,{className:"w-3 h-3"}),e.jsx("span",{children:x})]},c)),s.tags.length>3&&e.jsxs("span",{className:"inline-flex items-center bg-gray-700 text-gray-300 text-xs px-2 py-1 rounded-md",children:["+",s.tags.length-3]})]}),e.jsxs("div",{className:"pt-3 border-t border-gray-700",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ie,{className:"w-3 h-3"}),e.jsx("span",{children:o(s.updated_at||s.created_at)||"No date"})]}),e.jsx("div",{className:"w-px h-3 bg-gray-600"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(X,{className:"w-3 h-3"}),e.jsx("span",{className:"max-w-20 truncate",title:s.user_owner?.fullname||s.user_owner?.username,children:s.user_owner?.fullname||s.user_owner?.username||"Unknown"})]})]})}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(V,{to:`/notes/${s.id}`,className:"flex-1 text-center px-3 py-1.5 bg-gradient-to-r from-blue-600 to-blue-500 text-white text-sm rounded-lg hover:from-blue-700 hover:to-blue-600 transition-all duration-200 shadow-lg hover:shadow-blue-500/25",children:"View"}),e.jsx("button",{onClick:r,disabled:t,className:"flex-1 text-center px-3 py-1.5 bg-gradient-to-r from-red-600 to-red-500 text-white text-sm rounded-lg hover:from-red-700 hover:to-red-600 transition-all duration-200 shadow-lg hover:shadow-red-500/25 disabled:opacity-50",children:t?"Deleting...":"Delete"})]})]})]})}function Ts(){const{notes:s,fetchNotes:l,loading:t}=Z(c=>c),[a,r]=n.useState(""),[o,u]=n.useState("grid");n.useEffect(()=>{l()},[l]);const x=s.filter(c=>c.title.toLowerCase().includes(a.toLowerCase())||c.body.toLowerCase().includes(a.toLowerCase())||c.tags?.some(h=>h.toLowerCase().includes(a.toLowerCase())));return e.jsxs("div",{className:"min-h-screen bg-gray-900",children:[e.jsx("div",{className:"bg-gradient-to-r from-gray-800 to-gray-900 border-b border-gray-700",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-100 mb-2",children:"My Notes"}),e.jsxs("p",{className:"text-gray-400",children:[s.length," ",s.length===1?"note":"notes"," in total"]})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("div",{className:"flex items-center space-x-2 bg-gray-800 p-1 rounded-lg",children:[e.jsx("button",{onClick:()=>u("grid"),className:`p-2 rounded-md transition-colors ${o==="grid"?"bg-gray-600 text-white":"text-gray-400 hover:text-gray-200"}`,children:e.jsx(cs,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>u("list"),className:`p-2 rounded-md transition-colors ${o==="list"?"bg-gray-600 text-white":"text-gray-400 hover:text-gray-200"}`,children:e.jsx(ms,{className:"w-4 h-4"})})]})})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"relative max-w-md",children:[e.jsx(xs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search notes...",value:a,onChange:c=>r(c.target.value),className:"w-full pl-10 pr-4 py-3 bg-gray-800 border border-gray-700 text-gray-100 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all placeholder-gray-400"})]})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pb-20",children:t?e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):x.length===0?e.jsxs("div",{className:"text-center py-20",children:[e.jsx("div",{className:"text-6xl text-gray-600 mb-6",children:e.jsx(ie,{className:"w-16 h-16 mx-auto"})}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-400 mb-4",children:a?"No notes found":"No notes yet"}),e.jsx("p",{className:"text-gray-500 mb-8 max-w-md mx-auto",children:a?"Try adjusting your search terms or create a new note.":"Start organizing your thoughts by creating your first note."}),e.jsxs(V,{to:"/notes/new",className:"inline-flex items-center space-x-2 px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-500 text-white rounded-xl hover:from-blue-700 hover:to-blue-600 transition-all duration-200 shadow-lg hover:shadow-blue-500/25",children:[e.jsx(Fe,{className:"w-5 h-5"}),e.jsx("span",{children:"Create Your First Note"})]})]}):e.jsx("div",{className:`${o==="grid"?"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6":"space-y-4"}`,children:x.map(c=>e.jsx(Fs,{note:{...c,id:String(c.id),created_at:c.createdAt,updated_at:c.updatedAt,user_owner:c.user_owner?{...c.user_owner,id:String(c.user_owner.id)}:void 0}},c.id))})}),e.jsx(V,{to:"/notes/new",className:"fixed bottom-6 right-6 bg-gradient-to-r from-blue-600 to-blue-500 text-white p-4 rounded-full shadow-2xl hover:from-blue-700 hover:to-blue-600 transition-all duration-200 hover:scale-110 hover:shadow-blue-500/25 z-40",children:e.jsx(Fe,{className:"w-6 h-6"})})]})}W.registerLanguage("javascript",Xe);W.registerLanguage("python",Ze);W.registerLanguage("java",es);W.configure({languages:["javascript","typescript","html","css","php","python"]});const Is={syntax:{highlight:s=>W.highlightAuto(s).value},toolbar:[[{header:[1,2,3,!1]},{font:[]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"},{align:[]}],["link","image","formula","code"]]},Us=["header","font","bold","italic","underline","strike","list","bullet","align","link","image","formula","code"];function _s(){const s=te(),l=Z(g=>g.addNote),[t,a]=n.useState(""),[r,o]=n.useState(""),[u,x]=n.useState(""),[c,h]=n.useState(null),[f,p]=n.useState(!1),[T,k]=n.useState("gallery"),[j,_]=n.useState([]),[S,D]=n.useState(!1),[I,L]=n.useState([]),[R,b]=n.useState(!1),[N,w]=n.useState({}),[$,C]=n.useState(null),[M,K]=n.useState(null),[i,d]=n.useState(!1),[y,A]=n.useState(null),B=n.useRef(null);n.useEffect(()=>{f&&ee()},[f]);const ee=async()=>{D(!0);try{const g=await F("/files/notes_app","GET");_(g.files||[])}catch(g){console.error("Error fetching gallery files:",g),C(g.response?.meta?.message||"Failed to load gallery files")}finally{D(!1)}},ae=g=>{const E=g.target.files;if(!E)return;const G=Array.from(E);L(P=>[...P,...G]),C(null)},Q=g=>{L(E=>E.filter((G,P)=>P!==g))},z=async()=>{if(I.length===0){C("Please select at least one file to upload");return}b(!0),C(null),K(null);try{for(let g=0;g<I.length;g++){const E=I[g],G=`thumbnail_${g+1}`;try{const P=new FormData;P.append("fields",G),P.append(G,E);for(let be=0;be<=100;be+=10)w(fe=>({...fe,[E.name]:be})),await new Promise(fe=>setTimeout(fe,50));await F("/files/notes_app/bulk-upload","POST",P)}catch(P){console.error(`Error uploading ${E.name}:`,P),C(`Failed to upload ${E.name}: ${P.response?.meta?.message||P.message}`)}}L([]),K(`Successfully uploaded ${I.length} file(s)`),await ee()}catch(g){C(g.response?.meta?.message||"Failed to upload files")}finally{b(!1),w({})}},ce=g=>{if(g===0)return"0 Bytes";const E=1024,G=["Bytes","KB","MB","GB"],P=Math.floor(Math.log(g)/Math.log(E));return parseFloat((g/Math.pow(E,P)).toFixed(2))+" "+G[P]},ge=g=>g.startsWith("image/"),Ne=async g=>{g.preventDefault(),A(null),d(!0);try{const E=u.split(",").map(G=>G.trim()).filter(Boolean);await l({title:t,body:r,tags:E,thumbnail:c||void 0}),s("/")}catch(E){A(E.message||"Gagal menambahkan note")}finally{d(!1)}},me=()=>{t.trim()||r.trim()||u.trim()||c?confirm("You have unsaved changes. Are you sure you want to leave?")&&s(-1):s(-1)},he=g=>{o(g)},pe=g=>{h(g),p(!1)},xe=()=>{h(null)};return e.jsxs("div",{className:"min-h-screen bg-gray-900",children:[e.jsx("div",{className:"bg-gradient-to-r from-gray-800 to-gray-900 border-b border-gray-700",children:e.jsx("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:me,className:"p-2 text-gray-400 hover:text-gray-200 hover:bg-gray-700 rounded-lg transition-colors",children:e.jsx(je,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-100",children:"Create New Note"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Rich text editor (Quill.js)"})]})]})})}),e.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("form",{onSubmit:Ne,className:"space-y-6",children:e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-xl shadow-xl overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-700",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(Ue,{className:"w-5 h-5 text-gray-400"}),e.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Title"})]}),e.jsx("input",{className:"w-full bg-transparent border-none outline-none text-2xl font-bold text-gray-100 placeholder-gray-500",placeholder:"Enter note title...",value:t,onChange:g=>a(g.target.value),required:!0,autoFocus:!0})]}),e.jsxs("div",{className:"p-6 border-b border-gray-700",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(oe,{className:"w-5 h-5 text-gray-400"}),e.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Tags"})]}),e.jsx("input",{className:"w-full bg-gray-700 border border-gray-600 text-gray-100 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all placeholder-gray-400",placeholder:"Add tags separated by commas (e.g. work, ideas, project)",value:u,onChange:g=>x(g.target.value),required:!0}),u&&e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:u.split(",").map((g,E)=>{const G=g.trim();return G?e.jsxs("span",{className:"inline-flex items-center space-x-1 bg-blue-600/20 text-blue-300 text-sm px-3 py-1 rounded-lg border border-blue-500/30",children:[e.jsx(oe,{className:"w-3 h-3"}),e.jsx("span",{children:G})]},E):null})})]}),e.jsxs("div",{className:"p-6 border-b border-gray-700",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(Y,{className:"w-5 h-5 text-gray-400"}),e.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Thumbnail"})]}),c?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:`https://minio-s3.radarku.online/radarku-bucket/notes_app/${c}`,alt:"Thumbnail preview",className:"w-full h-48 object-cover rounded-lg"}),e.jsx("button",{type:"button",onClick:xe,className:"absolute top-2 right-2 p-2 bg-red-600 hover:bg-red-700 text-white rounded-full",children:e.jsx(ne,{className:"w-4 h-4"})})]}):e.jsxs("button",{type:"button",onClick:()=>p(!0),className:"flex items-center justify-center w-full h-32 border-2 border-dashed border-gray-600 rounded-lg text-gray-400 hover:text-gray-200 hover:border-gray-500 transition-colors",children:[e.jsx(Fe,{className:"w-6 h-6 mr-2"}),"Add Thumbnail"]})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(ie,{className:"w-5 h-5 text-gray-400"}),e.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Content"})]}),e.jsx("div",{className:"bg-gray-700 border border-gray-600 rounded-lg overflow-hidden",children:e.jsx(Qe,{value:r,onChange:he,modules:Is,formats:Us,placeholder:"Write your amazing content here...",theme:"snow"})})]}),y&&e.jsx("div",{className:"px-6 pb-4",children:e.jsx("div",{className:"bg-red-900/50 border border-red-700 text-red-200 px-4 py-3 rounded-lg",children:e.jsx("p",{className:"text-sm",children:y})})}),e.jsxs("div",{className:"p-6 bg-gray-700/30 border-t border-gray-700 flex flex-col sm:flex-row gap-3 sm:justify-end",children:[e.jsxs("button",{type:"button",onClick:me,className:"flex items-center px-6 py-3 text-gray-300 border border-gray-600 rounded-lg hover:bg-gray-700 hover:border-gray-500 transition-colors",children:[e.jsx(J,{className:"w-4 h-4 mr-1"})," Cancel"]}),e.jsxs("button",{type:"submit",disabled:i,className:"flex items-center px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-500 text-white rounded-lg hover:from-blue-700 hover:to-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[e.jsx(_e,{className:"w-4 h-4 mr-1"}),i?"Saving...":"Save Note"]})]})]})}),f&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-xl w-full max-w-6xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-gray-700 flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-100",children:"Select Thumbnail"}),e.jsx("button",{onClick:()=>p(!1),className:"p-2 text-gray-400 hover:text-gray-200 hover:bg-gray-700 rounded-lg transition-colors",children:e.jsx(J,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"border-b border-gray-700",children:e.jsxs("div",{className:"flex",children:[e.jsx("button",{className:`px-6 py-3 font-medium ${T==="gallery"?"text-blue-400 border-b-2 border-blue-400":"text-gray-400 hover:text-gray-200"}`,onClick:()=>k("gallery"),children:"Gallery"}),e.jsx("button",{className:`px-6 py-3 font-medium ${T==="upload"?"text-blue-400 border-b-2 border-blue-400":"text-gray-400 hover:text-gray-200"}`,onClick:()=>k("upload"),children:"Upload New"})]})}),e.jsxs("div",{className:"p-6 overflow-y-auto flex-grow",children:[T==="gallery"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-300",children:"Your Uploaded Images"}),e.jsxs("button",{onClick:ee,disabled:S,className:"flex items-center space-x-2 px-3 py-1 bg-gray-700 text-gray-300 rounded-lg hover:bg-gray-600 disabled:opacity-50",children:[e.jsx(Le,{className:`w-4 h-4 ${S?"animate-spin":""}`}),e.jsx("span",{children:"Refresh"})]})]}),S?e.jsx("div",{className:"flex justify-center items-center h-40",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):j.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx(Y,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No images found. Upload some images to get started!"})]}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:j.map(g=>ge(g.mime)&&e.jsxs("div",{className:"cursor-pointer group bg-gray-700 rounded-lg p-3",onClick:()=>pe(g.name),children:[e.jsx("div",{className:"aspect-square overflow-hidden rounded-lg border-2 border-gray-600 group-hover:border-blue-500 transition-colors",children:e.jsx("img",{src:`https://minio-s3.radarku.online/radarku-bucket/${g.path}/${g.name}`,alt:g.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-sm text-gray-300 truncate",children:g.name}),e.jsx("p",{className:"text-xs text-gray-400",children:ce(g.size)})]})]},g.id))})]}),T==="upload"&&e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-300 mb-4",children:"Upload New Image"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-600 rounded-xl p-8 text-center mb-6",children:[e.jsx("input",{type:"file",ref:B,onChange:ae,multiple:!0,accept:"image/*",className:"hidden"}),e.jsx(de,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-300 mb-2",children:"Drag & drop images here or"}),e.jsx("button",{onClick:()=>B.current?.click(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-500 transition-colors",disabled:R,children:"Browse Images"}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"Supports JPG, PNG, GIF, and other image formats"})]}),I.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"text-md font-medium text-gray-300 mb-3",children:["Selected Images (",I.length,")"]}),e.jsx("div",{className:"space-y-3",children:I.map((g,E)=>e.jsxs("div",{className:"flex items-center justify-between bg-gray-700 p-3 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("img",{src:URL.createObjectURL(g),alt:g.name,className:"w-12 h-12 object-cover rounded"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-gray-100 text-sm font-medium truncate",children:g.name}),e.jsx("p",{className:"text-gray-400 text-xs",children:ce(g.size)})]})]}),e.jsx("button",{onClick:()=>Q(E),className:"text-gray-400 hover:text-red-400 transition-colors",disabled:R,children:e.jsx(J,{className:"w-4 h-4"})})]},E))}),e.jsx("button",{onClick:z,disabled:R,className:"w-full mt-4 flex items-center justify-center space-x-2 px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:R?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),e.jsx("span",{children:"Uploading..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(de,{className:"w-5 h-5"}),e.jsxs("span",{children:["Upload ",I.length," Image(s)"]})]})})]}),$&&e.jsx("div",{className:"bg-red-900/50 border border-red-700 rounded-xl p-4 mb-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx($e,{className:"w-5 h-5 text-red-400"}),e.jsx("p",{className:"text-red-200",children:$})]})}),M&&e.jsx("div",{className:"bg-green-900/50 border border-green-700 rounded-xl p-4 mb-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(se,{className:"w-5 h-5 text-green-400"}),e.jsx("p",{className:"text-green-200",children:M})]})})]})]}),e.jsx("div",{className:"p-6 border-t border-gray-700 flex justify-end",children:e.jsx("button",{onClick:()=>p(!1),className:"px-6 py-3 bg-gray-700 text-gray-300 rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"})})]})})]})]})}const De=Te((s,l)=>({loading:!1,error:null,collaborators:[],collaborations:[],fetchCollaborators:async t=>{s({loading:!0,error:null});try{const a=await F(`/notes/${t}`,"GET");let r=[];a&&a.note&&a.note.user_collaborators&&(r=a.note.user_collaborators),s({collaborators:r});let o=[];a&&a.note&&a.note.note_collaborations&&(o=a.note.note_collaborations),s({collaborations:o})}catch(a){s({error:a.message||"Failed to fetch collaborators"})}finally{s({loading:!1})}},createCollaboration:async(t,a)=>{s({loading:!0,error:null});try{await F("/collaborations","POST",{userId:t.toString(),noteId:Number(a)}),await l().fetchCollaborators(a)}catch(r){throw s({error:r.message||"Failed to create collaboration"}),r}finally{s({loading:!1})}},deleteCollaboration:async(t,a)=>{s({loading:!0,error:null});try{await F("/collaborations","DELETE",{userId:t.toString(),noteId:Number(a)}),await l().fetchCollaborators(a)}catch(r){throw s({error:r.message||"Failed to delete collaboration"}),r}finally{s({loading:!1})}},fetchCollaborations:async t=>{s({loading:!0,error:null});try{const a=await F(`/notes/${t}`,"GET");let r=[];a&&a.note&&a.note.note_collaborations&&(r=a.note.note_collaborations),s({collaborations:r})}catch(a){throw s({error:a.message||"Failed to fetch collaborations"}),a}finally{s({loading:!1})}},addOrUpdateComment:async(t,a)=>{s({loading:!0,error:null});try{const r=await F("/collaborations","PUT",{noteId:t,body:a.trim()}),o=r.data?.collaboration||r.collaboration||r.data||r,u={id:o.id||`temp-${Date.now()}`,userId:o.user_id||o.userId||"0",noteId:o.note_id||o.noteId||t,user:o.user||{id:"0",username:"Unknown",fullname:"Unknown User",email:""},body:o.body||a,created_at:o.created_at||new Date().toISOString(),updated_at:o.updated_at||new Date().toISOString()};return s(x=>{const c=x.collaborations.findIndex(h=>h.id===u.id);return c>=0?{collaborations:x.collaborations.map((f,p)=>p===c?u:f)}:{collaborations:[...x.collaborations,u]}}),u}catch(r){throw s({error:r.message||"Failed to add/update comment"}),r}finally{s({loading:!1})}},deleteComment:async t=>{s({loading:!0,error:null});try{await F("/collaborations","PUT",{noteId:"0",body:""}),s(a=>({collaborations:a.collaborations.filter(r=>r.id!==t)}))}catch(a){throw s({error:a.message||"Failed to delete comment"}),a}finally{s({loading:!1})}}}));function Ls({noteId:s}){const{collaborators:l,loading:t,error:a,fetchCollaborators:r,createCollaboration:o,deleteCollaboration:u}=De(),[x,c]=n.useState(""),[h,f]=n.useState([]),[p,T]=n.useState(""),[k,j]=n.useState(!1),[_,S]=n.useState("");n.useEffect(()=>{r(s)},[s,r]),n.useEffect(()=>{if(_){const b=setTimeout(()=>{S("")},3e3);return()=>clearTimeout(b)}},[_]);const D=async b=>{if(c(b),b.length<2){f([]);return}j(!0);try{const N=await F(`/user?username=${b}`,"GET");let w=[];Array.isArray(N)?w=N:N&&N.data&&Array.isArray(N.data)?w=N.data:N&&N.users&&Array.isArray(N.users)&&(w=N.users);const $=l.map(M=>M.id),C=w.filter(M=>!$.includes(M.id));f(C)}catch(N){console.error("Search failed",N),f([])}finally{j(!1)}},I=async b=>{if(p)try{await o(p,s);const w=h.find($=>$.id===p)?.username||p;S(`✅ Successfully added ${w} as collaborator!`),T(""),c(""),f([]),r(s)}catch(N){alert(`Failed to add collaborator: ${N.message}`)}},L=async b=>{const w=l.find(C=>C.id===b)?.username||b;if(window.confirm(`Are you sure you want to remove ${w} from collaborators?`))try{await u(b,s),S(`✅ Successfully removed ${w} from collaborators!`),r(s)}catch(C){alert(`Failed to remove collaborator: ${C.message}`)}},R=b=>{b.preventDefault(),I()};return e.jsxs("div",{className:"p-6 border-b border-gray-700",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(us,{className:"w-5 h-5 text-gray-400"}),e.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Collaborators"})]}),_&&e.jsx("div",{className:"bg-green-600 text-white p-3 rounded-lg mb-3",children:_}),a&&e.jsx("div",{className:"text-red-400 mb-3",children:a}),t?e.jsx("div",{className:"text-gray-400 mb-3",children:"Loading collaborators..."}):l.length>0?e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-300 mb-2",children:"Collaborators on this note:"}),l.map(b=>e.jsxs("div",{className:"flex items-center justify-between bg-gray-700 p-3 rounded mb-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-100 font-medium",children:b.username}),b.fullname&&e.jsx("div",{className:"text-gray-400 text-sm",children:b.fullname})]}),e.jsx("button",{onClick:()=>L(b.id),className:"text-red-400 hover:text-red-300 p-1 transition-colors",title:"Remove collaborator",type:"button",children:e.jsx(J,{className:"w-4 h-4"})})]},b.id))]}):e.jsx("div",{className:"text-gray-400 mb-3",children:"No collaborators yet"}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-300 mb-2",children:"Add Collaborator:"}),e.jsx("form",{onSubmit:R,children:e.jsx("input",{type:"text",placeholder:"Search users by username...",value:x,onChange:b=>D(b.target.value),className:"w-full bg-gray-700 border border-gray-600 text-gray-100 rounded-lg px-4 py-2 placeholder-gray-400 mb-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})}),k&&e.jsx("div",{className:"text-gray-400 mb-2",children:"Searching..."}),h.length>0&&e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg mb-3 max-h-48 overflow-y-auto",children:h.map(b=>e.jsxs("div",{className:`p-3 cursor-pointer text-gray-100 hover:bg-gray-700 transition-colors ${p===b.id?"bg-gray-700":""}`,onClick:()=>T(b.id),children:[e.jsx("div",{className:"font-medium",children:b.username}),b.fullname&&e.jsx("div",{className:"text-sm text-gray-400",children:b.fullname})]},b.id))}),x.length>=2&&!k&&h.length===0&&e.jsx("div",{className:"text-gray-400 mb-2",children:"No users found"}),p&&e.jsxs("button",{onClick:b=>{b.preventDefault(),I()},className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-500 transition-colors",type:"button",children:[e.jsx(Ve,{className:"w-4 h-4 mr-1"})," Add Collaborator"]})]})]})}W.registerLanguage("javascript",Xe);W.registerLanguage("python",Ze);W.registerLanguage("java",es);W.configure({languages:["javascript","typescript","html","css","php","python"]});const $s={syntax:{highlight:s=>W.highlightAuto(s).value},toolbar:[[{header:[1,2,3,!1]},{font:[]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"},{align:[]}],["link","image","formula","code"]]},Ds=["header","font","bold","italic","underline","strike","list","bullet","align","link","image","formula","code"];function Rs(){const{id:s}=We(),l=te(),{collaborations:t,loading:a,addOrUpdateComment:r,deleteComment:o}=De(),[u,x]=n.useState("");t.filter(m=>m.body);const c=Z(m=>m.getNote),h=Z(m=>m.fetchNoteById),f=Z(m=>m.updateNote),[p,T]=n.useState(null),[k,j]=n.useState(""),[_,S]=n.useState(""),[D,I]=n.useState(""),[L,R]=n.useState(null),[b,N]=n.useState(!1),[w,$]=n.useState("gallery"),[C,M]=n.useState([]),[K,i]=n.useState(!1),[d,y]=n.useState([]),[A,B]=n.useState(!1),[ee,ae]=n.useState({}),[Q,z]=n.useState(null),[ce,ge]=n.useState(null),[Ne,me]=n.useState(!0),[he,pe]=n.useState(!1),[xe,g]=n.useState(null),[E,G]=n.useState(""),[P,be]=n.useState(null),[fe,Hs]=n.useState(""),Re=n.useRef(null);n.useEffect(()=>{if(!s)return;(async()=>{const v=c(s);if(v)T(v),j(v.title),S(v.body),I(v.tags.join(", ")),R(v.thumbnail||null),me(!1);else try{const U=await h(s);T(U),j(U.title),S(U.body),I(U.tags?.join(", ")||""),R(U.thumbnail||null)}catch(U){g(U.message||"Gagal memuat note")}finally{me(!1)}})()},[s,h,c]),n.useEffect(()=>{b&&ve()},[b]);const ve=async()=>{i(!0);try{const m=await F("/files/notes_app","GET");M(m.files||[])}catch(m){console.error("Error fetching gallery files:",m),z(m.response?.meta?.message||"Failed to load gallery files")}finally{i(!1)}},ss=m=>{const v=m.target.files;if(!v)return;const U=Array.from(v);y(O=>[...O,...U]),z(null)},ts=m=>{y(v=>v.filter((U,O)=>O!==m))},as=async()=>{if(d.length===0){z("Please select at least one file to upload");return}B(!0),z(null),ge(null);try{for(let m=0;m<d.length;m++){const v=d[m],U=`thumbnail_${m+1}`;try{const O=new FormData;O.append("fields",U),O.append(U,v);for(let Se=0;Se<=100;Se+=10)ae(ke=>({...ke,[v.name]:Se})),await new Promise(ke=>setTimeout(ke,50));await F("/files/notes_app/bulk-upload","POST",O)}catch(O){console.error(`Error uploading ${v.name}:`,O),z(`Failed to upload ${v.name}: ${O.response?.meta?.message||O.message}`)}}y([]),ge(`Successfully uploaded ${d.length} file(s)`),await ve()}catch(m){z(m.response?.meta?.message||"Failed to upload files")}finally{B(!1),ae({})}},Ae=m=>{if(m===0)return"0 Bytes";const v=1024,U=["Bytes","KB","MB","GB"],O=Math.floor(Math.log(m)/Math.log(v));return parseFloat((m/Math.pow(v,O)).toFixed(2))+" "+U[O]},rs=m=>m.startsWith("image/"),ls=async m=>{if(m.preventDefault(),!!s){g(null),pe(!0);try{const v=D.split(",").map(U=>U.trim()).filter(Boolean);await f(s,{title:k,body:_,tags:v,thumbnail:L||void 0}),l(`/notes/${s}`)}catch(v){g(v.message||"Gagal menyimpan perubahan")}finally{pe(!1)}}},ns=m=>{S(m)},we=p&&(k!==p.title||_!==p.body||D!==p.tags?.join(", ")||L!==(p.thumbnail||null)),Me=()=>{we?confirm("You have unsaved changes. Are you sure you want to leave?")&&l(-1):l(-1)},os=m=>{if(!m)return"Unknown";try{return new Date(m).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return"Invalid date"}},is=m=>{R(m),N(!1)},ds=()=>{R(null)};return e.jsxs("div",{className:"min-h-screen bg-gray-900",children:[e.jsx("div",{className:"bg-gradient-to-r from-gray-800 to-gray-900 border-b border-gray-700",children:e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:Me,className:"p-2 text-gray-400 hover:text-gray-200 hover:bg-gray-700 rounded-lg transition-colors",children:e.jsx(je,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-100",children:"Edit Note"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Make changes to your note"})]})]}),p&&e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-400",children:[e.jsx(Ie,{className:"w-4 h-4"}),e.jsxs("span",{children:["Last updated: ",os(p.updated_at||p.created_at)]})]})]})})}),e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[Ne?e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-xl p-8",children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})})}):p?e.jsx("form",{onSubmit:ls,className:"space-y-6",children:e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-xl shadow-xl overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-700",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(Ue,{className:"w-5 h-5 text-gray-400"}),e.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Title"})]}),e.jsx("input",{className:"w-full bg-transparent border-none outline-none text-2xl font-bold text-gray-100 placeholder-gray-500",placeholder:"Enter note title...",value:k,onChange:m=>j(m.target.value),required:!0,autoFocus:!0})]}),e.jsxs("div",{className:"p-6 border-b border-gray-700",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(oe,{className:"w-5 h-5 text-gray-400"}),e.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Tags"})]}),e.jsx("input",{className:"w-full bg-gray-700 border border-gray-600 text-gray-100 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all placeholder-gray-400",placeholder:"Add tags separated by commas (e.g. work, ideas, project)",value:D,onChange:m=>I(m.target.value)}),D&&e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:D.split(",").map((m,v)=>{const U=m.trim();return U?e.jsxs("span",{className:"inline-flex items-center space-x-1 bg-blue-600/20 text-blue-300 text-sm px-3 py-1 rounded-lg border border-blue-500/30",children:[e.jsx(oe,{className:"w-3 h-3"}),e.jsx("span",{children:U})]},v):null})})]}),e.jsxs("div",{className:"p-6 border-b border-gray-700",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(Y,{className:"w-5 h-5 text-gray-400"}),e.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Thumbnail"})]}),L?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:`https://minio-s3.radarku.online/radarku-bucket/notes_app/${L}`,alt:"Thumbnail preview",className:"w-full h-48 object-cover rounded-lg"}),e.jsx("a",{href:`https://minio-s3.radarku.online/radarku-bucket/notes_app/${L}`,target:"_blank",rel:"noopener noreferrer",className:"absolute top-2 right-12 p-2 bg-blue-600 hover:bg-blue-700 text-white rounded-full",title:"View image in new tab",children:e.jsx(le,{className:"w-4 h-4"})}),e.jsx("button",{type:"button",onClick:ds,className:"absolute top-2 right-2 p-2 bg-red-600 hover:bg-red-700 text-white rounded-full",children:e.jsx(ne,{className:"w-4 h-4"})})]}):e.jsxs("button",{type:"button",onClick:()=>N(!0),className:"flex items-center justify-center w-full h-32 border-2 border-dashed border-gray-600 rounded-lg text-gray-400 hover:text-gray-200 hover:border-gray-500 transition-colors",children:[e.jsx(Ve,{className:"w-6 h-6 mr-2"}),"Add Thumbnail"]})]}),s&&e.jsx(Ls,{noteId:parseInt(s)}),e.jsxs("div",{className:"p-6 border-b border-gray-700",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(ie,{className:"w-5 h-5 text-gray-400"}),e.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Content"})]}),e.jsx("div",{className:"bg-gray-700 border border-gray-600 rounded-lg overflow-hidden",children:e.jsx(Qe,{value:_,onChange:ns,modules:$s,formats:Ds,placeholder:"Write your amazing content here...",theme:"snow"})})]}),we&&e.jsx("div",{className:"px-6 pb-4",children:e.jsx("div",{className:"bg-yellow-900/30 border border-yellow-700 text-yellow-200 px-4 py-3 rounded-lg",children:e.jsxs("p",{className:"text-sm flex items-center space-x-2",children:[e.jsx("span",{className:"w-2 h-2 bg-yellow-400 rounded-full"}),e.jsx("span",{children:"You have unsaved changes"})]})})}),xe&&e.jsx("div",{className:"px-6 pb-4",children:e.jsx("div",{className:"bg-red-900/50 border border-red-700 text-red-200 px-4 py-3 rounded-lg",children:e.jsx("p",{className:"text-sm",children:xe})})}),e.jsxs("div",{className:"p-6 bg-gray-700/30 border-t border-gray-700 flex flex-col sm:flex-row gap-3 sm:justify-end",children:[e.jsxs("button",{type:"button",onClick:Me,className:"flex items-center justify-center space-x-2 px-6 py-3 text-gray-300 border border-gray-600 rounded-lg hover:bg-gray-700 hover:border-gray-500 transition-all duration-200",children:[e.jsx(J,{className:"w-4 h-4"}),e.jsx("span",{children:"Cancel"})]}),e.jsxs("button",{type:"submit",disabled:he||!we,className:"flex items-center justify-center space-x-2 px-6 py-3 bg-gradient-to-r from-green-600 to-green-500 text-white rounded-lg hover:from-green-700 hover:to-green-600 transition-all duration-200 shadow-lg hover:shadow-green-500/25 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(_e,{className:"w-4 h-4"}),e.jsx("span",{children:he?"Saving Changes...":"Save Changes"})]})]})]})}):e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-xl p-8",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-red-400 text-6xl mb-4",children:"⚠️"}),e.jsx("p",{className:"text-red-400 text-lg font-medium mb-2",children:"Error Loading Note"}),e.jsx("p",{className:"text-gray-400 mb-6",children:xe||"Note not found"}),e.jsx("button",{onClick:()=>l("/"),className:"px-4 py-2 bg-gray-700 text-gray-300 rounded-lg hover:bg-gray-600 transition-colors",children:"Back to Notes"})]})}),b&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-xl w-full max-w-6xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-gray-700 flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-100",children:"Select Thumbnail"}),e.jsx("button",{onClick:()=>N(!1),className:"p-2 text-gray-400 hover:text-gray-200 hover:bg-gray-700 rounded-lg transition-colors",children:e.jsx(J,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"border-b border-gray-700",children:e.jsxs("div",{className:"flex",children:[e.jsx("button",{className:`px-6 py-3 font-medium ${w==="gallery"?"text-blue-400 border-b-2 border-blue-400":"text-gray-400 hover:text-gray-200"}`,onClick:()=>$("gallery"),children:"Gallery"}),e.jsx("button",{className:`px-6 py-3 font-medium ${w==="upload"?"text-blue-400 border-b-2 border-blue-400":"text-gray-400 hover:text-gray-200"}`,onClick:()=>$("upload"),children:"Upload New"})]})}),e.jsxs("div",{className:"p-6 overflow-y-auto flex-grow",children:[w==="gallery"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-300",children:"Your Uploaded Images"}),e.jsxs("button",{onClick:ve,disabled:K,className:"flex items-center space-x-2 px-3 py-1 bg-gray-700 text-gray-300 rounded-lg hover:bg-gray-600 disabled:opacity-50",children:[e.jsx(Le,{className:`w-4 h-4 ${K?"animate-spin":""}`}),e.jsx("span",{children:"Refresh"})]})]}),K?e.jsx("div",{className:"flex justify-center items-center h-40",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):C.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx(Y,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No images found. Upload some images to get started!"})]}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:C.map(m=>rs(m.mime)&&e.jsxs("div",{className:"cursor-pointer group bg-gray-700 rounded-lg p-3",onClick:()=>is(m.name),children:[e.jsx("div",{className:"aspect-square overflow-hidden rounded-lg border-2 border-gray-600 group-hover:border-blue-500 transition-colors",children:e.jsx("img",{src:`https://minio-s3.radarku.online/radarku-bucket/${m.path}/${m.name}`,alt:m.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-sm text-gray-300 truncate",children:m.name}),e.jsx("p",{className:"text-xs text-gray-400",children:Ae(m.size)})]})]},m.id))})]}),w==="upload"&&e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-300 mb-4",children:"Upload New Image"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-600 rounded-xl p-8 text-center mb-6",children:[e.jsx("input",{type:"file",ref:Re,onChange:ss,multiple:!0,accept:"image/*",className:"hidden"}),e.jsx(de,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-300 mb-2",children:"Drag & drop images here or"}),e.jsx("button",{onClick:()=>Re.current?.click(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-500 transition-colors",disabled:A,children:"Browse Images"}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"Supports JPG, PNG, GIF, and other image formats"})]}),d.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"text-md font-medium text-gray-300 mb-3",children:["Selected Images (",d.length,")"]}),e.jsx("div",{className:"space-y-3",children:d.map((m,v)=>e.jsxs("div",{className:"flex items-center justify-between bg-gray-700 p-3 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("img",{src:URL.createObjectURL(m),alt:m.name,className:"w-12 h-12 object-cover rounded"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-gray-100 text-sm font-medium truncate",children:m.name}),e.jsx("p",{className:"text-gray-400 text-xs",children:Ae(m.size)})]})]}),e.jsx("button",{onClick:()=>ts(v),className:"text-gray-400 hover:text-red-400 transition-colors",disabled:A,children:e.jsx(J,{className:"w-4 h-4"})})]},v))}),e.jsx("button",{onClick:as,disabled:A,className:"w-full mt-4 flex items-center justify-center space-x-2 px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:A?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),e.jsx("span",{children:"Uploading..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(de,{className:"w-5 h-5"}),e.jsxs("span",{children:["Upload ",d.length," Image(s)"]})]})})]}),Q&&e.jsx("div",{className:"bg-red-900/50 border border-red-700 rounded-xl p-4 mb-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx($e,{className:"w-5 h-5 text-red-400"}),e.jsx("p",{className:"text-red-200",children:Q})]})}),ce&&e.jsx("div",{className:"bg-green-900/50 border border-green-700 rounded-xl p-4 mb-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(se,{className:"w-5 h-5 text-green-400"}),e.jsx("p",{className:"text-green-200",children:ce})]})})]})]}),e.jsx("div",{className:"p-6 border-t border-gray-700 flex justify-end",children:e.jsx("button",{onClick:()=>N(!1),className:"px-6 py-3 bg-gray-700 text-gray-300 rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"})})]})})]})]})}function As(){const{id:s}=We(),l=te(),t=Z(d=>d.fetchNoteById),a=Z(d=>d.deleteNote),{collaborations:r,loading:o,addOrUpdateComment:u,deleteComment:x,fetchCollaborations:c}=De(),[h,f]=n.useState(null),[p,T]=n.useState(!0),[k,j]=n.useState(null),[_,S]=n.useState(!1),[D,I]=n.useState(""),[L,R]=n.useState(null),[b,N]=n.useState(""),w=r.filter(d=>d.body);n.useEffect(()=>{if(!s){j("Note ID is required"),T(!1);return}(async()=>{try{T(!0),j(null);const y=await t(s);f(y),await c(parseInt(s))}catch(y){j(y.message||"Failed to load note")}finally{T(!1)}})()},[s,t,c]);const $=async()=>{if(s&&confirm("Are you sure you want to delete this note?")){S(!0);try{await a(s),l("/")}catch(d){j(d.message||"Failed to delete note"),S(!1)}}},C=d=>{if(!d)return"Unknown date";try{return new Date(d).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return"Invalid date"}},M=async()=>{if(!(!s||!D.trim()))try{await u(parseInt(s),D),I("")}catch{}},K=async()=>{if(b.trim()&&s)try{await u(parseInt(s),b),R(null),N("")}catch{}},i=async d=>{if(confirm("Apakah Anda yakin ingin menghapus komentar ini?"))try{await x(d)}catch{}};return e.jsxs("div",{className:"min-h-screen bg-gray-900",children:[e.jsx("div",{className:"bg-gradient-to-r from-gray-800 to-gray-900 border-b border-gray-700",children:e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>l("/"),className:"p-2 text-gray-400 hover:text-gray-200 hover:bg-gray-700 rounded-lg transition-colors",children:e.jsx(je,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-100",children:"Note Details"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"View and manage your note"})]})]})})}),e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-xl shadow-xl",children:p?e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):k?e.jsxs("div",{className:"text-center py-20",children:[e.jsx("div",{className:"text-red-400 text-6xl mb-4",children:"⚠️"}),e.jsx("p",{className:"text-red-400 text-lg font-medium mb-2",children:"Error Loading Note"}),e.jsx("p",{className:"text-gray-400 mb-6",children:k}),e.jsx("button",{onClick:()=>l("/"),className:"px-4 py-2 bg-gray-700 text-gray-300 rounded-lg hover:bg-gray-600 transition-colors",children:"Back to Notes"})]}):h?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"border-b border-gray-700 p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start space-y-4 sm:space-y-0",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-100 mb-3",children:h.title}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-400",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ye,{className:"w-4 h-4"}),e.jsxs("span",{children:["Updated: ",C(h.updated_at||h.created_at)]})]}),h.created_at&&h.updated_at&&h.created_at!==h.updated_at&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ye,{className:"w-4 h-4"}),e.jsxs("span",{children:["Created: ",C(h.created_at)]})]}),h.user_owner?.fullname&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(X,{className:"w-4 h-4"}),e.jsxs("span",{children:["Author: ",h.user_owner.fullname]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(V,{to:`/notes/${h.id}/edit`,className:"flex items-center space-x-2 px-4 py-2 bg-gradient-to-r from-blue-600 to-blue-500 text-white rounded-lg hover:from-blue-700 hover:to-blue-600 transition-all duration-200 shadow-lg hover:shadow-blue-500/25",children:[e.jsx(Je,{className:"w-4 h-4"}),e.jsx("span",{children:"Edit"})]}),e.jsxs("button",{onClick:$,disabled:_,className:"flex items-center space-x-2 px-4 py-2 bg-gradient-to-r from-red-600 to-red-500 text-white rounded-lg hover:from-red-700 hover:to-red-600 transition-all duration-200 shadow-lg hover:shadow-red-500/25 disabled:opacity-50",children:[e.jsx(ne,{className:"w-4 h-4"}),e.jsx("span",{children:_?"Deleting...":"Delete"})]})]})]}),h.tags?.length?e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:h.tags.map((d,y)=>e.jsxs("span",{className:"inline-flex items-center space-x-1 bg-gray-700 text-gray-300 text-sm px-3 py-1 rounded-lg",children:[e.jsx(oe,{className:"w-3 h-3"}),e.jsx("span",{children:d})]},y))}):null]}),e.jsxs("div",{className:"p-6 border-b border-gray-700",children:[e.jsxs("div",{className:"mb-4 text-sm text-gray-400 flex items-center",children:[e.jsx(X,{className:"w-4 h-4 mr-2"}),e.jsxs("span",{children:["Created by: ",h.user_owner?.fullname||"Unknown author"]})]}),h.thumbnail&&e.jsxs("div",{className:"mb-6 rounded-lg overflow-hidden border border-gray-600 relative",children:[e.jsxs("div",{className:"flex items-center space-x-2 bg-gray-700 px-4 py-2",children:[e.jsx(Y,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Thumbnail"})]}),e.jsx("a",{href:`https://minio-s3.radarku.online/radarku-bucket/notes_app/${h.thumbnail}`,target:"_blank",rel:"noopener noreferrer",className:"absolute top-[0px] right-2 p-2 bg-blue-600 hover:bg-blue-700 text-white rounded-full",title:"View image in new tab",children:e.jsx(le,{className:"w-4 h-4"})}),e.jsx("img",{src:`https://minio-s3.radarku.online/radarku-bucket/notes_app/${h.thumbnail}`,alt:"Note thumbnail",className:"w-full h-64 object-cover"})]}),h.body?e.jsx("div",{className:"prose prose-invert max-w-none",children:e.jsx("pre",{className:"whitespace-pre-wrap text-gray-300 leading-relaxed font-sans",children:e.jsx("div",{className:"ql-editor",dangerouslySetInnerHTML:{__html:vs.sanitize(h.body)}})})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ie,{className:"w-12 h-12 text-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400 text-lg",children:"This note is empty"}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Click Edit to add content"}),h.user_owner?.fullname&&e.jsxs("div",{className:"mt-4 text-sm text-gray-500 flex items-center justify-center",children:[e.jsx(X,{className:"w-4 h-4 mr-2"}),e.jsxs("span",{children:["Created by: ",h.user_owner.fullname]})]})]})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(Oe,{className:"w-5 h-5 text-gray-400"}),e.jsx("h3",{className:"text-lg font-medium text-gray-300",children:"Comments"}),e.jsx("span",{className:"bg-blue-600 text-white text-sm px-2 py-1 rounded-full",children:w.length}),o&&e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"text",value:D,onChange:d=>I(d.target.value),placeholder:"Add a comment...",className:"flex-1 bg-gray-700 border border-gray-600 text-gray-100 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:o}),e.jsx("button",{onClick:M,disabled:!D.trim()||o,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-500 disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:o?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):e.jsx(gs,{className:"w-4 h-4"})})]})}),e.jsxs("div",{className:"space-y-4",children:[w.map(d=>e.jsxs("div",{className:"bg-gray-700 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-sm font-medium",children:d.user?.username?.charAt(0)?.toUpperCase()||"U"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-100 font-medium",children:d.user?.fullname||d.user?.username||"Unknown User"}),e.jsx("p",{className:"text-gray-400 text-sm",children:C(d.created_at)})]})]}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("button",{onClick:()=>{R(d.id),N(d.body||"")},className:"text-gray-400 hover:text-blue-400 p-1",children:e.jsx(Ue,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>i(d.id),className:"text-gray-400 hover:text-red-400 p-1",children:e.jsx(J,{className:"w-4 h-4"})})]})]}),L===d.id?e.jsxs("div",{className:"flex space-x-2 mt-2",children:[e.jsx("input",{type:"text",value:b,onChange:y=>N(y.target.value),className:"flex-1 bg-gray-600 border border-gray-500 text-gray-100 rounded-lg px-3 py-1"}),e.jsx("button",{onClick:K,className:"px-3 py-1 bg-green-600 text-white rounded-lg hover:bg-green-500",children:"Save"}),e.jsx("button",{onClick:()=>R(null),className:"px-3 py-1 bg-gray-600 text-gray-300 rounded-lg hover:bg-gray-500",children:"Cancel"})]}):e.jsx("p",{className:"text-gray-300",children:d.body})]},d.id)),w.length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-400",children:[e.jsx(Oe,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No comments yet. Be the first to comment!"})]})]})]})]}):e.jsxs("div",{className:"text-center py-20",children:[e.jsx("div",{className:"text-gray-600 text-6xl mb-4",children:"📝"}),e.jsx("p",{className:"text-gray-400 text-lg",children:"Note not found"}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"The note you're looking for doesn't exist"}),e.jsx("button",{onClick:()=>l("/"),className:"mt-6 px-4 py-2 bg-gray-700 text-gray-300 rounded-lg hover:bg-gray-600 transition-colors",children:"Back to Notes"})]})})})]})}function Ms({activeMenu:s,setActiveMenu:l}){const[t,a]=n.useState(!1),{user:r,logout:o}=q(),u=te(),x=hs(),[c,h]=n.useState(r?.email||localStorage.getItem("USER")?JSON.parse(localStorage.getItem("USER")).email:null),f=[{id:"notes",icon:ie,label:"Notes",path:"/"},{id:"media",icon:Y,label:"Media",path:"/media"},{id:"profile",icon:X,label:"Profile",path:"/profile"}],p=()=>{o()},T=j=>{l(j.id),j.path!==x.pathname&&u(j.path)},k=j=>s===j.id||x.pathname===j.path;return e.jsxs("div",{className:`${t?"w-64":"w-16"} bg-gray-800/50 backdrop-blur-xl border-r border-gray-700/50 transition-all duration-300 flex flex-col h-full`,onMouseEnter:()=>a(!0),onMouseLeave:()=>a(!1),children:[e.jsx("div",{className:"p-4 border-b border-gray-700/50",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-600 to-blue-500 rounded-lg flex items-center justify-center",children:e.jsx(ie,{className:"w-5 h-5 text-white"})}),t&&e.jsx("h1",{className:"text-lg font-bold text-gray-100 whitespace-nowrap",children:"ModernNotes"})]})}),e.jsx("nav",{className:"flex-1 py-4",children:e.jsx("div",{className:"space-y-2 px-2",children:f.map(j=>{const _=j.icon,S=k(j);return e.jsxs("button",{onClick:()=>T(j),className:`w-full flex items-center space-x-3 px-3 py-3 rounded-xl transition-all duration-200 group ${S?"bg-blue-600 text-white shadow-lg shadow-blue-500/25":"text-gray-400 hover:text-gray-200 hover:bg-gray-700/50"}`,children:[e.jsx(_,{className:"w-5 h-5 flex-shrink-0"}),t&&e.jsx("span",{className:"font-medium whitespace-nowrap",children:j.label})]},j.id)})})}),e.jsxs("div",{className:"p-4 border-t border-gray-700/50",children:[t&&c&&e.jsx("div",{className:"mb-3 px-3 py-2 bg-gray-700/50 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(X,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-300 truncate",children:c})]})}),e.jsxs("button",{onClick:p,className:"w-full flex items-center space-x-3 px-3 py-3 text-gray-400 hover:text-red-400 hover:bg-gray-700/50 rounded-xl transition-all duration-200",children:[e.jsx(ps,{className:"w-4 h-4 flex-shrink-0"}),t&&e.jsx("span",{className:"font-medium whitespace-nowrap",children:"Logout"})]})]})]})}function Ps({children:s,activeMenu:l="notes"}){const[t,a]=n.useState(l);return e.jsxs("div",{className:"h-screen w-full bg-gray-900 flex overflow-hidden",children:[e.jsx(Ms,{activeMenu:t,setActiveMenu:a}),e.jsx("div",{className:"flex-1 flex flex-col overflow-hidden",children:e.jsx("div",{className:"flex-1 overflow-y-auto",children:s})})]})}function Os(){const s=te();return n.useEffect(()=>{const l=setTimeout(()=>{s("/login")},5e3);return()=>clearTimeout(l)},[s]),e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 opacity-10",children:e.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"radial-gradient(circle at 25px 25px, rgba(255,255,255,0.1) 2px, transparent 0)",backgroundSize:"50px 50px"}})}),e.jsxs("div",{className:"relative w-full max-w-md",children:[e.jsxs("div",{className:"bg-gray-800/80 backdrop-blur-xl border border-gray-700/50 rounded-2xl shadow-2xl p-8 text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-r from-green-600 to-green-500 rounded-2xl mb-6 shadow-lg",children:e.jsx(se,{className:"w-10 h-10 text-white"})}),e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-gray-100 to-gray-300 bg-clip-text text-transparent mb-4",children:"Email Verified!"}),e.jsx("p",{className:"text-gray-300 mb-2",children:"Your email has been successfully verified."}),e.jsx("p",{className:"text-gray-400 text-sm mb-6",children:"You will be redirected to login page in 5 seconds..."}),e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2 mb-6",children:e.jsx("div",{className:"bg-green-500 h-2 rounded-full animate-progress"})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(V,{to:"/login",className:"w-full flex items-center justify-center space-x-2 px-6 py-3 bg-gradient-to-r from-green-600 to-green-500 text-white rounded-xl hover:from-green-700 hover:to-green-600 transition-all duration-200 shadow-lg hover:shadow-green-500/25",children:[e.jsx(Ee,{className:"w-5 h-5"}),e.jsx("span",{children:"Go to Login"})]}),e.jsxs(V,{to:"/",className:"w-full flex items-center justify-center space-x-2 px-6 py-3 text-gray-400 hover:text-gray-200 hover:bg-gray-700/50 rounded-xl transition-all duration-200",children:[e.jsx(ue,{className:"w-5 h-5"}),e.jsx("span",{children:"Back to Home"})]})]})]}),e.jsx("div",{className:"absolute -top-4 -left-4 w-24 h-24 bg-green-500/20 rounded-full blur-xl"}),e.jsx("div",{className:"absolute -bottom-4 -right-4 w-32 h-32 bg-blue-500/20 rounded-full blur-xl"})]}),e.jsx("style",{children:`
          @keyframes progress {
            from { width: 0%; }
            to { width: 100%; }
          }
          .animate-progress {
            animation: progress 5s linear forwards;
          }
        `})]})}function Bs(){const[s]=bs(),l=s.get("email"),[t,a]=n.useState(60),[r,o]=n.useState(!1);n.useEffect(()=>{if(t>0){const x=setTimeout(()=>a(t-1),1e3);return()=>clearTimeout(x)}else o(!0)},[t]);const u=()=>{console.log("Resending verification email to:",l),a(60),o(!1)};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 opacity-10",children:e.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"radial-gradient(circle at 25px 25px, rgba(255,255,255,0.1) 2px, transparent 0)",backgroundSize:"50px 50px"}})}),e.jsxs("div",{className:"relative w-full max-w-md",children:[e.jsxs("div",{className:"bg-gray-800/80 backdrop-blur-xl border border-gray-700/50 rounded-2xl shadow-2xl p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-r from-blue-600 to-blue-500 rounded-2xl mb-4 shadow-lg",children:e.jsx(ue,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-gray-100 to-gray-300 bg-clip-text text-transparent mb-2",children:"Verify Your Email"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"We've sent a verification link to your email"})]}),l&&e.jsx("div",{className:"bg-blue-900/20 border border-blue-700/50 rounded-xl p-4 mb-6",children:e.jsx("p",{className:"text-blue-300 text-center font-medium",children:l})}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(se,{className:"w-5 h-5 text-green-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-200 font-medium",children:"Check your inbox"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Look for an email from ModernNotes"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(se,{className:"w-5 h-5 text-green-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-200 font-medium",children:"Click the verification link"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"This will confirm your email address"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(se,{className:"w-5 h-5 text-green-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-200 font-medium",children:"Start using your account"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"You'll be redirected to login automatically"})]})]})]}),e.jsx("div",{className:"bg-gray-700/50 rounded-xl p-4 mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ie,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-gray-300 text-sm",children:r?"Ready to resend?":`Resend in ${t}s`})]}),e.jsx("button",{onClick:u,disabled:!r,className:"px-3 py-1 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Resend"})]})}),e.jsx("div",{className:"text-center mb-6",children:e.jsxs("p",{className:"text-gray-400 text-sm",children:["Didn't receive the email? Check your spam folder or"," ",e.jsx("button",{onClick:u,disabled:!r,className:"text-blue-400 hover:text-blue-300 disabled:opacity-50 disabled:cursor-not-allowed",children:"resend verification email"})]})}),e.jsx("div",{className:"text-center",children:e.jsxs(V,{to:"/login",className:"inline-flex items-center text-blue-400 hover:text-blue-300 transition-colors",children:[e.jsx(je,{className:"w-4 h-4 mr-2"}),"Back to Login"]})})]}),e.jsx("div",{className:"absolute -top-4 -left-4 w-24 h-24 bg-blue-500/20 rounded-full blur-xl"}),e.jsx("div",{className:"absolute -bottom-4 -right-4 w-32 h-32 bg-purple-500/20 rounded-full blur-xl"})]})]})}function Gs(){const{user:s,loading:l,error:t,fetchUserProfile:a}=q(),[r,o]=n.useState(!1),[u,x]=n.useState({username:"",fullname:""});n.useEffect(()=>{!s||!s.id?a():x({username:s.username||"",fullname:s.fullname||""})},[s,a]);const c=()=>{x({username:s?.username||"",fullname:s?.fullname||""}),o(!1)},h=f=>f?new Date(f).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Unknown";return l&&!s?e.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):t&&!s?e.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-red-400 text-lg mb-4",children:["Error: ",t]}),e.jsx("button",{onClick:a,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-500",children:"Try Again"})]})}):e.jsx("div",{className:"min-h-screen bg-gray-900",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"bg-gradient-to-r from-gray-800 to-gray-900 border border-gray-700 rounded-xl shadow-xl p-6 mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-100",children:"Profile"}),e.jsx("p",{className:"text-gray-400",children:"Manage your account information"})]}),r?e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-500 transition-colors",disabled:l,children:[e.jsx(_e,{className:"w-4 h-4 mr-2"}),l?"Saving...":"Save"]}),e.jsxs("button",{onClick:c,className:"flex items-center px-4 py-2 text-gray-300 border border-gray-600 rounded-lg hover:bg-gray-700 transition-colors",children:[e.jsx(J,{className:"w-4 h-4 mr-2"}),"Cancel"]})]}):e.jsxs("button",{onClick:()=>o(!0),className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-500 transition-colors",children:[e.jsx(fs,{className:"w-4 h-4 mr-2"}),"Edit Profile"]})]})}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-xl shadow-xl overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-700",children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-6",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-blue-600 to-blue-500 rounded-full flex items-center justify-center",children:e.jsx(X,{className:"w-10 h-10 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-100",children:s?.fullname||s?.username||"User"}),e.jsx("p",{className:"text-gray-400",children:s?.email}),s?.email_verified_at?e.jsx("span",{className:"text-green-400 text-sm",children:"✓ Email verified"}):e.jsx("span",{className:"text-yellow-400 text-sm",children:"⚠ Email not verified"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"User ID"}),e.jsx("div",{className:"bg-gray-700 border border-gray-600 text-gray-100 rounded-lg px-4 py-3 font-mono text-sm",children:s?.id||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Email"}),e.jsxs("div",{className:"bg-gray-700 border border-gray-600 text-gray-100 rounded-lg px-4 py-3 flex items-center",children:[e.jsx(ue,{className:"w-4 h-4 text-gray-400 mr-2"}),s?.email]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Username"}),r?e.jsx("input",{type:"text",value:u.username,onChange:f=>x(p=>({...p,username:f.target.value})),className:"w-full bg-gray-700 border border-gray-600 text-gray-100 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter username"}):e.jsx("div",{className:"bg-gray-700 border border-gray-600 text-gray-100 rounded-lg px-4 py-3",children:s?.username||"Not set"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Full Name"}),r?e.jsx("input",{type:"text",value:u.fullname,onChange:f=>x(p=>({...p,fullname:f.target.value})),className:"w-full bg-gray-700 border border-gray-600 text-gray-100 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter full name"}):e.jsx("div",{className:"bg-gray-700 border border-gray-600 text-gray-100 rounded-lg px-4 py-3",children:s?.fullname||"Not set"})]})]})]}),e.jsxs("div",{className:"p-6 bg-gray-700/30",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-300 mb-4",children:"Account Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ye,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Member since"}),e.jsx("p",{className:"text-gray-200",children:h(s?.created_at)})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ye,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Last updated"}),e.jsx("p",{className:"text-gray-200",children:h(s?.updated_at)})]})]})]})]})]}),t&&e.jsx("div",{className:"mt-6 p-4 bg-red-900/50 border border-red-700 rounded-xl",children:e.jsx("p",{className:"text-red-200",children:t})})]})})}function zs(){const[s,l]=n.useState([]),[t,a]=n.useState(!1),[r,o]=n.useState({}),[u,x]=n.useState([]),[c,h]=n.useState([]),[f,p]=n.useState(!0),[T,k]=n.useState(null),[j,_]=n.useState(null),[S,D]=n.useState({total:0,used:0}),I=n.useRef(null);n.useEffect(()=>{L()},[]);const L=async()=>{p(!0);try{const i=await F("/files/notes_app","GET"),d=i.files.map(y=>({...y,url:`undefined/upload/${y.path}/${y.name}`}));h(d),D({total:i.total_maximum,used:i.total_usage})}catch(i){k(i.response?.meta?.message||"Failed to fetch gallery files")}finally{p(!1)}},R=i=>{const d=i.target.files;if(!d)return;const y=Array.from(d);l(A=>[...A,...y]),k(null)},b=i=>{l(d=>d.filter((y,A)=>A!==i))},N=async()=>{if(s.length===0){k("Please select at least one file to upload");return}a(!0),k(null),_(null);try{const i=[];for(let d=0;d<s.length;d++){const y=s[d],A=`thumbnail_${d+1}`;try{const B=new FormData;B.append("fields",A),B.append(A,y);const ee=await F("/files/notes_app/bulk-upload","POST",B);for(let Q=0;Q<=100;Q+=10)o(z=>({...z,[y.name]:Q})),await new Promise(z=>setTimeout(z,50));const ae={id:ee?.id||`file-${Date.now()}-${d}`,name:y.name,url:ee?.url||URL.createObjectURL(y),size:y.size,type:y.type,uploadedAt:new Date().toISOString()};i.push(ae)}catch(B){console.error(`Error uploading ${y.name}:`,B),k(`Failed to upload ${y.name}: ${B.response?.meta?.message||B.message}`)}}x(d=>[...d,...i]),l([]),_(`Successfully uploaded ${i.length} file(s)`),await L()}catch(i){k(i.response?.meta?.message||"Failed to upload files")}finally{a(!1),o({})}},w=async(i,d)=>{if(confirm(`Are you sure you want to delete "${d}"?`))try{await F(`/files/notes_app/${i}`,"DELETE"),_(`File "${d}" deleted successfully`),await L()}catch(y){k(y.response?.meta?.message||"Failed to delete file")}},$=i=>{if(i===0)return"0 Bytes";const d=1024,y=["Bytes","KB","MB","GB"],A=Math.floor(Math.log(i)/Math.log(d));return parseFloat((i/Math.pow(d,A)).toFixed(2))+" "+y[A]},C=(i,d)=>d===0?"0%":`${(i/d*100).toFixed(1)}%`,M=i=>i.startsWith("image/")?e.jsx(Y,{className:"w-5 h-5"}):i.startsWith("video/")?e.jsx(Ce,{className:"w-5 h-5"}):i.startsWith("audio/")?e.jsx(Ce,{className:"w-5 h-5"}):e.jsx(Ce,{className:"w-5 h-5"}),K=i=>i.startsWith("image/");return e.jsx("div",{className:"min-h-screen bg-gray-900",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"bg-gradient-to-r from-gray-800 to-gray-900 border border-gray-700 rounded-xl shadow-xl p-6 mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-purple-600 to-purple-500 rounded-xl flex items-center justify-center",children:e.jsx(Y,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-100",children:"Media Library"}),e.jsx("p",{className:"text-gray-400",children:"Upload and manage your media files"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm text-gray-300",children:["Storage: ",$(S.used)," / ",$(S.total)]}),e.jsx("div",{className:"w-32 h-2 bg-gray-600 rounded-full mt-1",children:e.jsx("div",{className:"h-2 bg-blue-500 rounded-full transition-all",style:{width:C(S.used,S.total)}})}),e.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:[C(S.used,S.total)," used"]})]})]})}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-xl shadow-xl p-6 mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-100 mb-4",children:"Upload Files"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-600 rounded-xl p-8 text-center mb-4",children:[e.jsx("input",{type:"file",ref:I,onChange:R,multiple:!0,accept:"image/*,video/*,audio/*,.pdf,.doc,.docx,.txt",className:"hidden"}),e.jsx(de,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-300 mb-2",children:"Drag & drop files here or"}),e.jsx("button",{onClick:()=>I.current?.click(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-500 transition-colors",disabled:t,children:"Browse Files"}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"Supports images, videos, audio, and documents"})]}),s.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("h3",{className:"text-md font-medium text-gray-300 mb-3",children:["Selected Files (",s.length,")"]}),e.jsx("div",{className:"space-y-2",children:s.map((i,d)=>e.jsxs("div",{className:"flex items-center justify-between bg-gray-700 p-3 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[M(i.type),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-gray-100 text-sm font-medium truncate",children:i.name}),e.jsx("p",{className:"text-gray-400 text-xs",children:$(i.size)})]})]}),e.jsx("button",{onClick:()=>b(d),className:"text-gray-400 hover:text-red-400 transition-colors",disabled:t,children:e.jsx(J,{className:"w-4 h-4"})})]},d))})]}),s.length>0&&e.jsx("button",{onClick:N,disabled:t,className:"w-full flex items-center justify-center space-x-2 px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),e.jsxs("span",{children:["Uploading... (",Object.keys(r).length,"/",s.length,")"]})]}):e.jsxs(e.Fragment,{children:[e.jsx(de,{className:"w-5 h-5"}),e.jsxs("span",{children:["Upload ",s.length," File(s)"]})]})})]}),t&&s.length>0&&e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-xl shadow-xl p-6 mb-6",children:[e.jsx("h3",{className:"text-md font-medium text-gray-300 mb-4",children:"Upload Progress"}),e.jsx("div",{className:"space-y-3",children:s.map((i,d)=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-gray-300 text-sm truncate",children:i.name}),e.jsxs("span",{className:"text-gray-400 text-sm",children:[r[i.name]||0,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-300",style:{width:`${r[i.name]||0}%`}})})]},d))})]}),T&&e.jsx("div",{className:"bg-red-900/50 border border-red-700 rounded-xl p-4 mb-6",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx($e,{className:"w-5 h-5 text-red-400"}),e.jsx("p",{className:"text-red-200",children:T})]})}),j&&e.jsx("div",{className:"bg-green-900/50 border border-green-700 rounded-xl p-4 mb-6",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(se,{className:"w-5 h-5 text-green-400"}),e.jsx("p",{className:"text-green-200",children:j})]})}),e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-xl shadow-xl p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-100",children:["Your Files (",c.length,")"]}),e.jsxs("button",{onClick:L,disabled:f,className:"flex items-center space-x-2 px-3 py-1 bg-gray-700 text-gray-300 rounded-lg hover:bg-gray-600 disabled:opacity-50",children:[e.jsx(Le,{className:`w-4 h-4 ${f?"animate-spin":""}`}),e.jsx("span",{children:"Refresh"})]})]}),f?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):c.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx(Y,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No files found. Upload some files to get started!"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:c.map(i=>e.jsxs("div",{className:"bg-gray-700 rounded-lg p-3 group relative",children:[K(i.mime)?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:`https://minio-s3.radarku.online/radarku-bucket/${i.path}/${i.name}`,alt:i.name,className:"w-full h-32 object-cover rounded-lg mb-2",loading:"lazy"}),e.jsxs("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 transition-all duration-200 rounded-lg flex items-center justify-center opacity-0 group-hover:opacity-100",children:[e.jsx("a",{href:`https://minio-s3.radarku.online/radarku-bucket/${i.path}/${i.name}`,target:"_blank",rel:"noopener noreferrer",className:"p-2 bg-white bg-opacity-20 rounded-full mr-2 hover:bg-opacity-30",onClick:d=>d.stopPropagation(),children:e.jsx(le,{className:"w-4 h-4 text-white"})}),e.jsx("a",{href:`https://minio-s3.radarku.online/radarku-bucket/${i.path}/${i.name}`,download:i.name,className:"p-2 bg-white bg-opacity-20 rounded-full mr-2 hover:bg-opacity-30",onClick:d=>d.stopPropagation(),children:e.jsx(Be,{className:"w-4 h-4 text-white"})}),e.jsx("button",{onClick:()=>w(i.id,i.name),className:"p-2 bg-white bg-opacity-20 rounded-full hover:bg-opacity-30",children:e.jsx(ne,{className:"w-4 h-4 text-white"})})]})]}):e.jsx("div",{className:"w-full h-32 bg-gray-600 rounded-lg flex items-center justify-center mb-2",children:M(i.mime)}),e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[M(i.mime),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-gray-100 text-sm font-medium truncate",children:i.name.split("/").pop()}),e.jsx("p",{className:"text-gray-400 text-xs",children:$(i.size)})]})]}),e.jsxs("div",{className:"text-xs text-gray-400 space-y-1",children:[e.jsxs("p",{children:["Uploaded: ",new Date(i.created_at).toLocaleDateString()]}),e.jsxs("p",{children:["Type: ",i.mime]})]}),!K(i.mime)&&e.jsxs("div",{className:"flex justify-between items-center mt-2 pt-2 border-t border-gray-600",children:[e.jsxs("a",{href:i.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 text-xs flex items-center",children:[e.jsx(le,{className:"w-3 h-3 mr-1"}),"View"]}),e.jsxs("a",{href:i.url,download:i.name,className:"text-green-400 hover:text-green-300 text-xs flex items-center",children:[e.jsx(Be,{className:"w-3 h-3 mr-1"}),"Download"]}),e.jsxs("button",{onClick:()=>w(i.id,i.name),className:"text-red-400 hover:text-red-300 text-xs flex items-center",children:[e.jsx(ne,{className:"w-3 h-3 mr-1"}),"Delete"]})]})]},i.id))})]}),u.length>0&&e.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-xl shadow-xl p-6 mt-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-100 mb-4",children:["Recently Uploaded (",u.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:u.map((i,d)=>e.jsxs("div",{className:"bg-gray-700 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[M(i.type),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-gray-100 text-sm font-medium truncate",children:i.name}),e.jsx("p",{className:"text-gray-400 text-xs",children:$(i.size)})]})]}),i.type.startsWith("image/")&&e.jsx("img",{src:i.url,alt:i.name,className:"w-full h-32 object-cover rounded-lg mb-2"}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-400 text-xs",children:new Date(i.uploadedAt).toLocaleDateString()}),e.jsx("a",{href:i.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 text-xs",children:"View"})]})]},d))})]})]})})}function qs(){const s=window.onerror,l=window.onunhandledrejection;window.onerror=function(t,a,r,o,u){return(t.toString().includes("Token expired")||t.toString().includes("Unauthorized"))&&q.getState().logout(),s?s.call(this,t,a,r,o,u):!1},window.onunhandledrejection=function(t){return(t.reason?.message?.includes("Token expired")||t.reason?.message?.includes("Unauthorized")||t.reason?.response?.status===401)&&q.getState().logout(),l?l?.call(this,t):!1}}function re({children:s,activeMenu:l}){const t=q(r=>r.accessToken),a=q(r=>r.logout);return n.useEffect(()=>{},[a]),t?e.jsx(Ps,{activeMenu:l,children:s}):e.jsx(Ye,{to:"/login"})}function qe({children:s}){return q(t=>t.accessToken)?e.jsx(Ye,{to:"/"}):s}function Ks(){return n.useEffect(()=>{qs()},[]),e.jsx(ys,{children:e.jsxs(js,{children:[e.jsx(H,{path:"/login",element:e.jsx(qe,{children:e.jsx(Cs,{})})}),e.jsx(H,{path:"/register",element:e.jsx(qe,{children:e.jsx(Es,{})})}),e.jsx(H,{path:"/verify-email",element:e.jsx(Bs,{})}),e.jsx(H,{path:"/email-verified",element:e.jsx(Os,{})}),e.jsx(H,{path:"/",element:e.jsx(re,{activeMenu:"notes",children:e.jsx(Ts,{})})}),e.jsx(H,{path:"/notes/new",element:e.jsx(re,{activeMenu:"notes",children:e.jsx(_s,{})})}),e.jsx(H,{path:"/notes/:id",element:e.jsx(re,{activeMenu:"notes",children:e.jsx(As,{})})}),e.jsx(H,{path:"/notes/:id/edit",element:e.jsx(re,{activeMenu:"notes",children:e.jsx(Rs,{})})}),e.jsx(H,{path:"/media",element:e.jsx(re,{activeMenu:"media",children:e.jsx(zs,{})})}),e.jsx(H,{path:"/profile",element:e.jsx(re,{activeMenu:"profile",children:e.jsx(Gs,{})})})]})})}Ns.createRoot(document.getElementById("root")).render(e.jsx(n.StrictMode,{children:e.jsx(Ks,{})}));
